<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation translatorVersion="2.10.0" translatorOptions="EnableAnnotations,EnableLocators,EnableResultTypes" xsi:type="a:CqlToElmInfo"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="259">
         <a:s>library PCMaternal version '5.10.000'</a:s>
      </a:s>
   </annotation>
   <identifier id="PCMaternal" version="5.10.000"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="1" locator="5:1-5:28" localIdentifier="QICore" uri="http://hl7.org/fhir">
         <annotation xsi:type="a:Annotation">
            <a:t name="update"/>
            <a:s r="1">
               <a:s>/*@update: @@Created from QDM v2.1 to FHIR, then updated 041922 after annual update to QDM v2.21.000 @@*/
using </a:s>
               <a:s>
                  <a:s>QICore</a:s>
               </a:s>
               <a:s> version '4.1.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="2" locator="7:1-7:56" localIdentifier="FHIRHelpers" path="FHIRHelpers" version="4.3.000">
         <annotation xsi:type="a:Annotation">
            <a:s r="2">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.3.000' called FHIRHelpers</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="3" locator="8:1-8:49" localIdentifier="Global" path="CQMCommon" version="1.4.000">
         <annotation xsi:type="a:Annotation">
            <a:s r="3">
               <a:s>include </a:s>
               <a:s>
                  <a:s>CQMCommon</a:s>
               </a:s>
               <a:s> version '1.4.000' called Global</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="4" locator="9:1-9:58" localIdentifier="QICoreCommon" path="QICoreCommon" version="1.5.000">
         <annotation xsi:type="a:Annotation">
            <a:s r="4">
               <a:s>include </a:s>
               <a:s>
                  <a:s>QICoreCommon</a:s>
               </a:s>
               <a:s> version '1.5.000' called QICoreCommon</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <parameters>
      <def localId="17" locator="22:1-22:49" name="Measurement Period" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="17">
               <a:s>parameter &quot;Measurement Period&quot; </a:s>
               <a:s r="16">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="15">
                     <a:s>DateTime</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
            <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <parameterTypeSpecifier localId="16" locator="22:32-22:49" xsi:type="IntervalTypeSpecifier">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <pointType localId="15" locator="22:41-22:48" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </parameterTypeSpecifier>
      </def>
   </parameters>
   <codeSystems>
      <def localId="5" locator="11:1-11:38" resultTypeName="t:CodeSystem" name="LOINC" id="http://loinc.org" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="5">
               <a:s>codesystem &quot;LOINC&quot;: 'http://loinc.org'</a:s>
            </a:s>
         </annotation>
      </def>
   </codeSystems>
   <valueSets>
      <def localId="6" locator="13:1-13:100" resultTypeName="t:ValueSet" name="Delivery Procedures" id="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1045.59" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="6">
               <a:s>valueset &quot;Delivery Procedures&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1045.59'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="7" locator="14:1-14:104" resultTypeName="t:ValueSet" name="ED Visit and OB Triage" id="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1029.369" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="7">
               <a:s>valueset &quot;ED Visit and OB Triage&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1029.369'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="8" locator="15:1-15:100" resultTypeName="t:ValueSet" name="Encounter Inpatient" id="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="8">
               <a:s>valueset &quot;Encounter Inpatient&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="9" locator="16:1-16:118" resultTypeName="t:ValueSet" name="Estimated Gestational Age at Delivery" id="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1045.26" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="9">
               <a:s>valueset &quot;Estimated Gestational Age at Delivery&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1045.26'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="10" locator="17:1-17:102" resultTypeName="t:ValueSet" name="Observation Services" id="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="10">
               <a:s>valueset &quot;Observation Services&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143'</a:s>
            </a:s>
         </annotation>
      </def>
   </valueSets>
   <codes>
      <def localId="12" locator="19:1-19:112" resultTypeName="t:Code" name="Date and time of obstetric delivery" id="93857-1" display="Date and time of obstetric delivery" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="12">
               <a:s>code &quot;Date and time of obstetric delivery&quot;: '93857-1' from </a:s>
               <a:s r="11">
                  <a:s>&quot;LOINC&quot;</a:s>
               </a:s>
               <a:s> display 'Date and time of obstetric delivery'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="11" locator="19:60-19:66" resultTypeName="t:CodeSystem" name="LOINC"/>
      </def>
      <def localId="14" locator="20:1-20:88" resultTypeName="t:Code" name="Delivery date Estimated" id="11778-8" display="Delivery date Estimated" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="14">
               <a:s>code &quot;Delivery date Estimated&quot;: '11778-8' from </a:s>
               <a:s r="13">
                  <a:s>&quot;LOINC&quot;</a:s>
               </a:s>
               <a:s> display 'Delivery date Estimated'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="13" locator="20:48-20:54" resultTypeName="t:CodeSystem" name="LOINC"/>
      </def>
   </codes>
   <contexts>
      <def locator="24:1-24:15" name="Patient"/>
   </contexts>
   <statements>
      <def locator="24:1-24:15" name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand locator="24:1-24:15" dataType="fhir:Patient" templateId="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def localId="40" locator="32:1-36:93" name="Encounter with Age Range" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="40">
               <a:s>define &quot;Encounter with Age Range&quot;:
  </a:s>
               <a:s r="39">
                  <a:s>
                     <a:s r="19">
                        <a:s r="18">
                           <a:s r="18">
                              <a:s>[&quot;Encounter&quot;: </a:s>
                              <a:s>
                                 <a:s>&quot;Encounter Inpatient&quot;</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> EncounterInpatient</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
                      </a:s>
                  <a:s r="38">
                     <a:s>where </a:s>
                     <a:s r="38">
                        <a:s r="33">
                           <a:s r="23">
                              <a:s r="21">
                                 <a:s r="20">
                                    <a:s>EncounterInpatient</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="21">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> = </a:s>
                              <a:s r="22">
                                 <a:s>'finished'</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
                        and </a:s>
                           <a:s r="32">
                              <a:s r="28">
                                 <a:s>AgeInYearsAt(</a:s>
                                 <a:s r="27">
                                    <a:s>date from </a:s>
                                    <a:s r="26">
                                       <a:s>start of </a:s>
                                       <a:s r="25">
                                          <a:s r="24">
                                             <a:s>EncounterInpatient</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="25">
                                             <a:s>period</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> in </a:s>
                              <a:s r="31">
                                 <a:s r="29">Interval[ 8, 65 )</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
                        and </a:s>
                        <a:s r="37">
                           <a:s r="35">
                              <a:s r="34">
                                 <a:s>EncounterInpatient</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="35">
                                 <a:s>period</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="37"> ends during day of </a:s>
                           <a:s r="36">
                              <a:s>&quot;Measurement Period&quot;</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="39" locator="33:3-36:93" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="19" locator="33:3-33:57" alias="EncounterInpatient">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="18" locator="33:3-33:38" dataType="fhir:Encounter" templateId="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" codeProperty="type" codeComparator="in" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <codes locator="33:17-33:37" resultTypeName="t:ValueSet" name="Encounter Inpatient" preserve="true" xsi:type="ValueSetRef"/>
               </expression>
            </source>
            <where localId="38" locator="34:23-36:93" resultTypeName="t:Boolean" xsi:type="And">
               <operand localId="33" locator="34:29-35:107" resultTypeName="t:Boolean" xsi:type="And">
                  <operand localId="23" locator="34:29-34:66" resultTypeName="t:Boolean" xsi:type="Equal">
                     <operand localId="21" locator="34:29-34:53" resultTypeName="fhir:EncounterStatus" path="value" xsi:type="Property">
                        <source path="status" scope="EncounterInpatient" xsi:type="Property"/>
                     </operand>
                     <operand localId="22" locator="34:57-34:66" resultTypeName="t:String" valueType="t:String" value="finished" xsi:type="Literal"/>
                  </operand>
                  <operand localId="32" locator="35:29-35:107" resultTypeName="t:Boolean" xsi:type="In">
                     <operand localId="28" locator="35:29-35:86" resultTypeName="t:Integer" precision="Year" xsi:type="CalculateAgeAt">
                        <operand path="value" xsi:type="Property">
                           <source path="birthDate" xsi:type="Property">
                              <source name="Patient" xsi:type="ExpressionRef"/>
                           </source>
                        </operand>
                        <operand localId="27" locator="35:42-35:85" resultTypeName="t:Date" xsi:type="DateFrom">
                           <operand localId="26" locator="35:52-35:85" resultTypeName="t:DateTime" xsi:type="Start">
                              <operand localId="25" locator="35:61-35:85" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <operand path="period" scope="EncounterInpatient" xsi:type="Property"/>
                              </operand>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="31" locator="35:91-35:107" lowClosed="true" highClosed="false" xsi:type="Interval">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <low localId="29" locator="35:101" resultTypeName="t:Integer" valueType="t:Integer" value="8" xsi:type="Literal"/>
                        <high localId="30" locator="35:104-35:105" resultTypeName="t:Integer" valueType="t:Integer" value="65" xsi:type="Literal"/>
                     </operand>
                  </operand>
               </operand>
               <operand localId="37" locator="36:29-36:93" resultTypeName="t:Boolean" precision="Day" xsi:type="In">
                  <operand locator="36:55-36:58" xsi:type="End">
                     <operand localId="35" locator="36:29-36:53" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <operand path="period" scope="EncounterInpatient" xsi:type="Property"/>
                     </operand>
                  </operand>
                  <operand localId="36" locator="36:74-36:93" name="Measurement Period" xsi:type="ParameterRef">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="115" locator="75:1-92:24" name="hospitalizationWithEDOBTriageObservation" context="Patient" accessLevel="Public" fluent="true" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="115">
               <a:s>/*define function &quot;HospitalizationWithEDOBTriageObservation&quot;(Encounter Encounter ):
  HospitalizationWithEDOBTriageObservation returns the total interval from the start of any immediately prior emergency department visit or OB Triage visit through the observation visit to the discharge of the given encounter
  Encounter Visit
    let ObsVisit: Last([&quot;Encounter&quot;: &quot;Observation Services&quot;] LastObs
        where LastObs.period ends 1 hour or less on or before start of Visit.period
          and LastObs.status = 'finished'
        sort by 
        end of period
    ),
    VisitStart: Coalesce(start of ObsVisit.period, start of Visit.period),
    EDOBTriageVisit: Last([&quot;Encounter&quot;: &quot;ED Visit and OB Triage&quot;] LastEDOBTriage
        where LastEDOBTriage.period ends 1 hour or less on or before VisitStart
          and LastEDOBTriage.status = 'finished'
        sort by 
        end of period
    )
    return Interval[Coalesce(start of EDOBTriageVisit.period, VisitStart), 
    end of Visit.period]*/
define fluent function hospitalizationWithEDOBTriageObservation (TheEncounter </a:s>
               <a:s r="53">
                  <a:s>Encounter</a:s>
               </a:s>
               <a:s> ):
  /*hospitalizationWithEDOBTriageObservation returns the total interval from the start of any immediately prior emergency department visit or OB Triage visit through the observation visit to the discharge of the given encounter*/
  </a:s>
               <a:s r="114">
                  <a:s r="114">
                     <a:s>
                        <a:s r="55">
                           <a:s r="54">
                              <a:s>
                                 <a:s>TheEncounter</a:s>
                              </a:s>
                           </a:s>
                           <a:s> Visit</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="76">
                           <a:s>ObsVisit: </a:s>
                           <a:s r="75">
                              <a:s>Last(</a:s>
                              <a:s r="74">
                                 <a:s>
                                    <a:s r="57">
                                       <a:s r="56">
                                          <a:s r="56">
                                             <a:s>[&quot;Encounter&quot;: </a:s>
                                             <a:s>
                                                <a:s>&quot;Observation Services&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastObs</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
        </a:s>
                                 <a:s r="69">
                                    <a:s>where </a:s>
                                    <a:s r="69">
                                       <a:s r="64">
                                          <a:s r="59">
                                             <a:s r="58">
                                                <a:s>LastObs</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="59">
                                                <a:s>period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="64">
                                             <a:s>ends </a:s>
                                             <a:s r="63">
                                                <a:s>1 hour</a:s>
                                             </a:s>
                                             <a:s> or less on or before</a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="62">
                                             <a:s>start of </a:s>
                                             <a:s r="61">
                                                <a:s r="60">
                                                   <a:s>Visit</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="61">
                                                   <a:s>period</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
          and </a:s>
                                       <a:s r="68">
                                          <a:s r="66">
                                             <a:s r="65">
                                                <a:s>LastObs</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="66">
                                                <a:s>status</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> = </a:s>
                                          <a:s r="67">
                                             <a:s>'finished'</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
        </a:s>
                                 <a:s r="73">
                                    <a:s>sort by 
        </a:s>
                                    <a:s r="72">
                                       <a:s r="71">
                                          <a:s>end of </a:s>
                                          <a:s r="70">
                                             <a:s>period</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
    )</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="84">
                           <a:s>VisitStart: </a:s>
                           <a:s r="83">
                              <a:s>Coalesce(</a:s>
                              <a:s r="79">
                                 <a:s>start of </a:s>
                                 <a:s r="78">
                                    <a:s r="77">
                                       <a:s>ObsVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="78">
                                       <a:s>period</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="82">
                                 <a:s>start of </a:s>
                                 <a:s r="81">
                                    <a:s r="80">
                                       <a:s>Visit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="81">
                                       <a:s>period</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
    </a:s>
                        <a:s r="103">
                           <a:s>EDOBTriageVisit: </a:s>
                           <a:s r="102">
                              <a:s>Last(</a:s>
                              <a:s r="101">
                                 <a:s>
                                    <a:s r="86">
                                       <a:s r="85">
                                          <a:s r="85">
                                             <a:s>[&quot;Encounter&quot;: </a:s>
                                             <a:s>
                                                <a:s>&quot;ED Visit and OB Triage&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastEDOBTriage</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
        </a:s>
                                 <a:s r="96">
                                    <a:s>where </a:s>
                                    <a:s r="96">
                                       <a:s r="91">
                                          <a:s r="88">
                                             <a:s r="87">
                                                <a:s>LastEDOBTriage</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="88">
                                                <a:s>period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="91">
                                             <a:s>ends </a:s>
                                             <a:s r="90">
                                                <a:s>1 hour</a:s>
                                             </a:s>
                                             <a:s> or less on or before</a:s>
                                          </a:s>
                                          <a:s> </a:s>
                                          <a:s r="89">
                                             <a:s>VisitStart</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
          and </a:s>
                                       <a:s r="95">
                                          <a:s r="93">
                                             <a:s r="92">
                                                <a:s>LastEDOBTriage</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="93">
                                                <a:s>status</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> = </a:s>
                                          <a:s r="94">
                                             <a:s>'finished'</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
        </a:s>
                                 <a:s r="100">
                                    <a:s>sort by 
        </a:s>
                                    <a:s r="99">
                                       <a:s r="98">
                                          <a:s>end of </a:s>
                                          <a:s r="97">
                                             <a:s>period</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
    )</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="113">
                        <a:s>return </a:s>
                        <a:s r="112">
                           <a:s>Interval[</a:s>
                           <a:s r="108">
                              <a:s>Coalesce(</a:s>
                              <a:s r="106">
                                 <a:s>start of </a:s>
                                 <a:s r="105">
                                    <a:s r="104">
                                       <a:s>EDOBTriageVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="105">
                                       <a:s>period</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="107">
                                 <a:s>VisitStart</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>, 
    </a:s>
                           <a:s r="111">
                              <a:s>end of </a:s>
                              <a:s r="110">
                                 <a:s r="109">
                                    <a:s>Visit</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="110">
                                    <a:s>period</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>]</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
            <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="114" locator="77:3-92:24" xsi:type="Query">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="55" locator="77:3-77:20" resultTypeName="fhir:Encounter" alias="Visit">
               <expression localId="54" locator="77:3-77:14" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
            </source>
            <let localId="76" locator="78:9-83:5" resultTypeName="fhir:Encounter" identifier="ObsVisit">
               <expression localId="75" locator="78:19-83:5" resultTypeName="fhir:Encounter" xsi:type="Last">
                  <source localId="74" locator="78:24-82:21" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="57" locator="78:24-78:68" alias="LastObs">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="56" locator="78:24-78:60" dataType="fhir:Encounter" templateId="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" codeProperty="type" codeComparator="in" xsi:type="Retrieve">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <codes locator="78:38-78:59" resultTypeName="t:ValueSet" name="Observation Services" preserve="true" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="69" locator="79:9-80:41" resultTypeName="t:Boolean" xsi:type="And">
                        <operand localId="64" locator="79:15-79:83" resultTypeName="t:Boolean" xsi:type="And">
                           <operand locator="79:35-79:48" xsi:type="In">
                              <operand locator="79:30-79:33" xsi:type="End">
                                 <operand localId="59" locator="79:15-79:28" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <operand path="period" scope="LastObs" xsi:type="Property"/>
                                 </operand>
                              </operand>
                              <operand locator="79:35-79:48" lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <low locator="79:63-79:83" xsi:type="Subtract">
                                    <operand localId="62" locator="79:63-79:83" resultTypeName="t:DateTime" xsi:type="Start">
                                       <operand localId="61" locator="79:72-79:83" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          </resultTypeSpecifier>
                                          <operand path="period" scope="Visit" xsi:type="Property"/>
                                       </operand>
                                    </operand>
                                    <operand localId="63" locator="79:35-79:40" resultTypeName="t:Quantity" value="1" unit="hour" xsi:type="Quantity"/>
                                 </low>
                                 <high localId="62" locator="79:63-79:83" resultTypeName="t:DateTime" xsi:type="Start">
                                    <operand localId="61" locator="79:72-79:83" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                          <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                       <operand path="period" scope="Visit" xsi:type="Property"/>
                                    </operand>
                                 </high>
                              </operand>
                           </operand>
                           <operand locator="79:35-79:48" xsi:type="Not">
                              <operand locator="79:35-79:48" xsi:type="IsNull">
                                 <operand localId="62" locator="79:63-79:83" resultTypeName="t:DateTime" xsi:type="Start">
                                    <operand localId="61" locator="79:72-79:83" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                          <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                       <operand path="period" scope="Visit" xsi:type="Property"/>
                                    </operand>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="68" locator="80:15-80:41" resultTypeName="t:Boolean" xsi:type="Equal">
                           <operand localId="66" locator="80:15-80:28" resultTypeName="fhir:EncounterStatus" path="value" xsi:type="Property">
                              <source path="status" scope="LastObs" xsi:type="Property"/>
                           </operand>
                           <operand localId="67" locator="80:32-80:41" resultTypeName="t:String" valueType="t:String" value="finished" xsi:type="Literal"/>
                        </operand>
                     </where>
                     <sort localId="73" locator="81:9-82:21">
                        <by localId="72" locator="82:9-82:21" resultTypeName="t:DateTime" direction="asc" xsi:type="ByExpression">
                           <expression localId="71" locator="82:9-82:21" resultTypeName="t:DateTime" xsi:type="End">
                              <operand localId="70" locator="82:16-82:21" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <operand name="period" xsi:type="IdentifierRef"/>
                              </operand>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <let localId="84" locator="84:5-84:73" resultTypeName="t:DateTime" identifier="VisitStart">
               <expression localId="83" locator="84:17-84:73" resultTypeName="t:DateTime" xsi:type="Coalesce">
                  <operand localId="79" locator="84:26-84:49" resultTypeName="t:DateTime" xsi:type="Start">
                     <operand localId="78" locator="84:35-84:49" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <operand path="period" xsi:type="Property">
                           <source localId="77" locator="84:35-84:42" resultTypeName="fhir:Encounter" name="ObsVisit" xsi:type="QueryLetRef"/>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="82" locator="84:52-84:72" resultTypeName="t:DateTime" xsi:type="Start">
                     <operand localId="81" locator="84:61-84:72" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <operand path="period" scope="Visit" xsi:type="Property"/>
                     </operand>
                  </operand>
               </expression>
            </let>
            <let localId="103" locator="85:5-90:5" resultTypeName="fhir:Encounter" identifier="EDOBTriageVisit">
               <expression localId="102" locator="85:22-90:5" resultTypeName="fhir:Encounter" xsi:type="Last">
                  <source localId="101" locator="85:27-89:21" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="86" locator="85:27-85:80" alias="LastEDOBTriage">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="85" locator="85:27-85:65" dataType="fhir:Encounter" templateId="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" codeProperty="type" codeComparator="in" xsi:type="Retrieve">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <codes locator="85:41-85:64" resultTypeName="t:ValueSet" name="ED Visit and OB Triage" preserve="true" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="96" locator="86:9-87:48" resultTypeName="t:Boolean" xsi:type="And">
                        <operand localId="91" locator="86:15-86:79" resultTypeName="t:Boolean" xsi:type="And">
                           <operand locator="86:42-86:55" xsi:type="In">
                              <operand locator="86:37-86:40" xsi:type="End">
                                 <operand localId="88" locator="86:15-86:35" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <operand path="period" scope="LastEDOBTriage" xsi:type="Property"/>
                                 </operand>
                              </operand>
                              <operand locator="86:42-86:55" lowClosed="true" highClosed="true" xsi:type="Interval">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <low locator="86:70-86:79" xsi:type="Subtract">
                                    <operand localId="89" locator="86:70-86:79" resultTypeName="t:DateTime" name="VisitStart" xsi:type="QueryLetRef"/>
                                    <operand localId="90" locator="86:42-86:47" resultTypeName="t:Quantity" value="1" unit="hour" xsi:type="Quantity"/>
                                 </low>
                                 <high localId="89" locator="86:70-86:79" resultTypeName="t:DateTime" name="VisitStart" xsi:type="QueryLetRef"/>
                              </operand>
                           </operand>
                           <operand locator="86:42-86:55" xsi:type="Not">
                              <operand locator="86:42-86:55" xsi:type="IsNull">
                                 <operand localId="89" locator="86:70-86:79" resultTypeName="t:DateTime" name="VisitStart" xsi:type="QueryLetRef"/>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="95" locator="87:15-87:48" resultTypeName="t:Boolean" xsi:type="Equal">
                           <operand localId="93" locator="87:15-87:35" resultTypeName="fhir:EncounterStatus" path="value" xsi:type="Property">
                              <source path="status" scope="LastEDOBTriage" xsi:type="Property"/>
                           </operand>
                           <operand localId="94" locator="87:39-87:48" resultTypeName="t:String" valueType="t:String" value="finished" xsi:type="Literal"/>
                        </operand>
                     </where>
                     <sort localId="100" locator="88:9-89:21">
                        <by localId="99" locator="89:9-89:21" resultTypeName="t:DateTime" direction="asc" xsi:type="ByExpression">
                           <expression localId="98" locator="89:9-89:21" resultTypeName="t:DateTime" xsi:type="End">
                              <operand localId="97" locator="89:16-89:21" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <operand name="period" xsi:type="IdentifierRef"/>
                              </operand>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <return localId="113" locator="91:5-92:24">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="112" locator="91:12-92:24" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <low localId="108" locator="91:21-91:73" resultTypeName="t:DateTime" xsi:type="Coalesce">
                     <operand localId="106" locator="91:30-91:60" resultTypeName="t:DateTime" xsi:type="Start">
                        <operand localId="105" locator="91:39-91:60" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <operand path="period" xsi:type="Property">
                              <source localId="104" locator="91:39-91:53" resultTypeName="fhir:Encounter" name="EDOBTriageVisit" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="107" locator="91:63-91:72" resultTypeName="t:DateTime" name="VisitStart" xsi:type="QueryLetRef"/>
                  </low>
                  <high localId="111" locator="92:5-92:23" resultTypeName="t:DateTime" xsi:type="End">
                     <operand localId="110" locator="92:12-92:23" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <operand path="period" scope="Visit" xsi:type="Property"/>
                     </operand>
                  </high>
               </expression>
            </return>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="53" locator="75:79-75:87" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="121" locator="26:1-30:145" name="Delivery Encounter with Age Range" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="121">
               <a:s>define &quot;Delivery Encounter with Age Range&quot;:
  </a:s>
               <a:s r="120">
                  <a:s>
                     <a:s r="42">
                        <a:s r="41">
                           <a:s>
                              <a:s>&quot;Encounter with Age Range&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s> EncounterWithAge</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
                </a:s>
                  <a:s r="119">
                     <a:s>with </a:s>
                     <a:s r="44">
                        <a:s r="43">
                           <a:s r="43">
                              <a:s>[&quot;Procedure&quot;: </a:s>
                              <a:s>
                                 <a:s>&quot;Delivery Procedures&quot;</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> DeliveryProcedure</a:s>
                     </a:s>
                     <a:s>
                such that </a:s>
                     <a:s r="118">
                        <a:s r="48">
                           <a:s r="46">
                              <a:s r="45">
                                 <a:s>DeliveryProcedure</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="46">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="47">
                              <a:s>'completed'</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
                and </a:s>
                        <a:s r="117">
                           <a:s r="51">
                              <a:s r="50">
                                 <a:s r="49">
                                    <a:s>DeliveryProcedure</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="50">
                                    <a:s>performed</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="51">
                                 <a:s>toInterval  ( )</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="117"> starts during day of </a:s>
                           <a:s r="116">
                              <a:s r="52">
                                 <a:s>EncounterWithAge</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="116">
                                 <a:s>hospitalizationWithEDOBTriageObservation ()</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="120" locator="27:3-30:145" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="42" locator="27:3-27:45" alias="EncounterWithAge">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="41" locator="27:3-27:28" name="Encounter with Age Range" xsi:type="ExpressionRef">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <relationship localId="119" locator="28:17-30:145" alias="DeliveryProcedure" xsi:type="With">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="43" locator="28:22-28:57" dataType="fhir:Procedure" templateId="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-procedure" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Procedure" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <codes locator="28:36-28:56" resultTypeName="t:ValueSet" name="Delivery Procedures" preserve="true" xsi:type="ValueSetRef"/>
               </expression>
               <suchThat localId="118" locator="29:27-30:145" resultTypeName="t:Boolean" xsi:type="And">
                  <operand localId="48" locator="29:27-29:64" resultTypeName="t:Boolean" xsi:type="Equal">
                     <operand localId="46" locator="29:27-29:50" resultTypeName="t:String" path="value" xsi:type="Property">
                        <source path="status" scope="DeliveryProcedure" xsi:type="Property"/>
                     </operand>
                     <operand localId="47" locator="29:54-29:64" resultTypeName="t:String" valueType="t:String" value="completed" xsi:type="Literal"/>
                  </operand>
                  <operand localId="117" locator="30:21-30:145" resultTypeName="t:Boolean" precision="Day" xsi:type="In">
                     <operand locator="30:65-30:70" xsi:type="Start">
                        <operand localId="51" locator="30:21-30:63" name="toInterval" libraryName="QICoreCommon" xsi:type="FunctionRef">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <operand localId="50" locator="30:21-30:47" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                 <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 <choice xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </choice>
                              </resultTypeSpecifier>
                              <operand path="performed" scope="DeliveryProcedure" xsi:type="Property"/>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="116" locator="30:86-30:145" name="hospitalizationWithEDOBTriageObservation" xsi:type="FunctionRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <operand localId="52" locator="30:86-30:101" resultTypeName="fhir:Encounter" name="EncounterWithAge" xsi:type="AliasRef"/>
                     </operand>
                  </operand>
               </suchThat>
            </relationship>
         </expression>
      </def>
      <def localId="168" locator="118:1-125:21" resultTypeName="t:DateTime" name="lastTimeOfDelivery" context="Patient" accessLevel="Public" fluent="true" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="168">
               <a:s>define fluent function lastTimeOfDelivery (TheEncounter </a:s>
               <a:s r="128">
                  <a:s>Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="167">
                  <a:s r="167">
                     <a:s r="165">
                        <a:s r="164">
                           <a:s>Last(</a:s>
                           <a:s r="163">
                              <a:s>
                                 <a:s r="130">
                                    <a:s r="129">
                                       <a:s r="129">
                                          <a:s>[&quot;Observation&quot;: </a:s>
                                          <a:s>
                                             <a:s>&quot;Date and time of obstetric delivery&quot;</a:s>
                                          </a:s>
                                          <a:s>]</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> TimeOfDelivery</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      </a:s>
                              <a:s r="158">
                                 <a:s>where </a:s>
                                 <a:s r="158">
                                    <a:s r="150">
                                       <a:s r="143">
                                          <a:s r="135">
                                             <a:s r="134">
                                                <a:s r="132">
                                                   <a:s r="131">
                                                      <a:s>TimeOfDelivery</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="132">
                                                      <a:s>value</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="133">
                                                   <a:s>DateTime</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> is not null</a:s>
                                          </a:s>
                                          <a:s>
        and </a:s>
                                          <a:s r="142">
                                             <a:s r="137">
                                                <a:s r="136">
                                                   <a:s>TimeOfDelivery</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="137">
                                                   <a:s>status</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> in </a:s>
                                             <a:s r="141">
                                                <a:s>{ </a:s>
                                                <a:s r="138">
                                                   <a:s>'final'</a:s>
                                                </a:s>
                                                <a:s>, </a:s>
                                                <a:s r="139">
                                                   <a:s>'amended'</a:s>
                                                </a:s>
                                                <a:s>, </a:s>
                                                <a:s r="140">
                                                   <a:s>'corrected'</a:s>
                                                </a:s>
                                                <a:s> }</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
        and </a:s>
                                       <a:s r="149">
                                          <a:s r="146">
                                             <a:s r="145">
                                                <a:s r="144">
                                                   <a:s>TimeOfDelivery</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="145">
                                                   <a:s>effective</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="146">
                                                <a:s>earliest ()</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s r="149"> during </a:s>
                                          <a:s r="148">
                                             <a:s r="147">
                                                <a:s>TheEncounter</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="148">
                                                <a:s>hospitalizationWithEDOBTriageObservation ()</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
        and </a:s>
                                    <a:s r="157">
                                       <a:s r="154">
                                          <a:s r="152">
                                             <a:s r="151">
                                                <a:s>TimeOfDelivery</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="152">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="153">
                                             <a:s>DateTime</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s r="157"> during </a:s>
                                       <a:s r="156">
                                          <a:s r="155">
                                             <a:s>TheEncounter</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="156">
                                             <a:s>hospitalizationWithEDOBTriageObservation()</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      </a:s>
                              <a:s r="162">
                                 <a:s>sort by </a:s>
                                 <a:s r="161">
                                    <a:s r="160">
                                       <a:s r="159">
                                          <a:s>effective</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="160">
                                          <a:s>earliest()</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
  )</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="165">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s> as </a:s>
                     <a:s r="166">
                        <a:s>DateTime</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="167" locator="119:3-125:21" resultTypeName="t:DateTime" strict="false" xsi:type="As">
            <operand localId="165" locator="119:3-125:9" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                  <choice xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                  </choice>
                  <choice name="t:Ratio" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:SampledData" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Time" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <choice xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </choice>
               </resultTypeSpecifier>
               <operand path="value" xsi:type="Property">
                  <source localId="164" locator="119:3-125:3" resultTypeName="fhir:Observation" xsi:type="Last">
                     <source localId="163" locator="119:8-124:34" xsi:type="Query">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="130" locator="119:8-119:76" alias="TimeOfDelivery">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <expression localId="129" locator="119:8-119:61" dataType="fhir:Observation" templateId="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-observation" codeProperty="code" codeComparator="~" xsi:type="Retrieve">
                              <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                                 <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <codes xsi:type="ToList">
                                 <operand locator="119:24-119:60" resultTypeName="t:Code" name="Date and time of obstetric delivery" xsi:type="CodeRef"/>
                              </codes>
                           </expression>
                        </source>
                        <where localId="158" locator="120:7-123:107" resultTypeName="t:Boolean" xsi:type="And">
                           <operand localId="150" locator="120:13-122:112" resultTypeName="t:Boolean" xsi:type="And">
                              <operand localId="143" locator="120:13-121:72" resultTypeName="t:Boolean" xsi:type="And">
                                 <operand localId="135" locator="120:13-120:56" resultTypeName="t:Boolean" xsi:type="Not">
                                    <operand locator="120:13-120:56" resultTypeName="t:Boolean" xsi:type="IsNull">
                                       <operand localId="134" locator="120:13-120:44" resultTypeName="t:DateTime" strict="false" xsi:type="As">
                                          <operand localId="132" locator="120:13-120:32" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="t:Ratio" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:SampledData" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Time" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </resultTypeSpecifier>
                                             <operand path="value" scope="TimeOfDelivery" xsi:type="Property"/>
                                          </operand>
                                          <asTypeSpecifier localId="133" locator="120:37-120:44" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       </operand>
                                    </operand>
                                 </operand>
                                 <operand localId="142" locator="121:13-121:72" resultTypeName="t:Boolean" xsi:type="In">
                                    <operand localId="137" locator="121:13-121:33" resultTypeName="fhir:ObservationStatus" path="value" xsi:type="Property">
                                       <source path="status" scope="TimeOfDelivery" xsi:type="Property"/>
                                    </operand>
                                    <operand localId="141" locator="121:38-121:72" xsi:type="List">
                                       <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                                          <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                       <element localId="138" locator="121:40-121:46" resultTypeName="t:String" valueType="t:String" value="final" xsi:type="Literal"/>
                                       <element localId="139" locator="121:49-121:57" resultTypeName="t:String" valueType="t:String" value="amended" xsi:type="Literal"/>
                                       <element localId="140" locator="121:60-121:70" resultTypeName="t:String" valueType="t:String" value="corrected" xsi:type="Literal"/>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="149" locator="122:13-122:112" resultTypeName="t:Boolean" xsi:type="In">
                                 <operand localId="146" locator="122:13-122:48" resultTypeName="t:DateTime" name="earliest" libraryName="QICoreCommon" xsi:type="FunctionRef">
                                    <operand xsi:type="Case">
                                       <caseItem>
                                          <when isType="t:DateTime" xsi:type="Is">
                                             <operand localId="145" locator="122:13-122:36" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand path="effective" scope="TimeOfDelivery" xsi:type="Property"/>
                                             </operand>
                                          </when>
                                          <then xsi:type="As">
                                             <operand asType="t:DateTime" xsi:type="As">
                                                <operand localId="145" locator="122:13-122:36" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice xsi:type="IntervalTypeSpecifier">
                                                         <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      </choice>
                                                      <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <operand path="effective" scope="TimeOfDelivery" xsi:type="Property"/>
                                                </operand>
                                             </operand>
                                             <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </asTypeSpecifier>
                                          </then>
                                       </caseItem>
                                       <caseItem>
                                          <when xsi:type="Is">
                                             <operand localId="145" locator="122:13-122:36" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand path="effective" scope="TimeOfDelivery" xsi:type="Property"/>
                                             </operand>
                                             <isTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </isTypeSpecifier>
                                          </when>
                                          <then xsi:type="As">
                                             <operand xsi:type="As">
                                                <operand localId="145" locator="122:13-122:36" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice xsi:type="IntervalTypeSpecifier">
                                                         <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      </choice>
                                                      <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <operand path="effective" scope="TimeOfDelivery" xsi:type="Property"/>
                                                </operand>
                                                <asTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </asTypeSpecifier>
                                             </operand>
                                             <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </asTypeSpecifier>
                                          </then>
                                       </caseItem>
                                       <caseItem>
                                          <when isType="t:DateTime" xsi:type="Is">
                                             <operand localId="145" locator="122:13-122:36" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand path="effective" scope="TimeOfDelivery" xsi:type="Property"/>
                                             </operand>
                                          </when>
                                          <then xsi:type="As">
                                             <operand asType="t:DateTime" xsi:type="As">
                                                <operand localId="145" locator="122:13-122:36" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice xsi:type="IntervalTypeSpecifier">
                                                         <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      </choice>
                                                      <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <operand path="effective" scope="TimeOfDelivery" xsi:type="Property"/>
                                                </operand>
                                             </operand>
                                             <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </asTypeSpecifier>
                                          </then>
                                       </caseItem>
                                       <else xsi:type="Null">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </resultTypeSpecifier>
                                       </else>
                                    </operand>
                                 </operand>
                                 <operand localId="148" locator="122:57-122:112" name="hospitalizationWithEDOBTriageObservation" xsi:type="FunctionRef">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <operand localId="147" locator="122:57-122:68" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                 </operand>
                              </operand>
                           </operand>
                           <operand localId="157" locator="123:13-123:107" resultTypeName="t:Boolean" xsi:type="In">
                              <operand localId="154" locator="123:13-123:44" resultTypeName="t:DateTime" strict="false" xsi:type="As">
                                 <operand localId="152" locator="123:13-123:32" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                       <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                       <choice xsi:type="IntervalTypeSpecifier">
                                          <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       </choice>
                                       <choice name="t:Ratio" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:SampledData" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="t:Time" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       <choice xsi:type="IntervalTypeSpecifier">
                                          <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                       </choice>
                                    </resultTypeSpecifier>
                                    <operand path="value" scope="TimeOfDelivery" xsi:type="Property"/>
                                 </operand>
                                 <asTypeSpecifier localId="153" locator="123:37-123:44" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </operand>
                              <operand localId="156" locator="123:53-123:107" name="hospitalizationWithEDOBTriageObservation" xsi:type="FunctionRef">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <operand localId="155" locator="123:53-123:64" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                              </operand>
                           </operand>
                        </where>
                        <sort localId="162" locator="124:7-124:34">
                           <by localId="161" locator="124:15-124:34" resultTypeName="t:DateTime" direction="asc" xsi:type="ByExpression">
                              <expression localId="160" locator="124:15-124:34" resultTypeName="t:DateTime" name="earliest" libraryName="QICoreCommon" xsi:type="FunctionRef">
                                 <operand xsi:type="Case">
                                    <caseItem>
                                       <when isType="t:DateTime" xsi:type="Is">
                                          <operand localId="159" locator="124:15-124:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <operand name="effective" xsi:type="IdentifierRef"/>
                                          </operand>
                                       </when>
                                       <then xsi:type="As">
                                          <operand asType="t:DateTime" xsi:type="As">
                                             <operand localId="159" locator="124:15-124:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand name="effective" xsi:type="IdentifierRef"/>
                                             </operand>
                                          </operand>
                                          <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </asTypeSpecifier>
                                       </then>
                                    </caseItem>
                                    <caseItem>
                                       <when xsi:type="Is">
                                          <operand localId="159" locator="124:15-124:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <operand name="effective" xsi:type="IdentifierRef"/>
                                          </operand>
                                          <isTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          </isTypeSpecifier>
                                       </when>
                                       <then xsi:type="As">
                                          <operand xsi:type="As">
                                             <operand localId="159" locator="124:15-124:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand name="effective" xsi:type="IdentifierRef"/>
                                             </operand>
                                             <asTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </asTypeSpecifier>
                                          </operand>
                                          <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </asTypeSpecifier>
                                       </then>
                                    </caseItem>
                                    <caseItem>
                                       <when isType="t:DateTime" xsi:type="Is">
                                          <operand localId="159" locator="124:15-124:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <operand name="effective" xsi:type="IdentifierRef"/>
                                          </operand>
                                       </when>
                                       <then xsi:type="As">
                                          <operand asType="t:DateTime" xsi:type="As">
                                             <operand localId="159" locator="124:15-124:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand name="effective" xsi:type="IdentifierRef"/>
                                             </operand>
                                          </operand>
                                          <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </asTypeSpecifier>
                                       </then>
                                    </caseItem>
                                    <else xsi:type="Null">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <choice xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          </choice>
                                          <choice xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          </choice>
                                       </resultTypeSpecifier>
                                    </else>
                                 </operand>
                              </expression>
                           </by>
                        </sort>
                     </source>
                  </source>
               </operand>
            </operand>
            <asTypeSpecifier localId="166" locator="125:14-125:21" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="128" locator="118:57-118:65" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="204" locator="101:1-108:21" resultTypeName="t:DateTime" name="lastEstimatedDeliveryDate" context="Patient" accessLevel="Public" fluent="true" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="204">
               <a:s>/*===============================================================*/
  /*  03/14/2022 from MATGlobalCommonFunctionsv7.000 - latest QDM  */
  /*     even though this PCMaternalFHIR was derived from          */
  /*     PCMaternal=2.1.000 cql, to make next update easier.       */
  /*     Will need to re-insert &quot;Global&quot;. in front of these        */
  /*     function names later (whereever they are directly used.*/
define fluent function lastEstimatedDeliveryDate (TheEncounter </a:s>
               <a:s r="171">
                  <a:s>Encounter</a:s>
               </a:s>
               <a:s> ):
  /*This function identifies the last time the EDD was assessed 42 weeks or less prior to or on delivery and stores the result of that assessment.*/
  </a:s>
               <a:s r="203">
                  <a:s r="203">
                     <a:s r="201">
                        <a:s r="200">
                           <a:s>Last(</a:s>
                           <a:s r="199">
                              <a:s>
                                 <a:s r="173">
                                    <a:s r="172">
                                       <a:s r="172">
                                          <a:s>[&quot;Observation&quot;: </a:s>
                                          <a:s>
                                             <a:s>&quot;Delivery date Estimated&quot;</a:s>
                                          </a:s>
                                          <a:s>]</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> EstimatedDateOfDelivery</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      </a:s>
                              <a:s r="194">
                                 <a:s>where </a:s>
                                 <a:s r="194">
                                    <a:s r="186">
                                       <a:s r="178">
                                          <a:s r="177">
                                             <a:s r="175">
                                                <a:s r="174">
                                                   <a:s>EstimatedDateOfDelivery</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="175">
                                                   <a:s>value</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="176">
                                                <a:s>DateTime</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> is not null</a:s>
                                       </a:s>
                                       <a:s>
        and </a:s>
                                       <a:s r="185">
                                          <a:s r="180">
                                             <a:s r="179">
                                                <a:s>EstimatedDateOfDelivery</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="180">
                                                <a:s>status</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> in </a:s>
                                          <a:s r="184">
                                             <a:s>{ </a:s>
                                             <a:s r="181">
                                                <a:s>'final'</a:s>
                                             </a:s>
                                             <a:s>, </a:s>
                                             <a:s r="182">
                                                <a:s>'amended'</a:s>
                                             </a:s>
                                             <a:s>, </a:s>
                                             <a:s r="183">
                                                <a:s>'corrected'</a:s>
                                             </a:s>
                                             <a:s> }</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
        and </a:s>
                                    <a:s r="193">
                                       <a:s r="189">
                                          <a:s r="188">
                                             <a:s r="187">
                                                <a:s>EstimatedDateOfDelivery</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="188">
                                                <a:s>effective</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="189">
                                             <a:s>earliest ( )</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="193">
                                          <a:s r="192">
                                             <a:s>42 weeks</a:s>
                                          </a:s>
                                          <a:s> or less before or on</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="191">
                                          <a:s r="190">
                                             <a:s>TheEncounter</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="191">
                                             <a:s>lastTimeOfDelivery ()</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      </a:s>
                              <a:s r="198">
                                 <a:s>sort by </a:s>
                                 <a:s r="197">
                                    <a:s r="196">
                                       <a:s r="195">
                                          <a:s>effective</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="196">
                                          <a:s>earliest ( )</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
  )</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="201">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s> as </a:s>
                     <a:s r="202">
                        <a:s>DateTime</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="203" locator="103:3-108:21" resultTypeName="t:DateTime" strict="false" xsi:type="As">
            <operand localId="201" locator="103:3-108:9" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                  <choice xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                  </choice>
                  <choice name="t:Ratio" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:SampledData" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Time" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <choice xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </choice>
               </resultTypeSpecifier>
               <operand path="value" xsi:type="Property">
                  <source localId="200" locator="103:3-108:3" resultTypeName="fhir:Observation" xsi:type="Last">
                     <source localId="199" locator="103:8-107:36" xsi:type="Query">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="173" locator="103:8-103:73" alias="EstimatedDateOfDelivery">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <expression localId="172" locator="103:8-103:49" dataType="fhir:Observation" templateId="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-observation" codeProperty="code" codeComparator="~" xsi:type="Retrieve">
                              <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                                 <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <codes xsi:type="ToList">
                                 <operand locator="103:24-103:48" resultTypeName="t:Code" name="Delivery date Estimated" xsi:type="CodeRef"/>
                              </codes>
                           </expression>
                        </source>
                        <where localId="194" locator="104:7-106:123" resultTypeName="t:Boolean" xsi:type="And">
                           <operand localId="186" locator="104:13-105:81" resultTypeName="t:Boolean" xsi:type="And">
                              <operand localId="178" locator="104:13-104:65" resultTypeName="t:Boolean" xsi:type="Not">
                                 <operand locator="104:13-104:65" resultTypeName="t:Boolean" xsi:type="IsNull">
                                    <operand localId="177" locator="104:13-104:53" resultTypeName="t:DateTime" strict="false" xsi:type="As">
                                       <operand localId="175" locator="104:13-104:41" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice name="t:Ratio" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:SampledData" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Time" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </resultTypeSpecifier>
                                          <operand path="value" scope="EstimatedDateOfDelivery" xsi:type="Property"/>
                                       </operand>
                                       <asTypeSpecifier localId="176" locator="104:46-104:53" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="185" locator="105:13-105:81" resultTypeName="t:Boolean" xsi:type="In">
                                 <operand localId="180" locator="105:13-105:42" resultTypeName="fhir:ObservationStatus" path="value" xsi:type="Property">
                                    <source path="status" scope="EstimatedDateOfDelivery" xsi:type="Property"/>
                                 </operand>
                                 <operand localId="184" locator="105:47-105:81" xsi:type="List">
                                    <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                                       <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <element localId="181" locator="105:49-105:55" resultTypeName="t:String" valueType="t:String" value="final" xsi:type="Literal"/>
                                    <element localId="182" locator="105:58-105:66" resultTypeName="t:String" valueType="t:String" value="amended" xsi:type="Literal"/>
                                    <element localId="183" locator="105:69-105:79" resultTypeName="t:String" valueType="t:String" value="corrected" xsi:type="Literal"/>
                                 </operand>
                              </operand>
                           </operand>
                           <operand localId="193" locator="106:13-106:123" resultTypeName="t:Boolean" xsi:type="And">
                              <operand locator="106:60-106:75" xsi:type="In">
                                 <operand localId="189" locator="106:13-106:58" resultTypeName="t:DateTime" name="earliest" libraryName="QICoreCommon" xsi:type="FunctionRef">
                                    <operand xsi:type="Case">
                                       <caseItem>
                                          <when isType="t:DateTime" xsi:type="Is">
                                             <operand localId="188" locator="106:13-106:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand path="effective" scope="EstimatedDateOfDelivery" xsi:type="Property"/>
                                             </operand>
                                          </when>
                                          <then xsi:type="As">
                                             <operand asType="t:DateTime" xsi:type="As">
                                                <operand localId="188" locator="106:13-106:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice xsi:type="IntervalTypeSpecifier">
                                                         <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      </choice>
                                                      <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <operand path="effective" scope="EstimatedDateOfDelivery" xsi:type="Property"/>
                                                </operand>
                                             </operand>
                                             <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </asTypeSpecifier>
                                          </then>
                                       </caseItem>
                                       <caseItem>
                                          <when xsi:type="Is">
                                             <operand localId="188" locator="106:13-106:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand path="effective" scope="EstimatedDateOfDelivery" xsi:type="Property"/>
                                             </operand>
                                             <isTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </isTypeSpecifier>
                                          </when>
                                          <then xsi:type="As">
                                             <operand xsi:type="As">
                                                <operand localId="188" locator="106:13-106:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice xsi:type="IntervalTypeSpecifier">
                                                         <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      </choice>
                                                      <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <operand path="effective" scope="EstimatedDateOfDelivery" xsi:type="Property"/>
                                                </operand>
                                                <asTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </asTypeSpecifier>
                                             </operand>
                                             <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </asTypeSpecifier>
                                          </then>
                                       </caseItem>
                                       <caseItem>
                                          <when isType="t:DateTime" xsi:type="Is">
                                             <operand localId="188" locator="106:13-106:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand path="effective" scope="EstimatedDateOfDelivery" xsi:type="Property"/>
                                             </operand>
                                          </when>
                                          <then xsi:type="As">
                                             <operand asType="t:DateTime" xsi:type="As">
                                                <operand localId="188" locator="106:13-106:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice xsi:type="IntervalTypeSpecifier">
                                                         <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      </choice>
                                                      <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <operand path="effective" scope="EstimatedDateOfDelivery" xsi:type="Property"/>
                                                </operand>
                                             </operand>
                                             <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </asTypeSpecifier>
                                          </then>
                                       </caseItem>
                                       <else xsi:type="Null">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </resultTypeSpecifier>
                                       </else>
                                    </operand>
                                 </operand>
                                 <operand locator="106:60-106:75" lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <low locator="106:103-106:123" xsi:type="Subtract">
                                       <operand localId="191" locator="106:90-106:123" resultTypeName="t:DateTime" name="lastTimeOfDelivery" xsi:type="FunctionRef">
                                          <operand localId="190" locator="106:90-106:101" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                       </operand>
                                       <operand localId="192" locator="106:60-106:67" resultTypeName="t:Quantity" value="42" unit="weeks" xsi:type="Quantity"/>
                                    </low>
                                    <high localId="191" locator="106:90-106:123" resultTypeName="t:DateTime" name="lastTimeOfDelivery" xsi:type="FunctionRef">
                                       <operand localId="190" locator="106:90-106:101" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                    </high>
                                 </operand>
                              </operand>
                              <operand locator="106:60-106:75" xsi:type="Not">
                                 <operand locator="106:60-106:75" xsi:type="IsNull">
                                    <operand localId="191" locator="106:90-106:123" resultTypeName="t:DateTime" name="lastTimeOfDelivery" xsi:type="FunctionRef">
                                       <operand localId="190" locator="106:90-106:101" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                    </operand>
                                 </operand>
                              </operand>
                           </operand>
                        </where>
                        <sort localId="198" locator="107:7-107:36">
                           <by localId="197" locator="107:15-107:36" resultTypeName="t:DateTime" direction="asc" xsi:type="ByExpression">
                              <expression localId="196" locator="107:15-107:36" resultTypeName="t:DateTime" name="earliest" libraryName="QICoreCommon" xsi:type="FunctionRef">
                                 <operand xsi:type="Case">
                                    <caseItem>
                                       <when isType="t:DateTime" xsi:type="Is">
                                          <operand localId="195" locator="107:15-107:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <operand name="effective" xsi:type="IdentifierRef"/>
                                          </operand>
                                       </when>
                                       <then xsi:type="As">
                                          <operand asType="t:DateTime" xsi:type="As">
                                             <operand localId="195" locator="107:15-107:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand name="effective" xsi:type="IdentifierRef"/>
                                             </operand>
                                          </operand>
                                          <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </asTypeSpecifier>
                                       </then>
                                    </caseItem>
                                    <caseItem>
                                       <when xsi:type="Is">
                                          <operand localId="195" locator="107:15-107:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <operand name="effective" xsi:type="IdentifierRef"/>
                                          </operand>
                                          <isTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          </isTypeSpecifier>
                                       </when>
                                       <then xsi:type="As">
                                          <operand xsi:type="As">
                                             <operand localId="195" locator="107:15-107:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand name="effective" xsi:type="IdentifierRef"/>
                                             </operand>
                                             <asTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </asTypeSpecifier>
                                          </operand>
                                          <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </asTypeSpecifier>
                                       </then>
                                    </caseItem>
                                    <caseItem>
                                       <when isType="t:DateTime" xsi:type="Is">
                                          <operand localId="195" locator="107:15-107:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <operand name="effective" xsi:type="IdentifierRef"/>
                                          </operand>
                                       </when>
                                       <then xsi:type="As">
                                          <operand asType="t:DateTime" xsi:type="As">
                                             <operand localId="195" locator="107:15-107:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand name="effective" xsi:type="IdentifierRef"/>
                                             </operand>
                                          </operand>
                                          <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </asTypeSpecifier>
                                       </then>
                                    </caseItem>
                                    <else xsi:type="Null">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <choice xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          </choice>
                                          <choice xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          </choice>
                                       </resultTypeSpecifier>
                                    </else>
                                 </operand>
                              </expression>
                           </by>
                        </sort>
                     </source>
                  </source>
               </operand>
            </operand>
            <asTypeSpecifier localId="202" locator="108:14-108:21" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="171" locator="101:64-101:72" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="210" locator="48:1-50:128" resultTypeName="t:Integer" name="calculatedGestationalAge" context="Patient" accessLevel="Public" fluent="true" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="210">
               <a:s>define fluent function calculatedGestationalAge (TheEncounter </a:s>
               <a:s r="125">
                  <a:s>Encounter</a:s>
               </a:s>
               <a:s> ):
  //Gestational Age = (280-(Estimated Delivery Date minus Reference Date/Delivery Date))/7
  </a:s>
               <a:s r="209">
                  <a:s r="209">
                     <a:s r="207">
                        <a:s>( </a:s>
                        <a:s r="207">
                           <a:s r="126">280 - </a:s>
                           <a:s r="206">
                              <a:s>( </a:s>
                              <a:s r="206">
                                 <a:s>difference in days between </a:s>
                                 <a:s r="169">
                                    <a:s r="127">
                                       <a:s>TheEncounter</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="169">
                                       <a:s>lastTimeOfDelivery ()</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> and </a:s>
                                 <a:s r="205">
                                    <a:s r="170">
                                       <a:s>TheEncounter</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="205">
                                       <a:s>lastEstimatedDeliveryDate( )</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s> )</a:s>
                     </a:s>
                     <a:s r="208"> div 7</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="209" locator="50:3-50:128" resultTypeName="t:Integer" xsi:type="TruncatedDivide">
            <operand localId="207" locator="50:3-50:122" resultTypeName="t:Integer" xsi:type="Subtract">
               <operand localId="126" locator="50:5-50:7" resultTypeName="t:Integer" valueType="t:Integer" value="280" xsi:type="Literal"/>
               <operand localId="206" locator="50:11-50:120" resultTypeName="t:Integer" precision="Day" xsi:type="DifferenceBetween">
                  <operand localId="169" locator="50:40-50:73" resultTypeName="t:DateTime" name="lastTimeOfDelivery" xsi:type="FunctionRef">
                     <operand localId="127" locator="50:40-50:51" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                  </operand>
                  <operand localId="205" locator="50:79-50:119" resultTypeName="t:DateTime" name="lastEstimatedDeliveryDate" xsi:type="FunctionRef">
                     <operand localId="170" locator="50:79-50:90" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                  </operand>
               </operand>
            </operand>
            <operand localId="208" locator="50:128" resultTypeName="t:Integer" valueType="t:Integer" value="7" xsi:type="Literal"/>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="125" locator="48:63-48:71" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="219" locator="38:1-46:5" name="Variable Calculated Gestational Age" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="219">
               <a:s>define &quot;Variable Calculated Gestational Age&quot;:
  //This definition establishes a variable of CGA (Calculated Gestational Age) for all patients for the sole purpose of displaying the Calculated Gestational Age. This definition is not used in the measure logic.
  </a:s>
               <a:s r="218">
                  <a:s>
                     <a:s r="123">
                        <a:s r="122">
                           <a:s>
                              <a:s>&quot;Delivery Encounter with Age Range&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s> QualifyingEncounter</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s>
                     <a:s>let </a:s>
                     <a:s r="212">
                        <a:s>CGA: </a:s>
                        <a:s r="211">
                           <a:s r="124">
                              <a:s>QualifyingEncounter</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="211">
                              <a:s>calculatedGestationalAge()</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
  //  return { QualifyingEncounter, CGA }
    </a:s>
                  <a:s r="217">
                     <a:s>return </a:s>
                     <a:s r="216">
                        <a:s>{
      </a:s>
                        <a:s>
                           <a:s>EncounterID: </a:s>
                           <a:s r="214">
                              <a:s r="213">
                                 <a:s>QualifyingEncounter</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="214">
                                 <a:s>id</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
      </a:s>
                        <a:s>
                           <a:s>CalculatedCGA: </a:s>
                           <a:s r="215">
                              <a:s>CGA</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
    }</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType xsi:type="TupleTypeSpecifier">
               <element name="EncounterID">
                  <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
               </element>
               <element name="CalculatedCGA">
                  <elementType name="t:Integer" xsi:type="NamedTypeSpecifier"/>
               </element>
            </elementType>
         </resultTypeSpecifier>
         <expression localId="218" locator="40:3-46:5" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType xsi:type="TupleTypeSpecifier">
                  <element name="EncounterID">
                     <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </element>
                  <element name="CalculatedCGA">
                     <elementType name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                  </element>
               </elementType>
            </resultTypeSpecifier>
            <source localId="123" locator="40:3-40:57" alias="QualifyingEncounter">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="122" locator="40:3-40:37" name="Delivery Encounter with Age Range" xsi:type="ExpressionRef">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <let localId="212" locator="41:9-41:59" resultTypeName="t:Integer" identifier="CGA">
               <expression localId="211" locator="41:14-41:59" resultTypeName="t:Integer" name="calculatedGestationalAge" xsi:type="FunctionRef">
                  <operand localId="124" locator="41:14-41:32" resultTypeName="fhir:Encounter" name="QualifyingEncounter" xsi:type="AliasRef"/>
               </expression>
            </let>
            <return localId="217" locator="43:5-46:5">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType xsi:type="TupleTypeSpecifier">
                     <element name="EncounterID">
                        <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
                     </element>
                     <element name="CalculatedCGA">
                        <elementType name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                     </element>
                  </elementType>
               </resultTypeSpecifier>
               <expression localId="216" locator="43:12-46:5" xsi:type="Tuple">
                  <resultTypeSpecifier xsi:type="TupleTypeSpecifier">
                     <element name="EncounterID">
                        <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
                     </element>
                     <element name="CalculatedCGA">
                        <elementType name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                     </element>
                  </resultTypeSpecifier>
                  <element name="EncounterID">
                     <value localId="214" locator="44:20-44:41" resultTypeName="t:String" path="value" xsi:type="Property">
                        <source path="id" scope="QualifyingEncounter" xsi:type="Property"/>
                     </value>
                  </element>
                  <element name="CalculatedCGA">
                     <value localId="215" locator="45:22-45:24" resultTypeName="t:Integer" name="CGA" xsi:type="QueryLetRef"/>
                  </element>
               </expression>
            </return>
         </expression>
      </def>
      <def localId="257" locator="110:1-116:21" resultTypeName="t:Quantity" name="lastEstimatedGestationalAge" context="Patient" accessLevel="Public" fluent="true" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="257">
               <a:s>define fluent function lastEstimatedGestationalAge (TheEncounter </a:s>
               <a:s r="226">
                  <a:s>Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="256">
                  <a:s r="256">
                     <a:s r="254">
                        <a:s r="253">
                           <a:s>Last(</a:s>
                           <a:s r="252">
                              <a:s>
                                 <a:s r="228">
                                    <a:s r="227">
                                       <a:s r="227">
                                          <a:s>[&quot;Observation&quot;: </a:s>
                                          <a:s>
                                             <a:s>&quot;Estimated Gestational Age at Delivery&quot;</a:s>
                                          </a:s>
                                          <a:s>]</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> EstimatedGestationalAge</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      </a:s>
                              <a:s r="247">
                                 <a:s>where </a:s>
                                 <a:s r="247">
                                    <a:s r="239">
                                       <a:s r="231">
                                          <a:s r="230">
                                             <a:s r="229">
                                                <a:s>EstimatedGestationalAge</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="230">
                                                <a:s>value</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> is not null</a:s>
                                       </a:s>
                                       <a:s>
        and </a:s>
                                       <a:s r="238">
                                          <a:s r="233">
                                             <a:s r="232">
                                                <a:s>EstimatedGestationalAge</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="233">
                                                <a:s>status</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> in </a:s>
                                          <a:s r="237">
                                             <a:s>{ </a:s>
                                             <a:s r="234">
                                                <a:s>'final'</a:s>
                                             </a:s>
                                             <a:s>, </a:s>
                                             <a:s r="235">
                                                <a:s>'amended'</a:s>
                                             </a:s>
                                             <a:s>, </a:s>
                                             <a:s r="236">
                                                <a:s>'corrected'</a:s>
                                             </a:s>
                                             <a:s> }</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
        and </a:s>
                                    <a:s r="246">
                                       <a:s r="242">
                                          <a:s r="241">
                                             <a:s r="240">
                                                <a:s>EstimatedGestationalAge</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="241">
                                                <a:s>effective</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="242">
                                             <a:s>earliest()</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="246">
                                          <a:s r="245">
                                             <a:s>24 hours</a:s>
                                          </a:s>
                                          <a:s> or less before or on</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="244">
                                          <a:s r="243">
                                             <a:s>TheEncounter</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="244">
                                             <a:s>lastTimeOfDelivery ()</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      </a:s>
                              <a:s r="251">
                                 <a:s>sort by </a:s>
                                 <a:s r="250">
                                    <a:s r="249">
                                       <a:s r="248">
                                          <a:s>effective</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="249">
                                          <a:s>earliest ()</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
  )</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="254">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s> as </a:s>
                     <a:s r="255">
                        <a:s>Quantity</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="256" locator="111:3-116:21" resultTypeName="t:Quantity" strict="false" xsi:type="As">
            <operand localId="254" locator="111:3-116:9" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                  <choice xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                  </choice>
                  <choice name="t:Ratio" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:SampledData" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:Time" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <choice xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </choice>
               </resultTypeSpecifier>
               <operand path="value" xsi:type="Property">
                  <source localId="253" locator="111:3-116:3" resultTypeName="fhir:Observation" xsi:type="Last">
                     <source localId="252" locator="111:8-115:35" xsi:type="Query">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="228" locator="111:8-111:87" alias="EstimatedGestationalAge">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <expression localId="227" locator="111:8-111:63" dataType="fhir:Observation" templateId="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-observation" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                              <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                                 <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <codes locator="111:24-111:62" resultTypeName="t:ValueSet" name="Estimated Gestational Age at Delivery" preserve="true" xsi:type="ValueSetRef"/>
                           </expression>
                        </source>
                        <where localId="247" locator="112:7-114:121" resultTypeName="t:Boolean" xsi:type="And">
                           <operand localId="239" locator="112:13-113:81" resultTypeName="t:Boolean" xsi:type="And">
                              <operand localId="231" locator="112:13-112:53" resultTypeName="t:Boolean" xsi:type="Not">
                                 <operand locator="112:13-112:53" resultTypeName="t:Boolean" xsi:type="IsNull">
                                    <operand localId="230" locator="112:13-112:41" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                                          <choice xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          </choice>
                                          <choice name="t:Ratio" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:SampledData" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="t:Time" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          </choice>
                                       </resultTypeSpecifier>
                                       <operand path="value" scope="EstimatedGestationalAge" xsi:type="Property"/>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="238" locator="113:13-113:81" resultTypeName="t:Boolean" xsi:type="In">
                                 <operand localId="233" locator="113:13-113:42" resultTypeName="fhir:ObservationStatus" path="value" xsi:type="Property">
                                    <source path="status" scope="EstimatedGestationalAge" xsi:type="Property"/>
                                 </operand>
                                 <operand localId="237" locator="113:47-113:81" xsi:type="List">
                                    <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                                       <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <element localId="234" locator="113:49-113:55" resultTypeName="t:String" valueType="t:String" value="final" xsi:type="Literal"/>
                                    <element localId="235" locator="113:58-113:66" resultTypeName="t:String" valueType="t:String" value="amended" xsi:type="Literal"/>
                                    <element localId="236" locator="113:69-113:79" resultTypeName="t:String" valueType="t:String" value="corrected" xsi:type="Literal"/>
                                 </operand>
                              </operand>
                           </operand>
                           <operand localId="246" locator="114:13-114:121" resultTypeName="t:Boolean" xsi:type="And">
                              <operand locator="114:58-114:73" xsi:type="In">
                                 <operand localId="242" locator="114:13-114:56" resultTypeName="t:DateTime" name="earliest" libraryName="QICoreCommon" xsi:type="FunctionRef">
                                    <operand xsi:type="Case">
                                       <caseItem>
                                          <when isType="t:DateTime" xsi:type="Is">
                                             <operand localId="241" locator="114:13-114:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand path="effective" scope="EstimatedGestationalAge" xsi:type="Property"/>
                                             </operand>
                                          </when>
                                          <then xsi:type="As">
                                             <operand asType="t:DateTime" xsi:type="As">
                                                <operand localId="241" locator="114:13-114:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice xsi:type="IntervalTypeSpecifier">
                                                         <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      </choice>
                                                      <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <operand path="effective" scope="EstimatedGestationalAge" xsi:type="Property"/>
                                                </operand>
                                             </operand>
                                             <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </asTypeSpecifier>
                                          </then>
                                       </caseItem>
                                       <caseItem>
                                          <when xsi:type="Is">
                                             <operand localId="241" locator="114:13-114:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand path="effective" scope="EstimatedGestationalAge" xsi:type="Property"/>
                                             </operand>
                                             <isTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </isTypeSpecifier>
                                          </when>
                                          <then xsi:type="As">
                                             <operand xsi:type="As">
                                                <operand localId="241" locator="114:13-114:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice xsi:type="IntervalTypeSpecifier">
                                                         <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      </choice>
                                                      <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <operand path="effective" scope="EstimatedGestationalAge" xsi:type="Property"/>
                                                </operand>
                                                <asTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </asTypeSpecifier>
                                             </operand>
                                             <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </asTypeSpecifier>
                                          </then>
                                       </caseItem>
                                       <caseItem>
                                          <when isType="t:DateTime" xsi:type="Is">
                                             <operand localId="241" locator="114:13-114:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand path="effective" scope="EstimatedGestationalAge" xsi:type="Property"/>
                                             </operand>
                                          </when>
                                          <then xsi:type="As">
                                             <operand asType="t:DateTime" xsi:type="As">
                                                <operand localId="241" locator="114:13-114:45" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice xsi:type="IntervalTypeSpecifier">
                                                         <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                      </choice>
                                                      <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <operand path="effective" scope="EstimatedGestationalAge" xsi:type="Property"/>
                                                </operand>
                                             </operand>
                                             <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                             </asTypeSpecifier>
                                          </then>
                                       </caseItem>
                                       <else xsi:type="Null">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </resultTypeSpecifier>
                                       </else>
                                    </operand>
                                 </operand>
                                 <operand locator="114:58-114:73" lowClosed="true" highClosed="true" xsi:type="Interval">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <low locator="114:101-114:121" xsi:type="Subtract">
                                       <operand localId="244" locator="114:88-114:121" resultTypeName="t:DateTime" name="lastTimeOfDelivery" xsi:type="FunctionRef">
                                          <operand localId="243" locator="114:88-114:99" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                       </operand>
                                       <operand localId="245" locator="114:58-114:65" resultTypeName="t:Quantity" value="24" unit="hours" xsi:type="Quantity"/>
                                    </low>
                                    <high localId="244" locator="114:88-114:121" resultTypeName="t:DateTime" name="lastTimeOfDelivery" xsi:type="FunctionRef">
                                       <operand localId="243" locator="114:88-114:99" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                    </high>
                                 </operand>
                              </operand>
                              <operand locator="114:58-114:73" xsi:type="Not">
                                 <operand locator="114:58-114:73" xsi:type="IsNull">
                                    <operand localId="244" locator="114:88-114:121" resultTypeName="t:DateTime" name="lastTimeOfDelivery" xsi:type="FunctionRef">
                                       <operand localId="243" locator="114:88-114:99" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                    </operand>
                                 </operand>
                              </operand>
                           </operand>
                        </where>
                        <sort localId="251" locator="115:7-115:35">
                           <by localId="250" locator="115:15-115:35" resultTypeName="t:DateTime" direction="asc" xsi:type="ByExpression">
                              <expression localId="249" locator="115:15-115:35" resultTypeName="t:DateTime" name="earliest" libraryName="QICoreCommon" xsi:type="FunctionRef">
                                 <operand xsi:type="Case">
                                    <caseItem>
                                       <when isType="t:DateTime" xsi:type="Is">
                                          <operand localId="248" locator="115:15-115:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <operand name="effective" xsi:type="IdentifierRef"/>
                                          </operand>
                                       </when>
                                       <then xsi:type="As">
                                          <operand asType="t:DateTime" xsi:type="As">
                                             <operand localId="248" locator="115:15-115:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand name="effective" xsi:type="IdentifierRef"/>
                                             </operand>
                                          </operand>
                                          <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </asTypeSpecifier>
                                       </then>
                                    </caseItem>
                                    <caseItem>
                                       <when xsi:type="Is">
                                          <operand localId="248" locator="115:15-115:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <operand name="effective" xsi:type="IdentifierRef"/>
                                          </operand>
                                          <isTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          </isTypeSpecifier>
                                       </when>
                                       <then xsi:type="As">
                                          <operand xsi:type="As">
                                             <operand localId="248" locator="115:15-115:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand name="effective" xsi:type="IdentifierRef"/>
                                             </operand>
                                             <asTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </asTypeSpecifier>
                                          </operand>
                                          <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </asTypeSpecifier>
                                       </then>
                                    </caseItem>
                                    <caseItem>
                                       <when isType="t:DateTime" xsi:type="Is">
                                          <operand localId="248" locator="115:15-115:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice xsi:type="IntervalTypeSpecifier">
                                                   <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </choice>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <operand name="effective" xsi:type="IdentifierRef"/>
                                          </operand>
                                       </when>
                                       <then xsi:type="As">
                                          <operand asType="t:DateTime" xsi:type="As">
                                             <operand localId="248" locator="115:15-115:23" name="ToValue" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice xsi:type="IntervalTypeSpecifier">
                                                      <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                   </choice>
                                                   <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <operand name="effective" xsi:type="IdentifierRef"/>
                                             </operand>
                                          </operand>
                                          <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                             <choice xsi:type="IntervalTypeSpecifier">
                                                <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             </choice>
                                          </asTypeSpecifier>
                                       </then>
                                    </caseItem>
                                    <else xsi:type="Null">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <choice xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                          </choice>
                                          <choice xsi:type="IntervalTypeSpecifier">
                                             <pointType name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          </choice>
                                       </resultTypeSpecifier>
                                    </else>
                                 </operand>
                              </expression>
                           </by>
                        </sort>
                     </source>
                  </source>
               </operand>
            </operand>
            <asTypeSpecifier localId="255" locator="116:14-116:21" resultTypeName="t:Quantity" name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="226" locator="110:66-110:74" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
   </statements>
</library>