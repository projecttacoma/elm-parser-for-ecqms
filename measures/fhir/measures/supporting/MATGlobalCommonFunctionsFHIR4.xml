<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation translatorOptions="EnableAnnotations,EnableLocators,EnableResultTypes,DisableListDemotion,DisableListPromotion" xsi:type="a:CqlToElmInfo"/>
   <annotation libraryId="MATGlobalCommonFunctionsFHIR4" libraryVersion="6.1.000" startLine="344" startChar="19" endLine="344" endChar="53" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="813">
         <a:s>library MATGlobalCommonFunctionsFHIR4 version '6.1.000'</a:s>
      </a:s>
   </annotation>
   <identifier id="MATGlobalCommonFunctionsFHIR4" version="6.1.000"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="1" locator="21:1-21:26" localIdentifier="FHIR" uri="http://hl7.org/fhir" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:t name="update" value="BTR 2020-03-31 ->"/>
            <a:t name="update" value="BTR 2020-03-31 ->&#xa;Incremented version to 5.0.000&#xa;Updated FHIR version to 4.0.1&#xa;Changed timezone keyword to timezoneoffset for use with CQL 1.4&#xa;Removed Normalize Onset in favor of more general Normalize Interval&#xa;Updated CodeSystems for ConditionVerificationStatusCodes and RoleCodes"/>
            <a:t name="update" value="BTR 2021-05-13 ->&#xa;Added ActiveCondition Codes and Inactive Condition Codes value sets&#xa;Added function documentation throughout&#xa;Fixed EDVisit not using Last&#xa;Updated prevalence period to use an inclusive boundary if the condition is active&#xa;Added HasStart, HasEnd, Earliest, and Latest functions&#xa;Removed ToDate and Age calculation functions"/>
            <a:t name="update" value="BTR 2021-06-25 ->&#xa;Added GetBaseExtension overloads for Element"/>
            <a:s r="1">
               <a:s>/*@update: BTR 2020-03-31 ->
Incremented version to 5.0.000
Updated FHIR version to 4.0.1
Changed timezone keyword to timezoneoffset for use with CQL 1.4
Removed Normalize Onset in favor of more general Normalize Interval
Updated CodeSystems for ConditionVerificationStatusCodes and RoleCodes

@update: BTR 2021-05-13 ->
Added ActiveCondition Codes and Inactive Condition Codes value sets
Added function documentation throughout
Fixed EDVisit not using Last
Updated prevalence period to use an inclusive boundary if the condition is active
Added HasStart, HasEnd, Earliest, and Latest functions
Removed ToDate and Age calculation functions

@update: BTR 2021-06-25 ->
Added GetBaseExtension overloads for Element*/
using </a:s>
               <a:s>
                  <a:s>FHIR</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="2" locator="23:1-23:56" localIdentifier="FHIRHelpers" path="FHIRHelpers" version="4.0.001">
         <annotation xsi:type="a:Annotation">
            <a:s r="2">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.0.001' called FHIRHelpers</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <parameters>
      <def localId="71" locator="66:1-67:66" name="Measurement Period" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="71">
               <a:s>parameter &quot;Measurement Period&quot; </a:s>
               <a:s r="70">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="69">
                     <a:s>DateTime</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s>
  default </a:s>
               <a:s r="68">
                  <a:s r="66">Interval[@2019-01-01T00:00:00.0, @2020-01-01T00:00:00.0)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
            <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <default localId="68" locator="67:11-67:66" lowClosed="true" highClosed="false" xsi:type="Interval">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <low localId="66" locator="67:20-67:41" resultTypeName="t:DateTime" xsi:type="DateTime">
               <year valueType="t:Integer" value="2019" xsi:type="Literal"/>
               <month valueType="t:Integer" value="1" xsi:type="Literal"/>
               <day valueType="t:Integer" value="1" xsi:type="Literal"/>
               <hour valueType="t:Integer" value="0" xsi:type="Literal"/>
               <minute valueType="t:Integer" value="0" xsi:type="Literal"/>
               <second valueType="t:Integer" value="0" xsi:type="Literal"/>
               <millisecond valueType="t:Integer" value="0" xsi:type="Literal"/>
            </low>
            <high localId="67" locator="67:44-67:65" resultTypeName="t:DateTime" xsi:type="DateTime">
               <year valueType="t:Integer" value="2020" xsi:type="Literal"/>
               <month valueType="t:Integer" value="1" xsi:type="Literal"/>
               <day valueType="t:Integer" value="1" xsi:type="Literal"/>
               <hour valueType="t:Integer" value="0" xsi:type="Literal"/>
               <minute valueType="t:Integer" value="0" xsi:type="Literal"/>
               <second valueType="t:Integer" value="0" xsi:type="Literal"/>
               <millisecond valueType="t:Integer" value="0" xsi:type="Literal"/>
            </high>
         </default>
         <parameterTypeSpecifier localId="70" locator="66:32-66:49" xsi:type="IntervalTypeSpecifier">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <pointType localId="69" locator="66:41-66:48" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </parameterTypeSpecifier>
      </def>
   </parameters>
   <codeSystems>
      <def localId="3" locator="25:1-25:101" resultTypeName="t:CodeSystem" name="ConditionClinicalStatusCodes" id="http://terminology.hl7.org/CodeSystem/condition-clinical" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="3">
               <a:s>codesystem &quot;ConditionClinicalStatusCodes&quot;: 'http://terminology.hl7.org/CodeSystem/condition-clinical'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="4" locator="26:1-26:119" resultTypeName="t:CodeSystem" name="AllergyIntoleranceClinicalStatusCodes" id="http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="4">
               <a:s>codesystem &quot;AllergyIntoleranceClinicalStatusCodes&quot;: 'http://terminology.hl7.org/CodeSystem/allergyintolerance-clinical'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="5" locator="27:1-27:127" resultTypeName="t:CodeSystem" name="AllergyIntoleranceVerificationStatusCodes" id="http://terminology.hl7.org/CodeSystem/allergyintolerance-verification" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="5">
               <a:s>codesystem &quot;AllergyIntoleranceVerificationStatusCodes&quot;: 'http://terminology.hl7.org/CodeSystem/allergyintolerance-verification'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="6" locator="28:1-28:83" resultTypeName="t:CodeSystem" name="Diagnosis Role" id="http://terminology.hl7.org/CodeSystem/diagnosis-role" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="6">
               <a:s>codesystem &quot;Diagnosis Role&quot;: 'http://terminology.hl7.org/CodeSystem/diagnosis-role'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="7" locator="29:1-29:38" resultTypeName="t:CodeSystem" name="LOINC" id="http://loinc.org" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="7">
               <a:s>codesystem &quot;LOINC&quot;: 'http://loinc.org'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="8" locator="30:1-30:106" resultTypeName="t:CodeSystem" name="MedicationRequestCategory" id="http://terminology.hl7.org/CodeSystem/medicationrequest-category" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="8">
               <a:s>codesystem &quot;MedicationRequestCategory&quot;: 'http://terminology.hl7.org/CodeSystem/medicationrequest-category'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="9" locator="31:1-31:107" resultTypeName="t:CodeSystem" name="ConditionVerificationStatusCodes" id="http://terminology.hl7.org/CodeSystem/condition-ver-status" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="9">
               <a:s>codesystem &quot;ConditionVerificationStatusCodes&quot;: 'http://terminology.hl7.org/CodeSystem/condition-ver-status'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="10" locator="32:1-32:47" resultTypeName="t:CodeSystem" name="SNOMEDCT" id="http://snomed.info/sct" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="10">
               <a:s>codesystem &quot;SNOMEDCT&quot;: 'http://snomed.info/sct'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="11" locator="33:1-33:74" resultTypeName="t:CodeSystem" name="RoleCode" id="http://terminology.hl7.org/CodeSystem/v3-RoleCode" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="11">
               <a:s>codesystem &quot;RoleCode&quot;: 'http://terminology.hl7.org/CodeSystem/v3-RoleCode'</a:s>
            </a:s>
         </annotation>
      </def>
   </codeSystems>
   <valueSets>
      <def localId="12" locator="35:1-35:111" resultTypeName="t:ValueSet" name="Emergency Department Visit" id="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="12">
               <a:s>valueset &quot;Emergency Department Visit&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="13" locator="36:1-36:100" resultTypeName="t:ValueSet" name="Encounter Inpatient" id="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="13">
               <a:s>valueset &quot;Encounter Inpatient&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="14" locator="37:1-37:102" resultTypeName="t:ValueSet" name="Observation Services" id="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="14">
               <a:s>valueset &quot;Observation Services&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="15" locator="38:1-38:129" resultTypeName="t:ValueSet" name="Present on Admission or Clinically Undetermined" id="http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1147.197" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="15">
               <a:s>valueset &quot;Present on Admission or Clinically Undetermined&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1147.197'</a:s>
            </a:s>
         </annotation>
      </def>
   </valueSets>
   <codes>
      <def localId="17" locator="40:1-40:76" resultTypeName="t:Code" name="active" id="active" display="active" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="17">
               <a:s>code &quot;active&quot;: 'active' from </a:s>
               <a:s r="16">
                  <a:s>&quot;ConditionClinicalStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'active'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="16" locator="40:30-40:59" resultTypeName="t:CodeSystem" name="ConditionClinicalStatusCodes"/>
      </def>
      <def localId="19" locator="41:1-41:101" resultTypeName="t:Code" name="allergy-active" id="active" display="allergy-active" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="19">
               <a:s>code &quot;allergy-active&quot;: 'active' from </a:s>
               <a:s r="18">
                  <a:s>&quot;AllergyIntoleranceClinicalStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'allergy-active'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="18" locator="41:38-41:76" resultTypeName="t:CodeSystem" name="AllergyIntoleranceClinicalStatusCodes"/>
      </def>
      <def localId="21" locator="42:1-42:114" resultTypeName="t:Code" name="allergy-confirmed" id="confirmed" display="allergy-confirmed" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="21">
               <a:s>code &quot;allergy-confirmed&quot;: 'confirmed' from </a:s>
               <a:s r="20">
                  <a:s>&quot;AllergyIntoleranceVerificationStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'allergy-confirmed'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="20" locator="42:44-42:86" resultTypeName="t:CodeSystem" name="AllergyIntoleranceVerificationStatusCodes"/>
      </def>
      <def localId="23" locator="43:1-43:107" resultTypeName="t:Code" name="allergy-inactive" id="inactive" display="allergy-inactive" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="23">
               <a:s>code &quot;allergy-inactive&quot;: 'inactive' from </a:s>
               <a:s r="22">
                  <a:s>&quot;AllergyIntoleranceClinicalStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'allergy-inactive'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="22" locator="43:42-43:80" resultTypeName="t:CodeSystem" name="AllergyIntoleranceClinicalStatusCodes"/>
      </def>
      <def localId="25" locator="44:1-44:108" resultTypeName="t:Code" name="allergy-refuted" id="refuted" display="allergy-refuted" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="25">
               <a:s>code &quot;allergy-refuted&quot;: 'refuted' from </a:s>
               <a:s r="24">
                  <a:s>&quot;AllergyIntoleranceVerificationStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'allergy-refuted'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="24" locator="44:40-44:82" resultTypeName="t:CodeSystem" name="AllergyIntoleranceVerificationStatusCodes"/>
      </def>
      <def localId="27" locator="45:1-45:107" resultTypeName="t:Code" name="allergy-resolved" id="resolved" display="allergy-resolved" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="27">
               <a:s>code &quot;allergy-resolved&quot;: 'resolved' from </a:s>
               <a:s r="26">
                  <a:s>&quot;AllergyIntoleranceClinicalStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'allergy-resolved'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="26" locator="45:42-45:80" resultTypeName="t:CodeSystem" name="AllergyIntoleranceClinicalStatusCodes"/>
      </def>
      <def localId="29" locator="46:1-46:120" resultTypeName="t:Code" name="allergy-unconfirmed" id="unconfirmed" display="allergy-unconfirmed" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="29">
               <a:s>code &quot;allergy-unconfirmed&quot;: 'unconfirmed' from </a:s>
               <a:s r="28">
                  <a:s>&quot;AllergyIntoleranceVerificationStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'allergy-unconfirmed'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="28" locator="46:48-46:90" resultTypeName="t:CodeSystem" name="AllergyIntoleranceVerificationStatusCodes"/>
      </def>
      <def localId="31" locator="47:1-47:65" resultTypeName="t:Code" name="Billing" id="billing" display="Billing" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="31">
               <a:s>code &quot;Billing&quot;: 'billing' from </a:s>
               <a:s r="30">
                  <a:s>&quot;Diagnosis Role&quot;</a:s>
               </a:s>
               <a:s> display 'Billing'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="30" locator="47:32-47:47" resultTypeName="t:CodeSystem" name="Diagnosis Role"/>
      </def>
      <def localId="33" locator="48:1-48:61" resultTypeName="t:Code" name="Birthdate" id="21112-8" display="Birth date" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="33">
               <a:s>code &quot;Birthdate&quot;: '21112-8' from </a:s>
               <a:s r="32">
                  <a:s>&quot;LOINC&quot;</a:s>
               </a:s>
               <a:s> display 'Birth date'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="32" locator="48:34-48:40" resultTypeName="t:CodeSystem" name="LOINC"/>
      </def>
      <def localId="35" locator="49:1-49:82" resultTypeName="t:Code" name="Community" id="community" display="Community" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="35">
               <a:s>code &quot;Community&quot;: 'community' from </a:s>
               <a:s r="34">
                  <a:s>&quot;MedicationRequestCategory&quot;</a:s>
               </a:s>
               <a:s> display 'Community'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="34" locator="49:36-49:62" resultTypeName="t:CodeSystem" name="MedicationRequestCategory"/>
      </def>
      <def localId="37" locator="50:1-50:89" resultTypeName="t:Code" name="confirmed" id="confirmed" display="confirmed" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="37">
               <a:s>code &quot;confirmed&quot;: 'confirmed' from </a:s>
               <a:s r="36">
                  <a:s>&quot;ConditionVerificationStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'confirmed'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="36" locator="50:36-50:69" resultTypeName="t:CodeSystem" name="ConditionVerificationStatusCodes"/>
      </def>
      <def localId="39" locator="51:1-51:55" resultTypeName="t:Code" name="Dead" id="419099009" display="Dead" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="39">
               <a:s>code &quot;Dead&quot;: '419099009' from </a:s>
               <a:s r="38">
                  <a:s>&quot;SNOMEDCT&quot;</a:s>
               </a:s>
               <a:s> display 'Dead'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="38" locator="51:31-51:40" resultTypeName="t:CodeSystem" name="SNOMEDCT"/>
      </def>
      <def localId="41" locator="52:1-52:98" resultTypeName="t:Code" name="differential" id="differential" display="differential" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="41">
               <a:s>code &quot;differential&quot;: 'differential' from </a:s>
               <a:s r="40">
                  <a:s>&quot;ConditionVerificationStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'differential'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="40" locator="52:42-52:75" resultTypeName="t:CodeSystem" name="ConditionVerificationStatusCodes"/>
      </def>
      <def localId="43" locator="53:1-53:82" resultTypeName="t:Code" name="Discharge" id="discharge" display="Discharge" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="43">
               <a:s>code &quot;Discharge&quot;: 'discharge' from </a:s>
               <a:s r="42">
                  <a:s>&quot;MedicationRequestCategory&quot;</a:s>
               </a:s>
               <a:s> display 'Discharge'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="42" locator="53:36-53:62" resultTypeName="t:CodeSystem" name="MedicationRequestCategory"/>
      </def>
      <def localId="45" locator="54:1-54:110" resultTypeName="t:Code" name="entered-in-error" id="entered-in-error" display="entered-in-error" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="45">
               <a:s>code &quot;entered-in-error&quot;: 'entered-in-error' from </a:s>
               <a:s r="44">
                  <a:s>&quot;ConditionVerificationStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'entered-in-error'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="44" locator="54:50-54:83" resultTypeName="t:CodeSystem" name="ConditionVerificationStatusCodes"/>
      </def>
      <def localId="47" locator="55:1-55:56" resultTypeName="t:Code" name="ER" id="ER" display="Emergency room" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="47">
               <a:s>code &quot;ER&quot;: 'ER' from </a:s>
               <a:s r="46">
                  <a:s>&quot;RoleCode&quot;</a:s>
               </a:s>
               <a:s> display 'Emergency room'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="46" locator="55:22-55:31" resultTypeName="t:CodeSystem" name="RoleCode"/>
      </def>
      <def localId="49" locator="56:1-56:63" resultTypeName="t:Code" name="ICU" id="ICU" display="Intensive care unit" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="49">
               <a:s>code &quot;ICU&quot;: 'ICU' from </a:s>
               <a:s r="48">
                  <a:s>&quot;RoleCode&quot;</a:s>
               </a:s>
               <a:s> display 'Intensive care unit'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="48" locator="56:24-56:33" resultTypeName="t:CodeSystem" name="RoleCode"/>
      </def>
      <def localId="51" locator="57:1-57:82" resultTypeName="t:Code" name="inactive" id="inactive" display="inactive" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="51">
               <a:s>code &quot;inactive&quot;: 'inactive' from </a:s>
               <a:s r="50">
                  <a:s>&quot;ConditionClinicalStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'inactive'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="50" locator="57:34-57:63" resultTypeName="t:CodeSystem" name="ConditionClinicalStatusCodes"/>
      </def>
      <def localId="53" locator="58:1-58:95" resultTypeName="t:Code" name="provisional" id="provisional" display="provisional" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="53">
               <a:s>code &quot;provisional&quot;: 'provisional' from </a:s>
               <a:s r="52">
                  <a:s>&quot;ConditionVerificationStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'provisional'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="52" locator="58:40-58:73" resultTypeName="t:CodeSystem" name="ConditionVerificationStatusCodes"/>
      </def>
      <def localId="55" locator="59:1-59:88" resultTypeName="t:Code" name="recurrence" id="recurrence" display="recurrence" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="55">
               <a:s>code &quot;recurrence&quot;: 'recurrence' from </a:s>
               <a:s r="54">
                  <a:s>&quot;ConditionClinicalStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'recurrence'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="54" locator="59:38-59:67" resultTypeName="t:CodeSystem" name="ConditionClinicalStatusCodes"/>
      </def>
      <def localId="57" locator="60:1-60:83" resultTypeName="t:Code" name="refuted" id="refuted" display="refuted" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="57">
               <a:s>code &quot;refuted&quot;: 'refuted' from </a:s>
               <a:s r="56">
                  <a:s>&quot;ConditionVerificationStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'refuted'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="56" locator="60:32-60:65" resultTypeName="t:CodeSystem" name="ConditionVerificationStatusCodes"/>
      </def>
      <def localId="59" locator="61:1-61:79" resultTypeName="t:Code" name="relapse" id="relapse" display="relapse" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="59">
               <a:s>code &quot;relapse&quot;: 'relapse' from </a:s>
               <a:s r="58">
                  <a:s>&quot;ConditionClinicalStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'relapse'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="58" locator="61:32-61:61" resultTypeName="t:CodeSystem" name="ConditionClinicalStatusCodes"/>
      </def>
      <def localId="61" locator="62:1-62:85" resultTypeName="t:Code" name="remission" id="remission" display="remission" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="61">
               <a:s>code &quot;remission&quot;: 'remission' from </a:s>
               <a:s r="60">
                  <a:s>&quot;ConditionClinicalStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'remission'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="60" locator="62:36-62:65" resultTypeName="t:CodeSystem" name="ConditionClinicalStatusCodes"/>
      </def>
      <def localId="63" locator="63:1-63:82" resultTypeName="t:Code" name="resolved" id="resolved" display="resolved" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="63">
               <a:s>code &quot;resolved&quot;: 'resolved' from </a:s>
               <a:s r="62">
                  <a:s>&quot;ConditionClinicalStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'resolved'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="62" locator="63:34-63:63" resultTypeName="t:CodeSystem" name="ConditionClinicalStatusCodes"/>
      </def>
      <def localId="65" locator="64:1-64:95" resultTypeName="t:Code" name="unconfirmed" id="unconfirmed" display="unconfirmed" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="65">
               <a:s>code &quot;unconfirmed&quot;: 'unconfirmed' from </a:s>
               <a:s r="64">
                  <a:s>&quot;ConditionVerificationStatusCodes&quot;</a:s>
               </a:s>
               <a:s> display 'unconfirmed'</a:s>
            </a:s>
         </annotation>
         <codeSystem localId="64" locator="64:40-64:73" resultTypeName="t:CodeSystem" name="ConditionVerificationStatusCodes"/>
      </def>
   </codes>
   <contexts>
      <def locator="69:1-69:15" name="Patient"/>
   </contexts>
   <statements>
      <def locator="69:1-69:15" name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand locator="69:1-69:15" dataType="fhir:Patient" templateId="http://hl7.org/fhir/StructureDefinition/Patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def localId="87" locator="78:1-79:60" resultTypeName="t:Integer" name="LengthInDays" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="87">
               <a:s>/*Calculates the difference in calendar days between the start and end of the given interval.*/
define function &quot;LengthInDays&quot;(Value </a:s>
               <a:s r="81">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="80">
                     <a:s>DateTime</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="86">
                  <a:s r="86">
                     <a:s>difference in days between </a:s>
                     <a:s r="83">
                        <a:s>start of </a:s>
                        <a:s r="82">
                           <a:s>Value</a:s>
                        </a:s>
                     </a:s>
                     <a:s> and </a:s>
                     <a:s r="85">
                        <a:s>end of </a:s>
                        <a:s r="84">
                           <a:s>Value</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="86" locator="79:3-79:60" resultTypeName="t:Integer" precision="Day" xsi:type="DifferenceBetween">
            <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            <operand localId="83" locator="79:30-79:43" resultTypeName="t:DateTime" xsi:type="Start">
               <signature xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </signature>
               <operand localId="82" locator="79:39-79:43" name="Value" xsi:type="OperandRef">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </operand>
            </operand>
            <operand localId="85" locator="79:49-79:60" resultTypeName="t:DateTime" xsi:type="End">
               <signature xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </signature>
               <operand localId="84" locator="79:56-79:60" name="Value" xsi:type="OperandRef">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </operand>
            </operand>
         </expression>
         <operand name="Value">
            <operandTypeSpecifier localId="81" locator="78:38-78:55" xsi:type="IntervalTypeSpecifier">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <pointType localId="80" locator="78:47-78:54" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="98" locator="71:1-75:71" name="Inpatient Encounter" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="98">
               <a:s>define &quot;Inpatient Encounter&quot;:
  </a:s>
               <a:s r="97">
                  <a:s>
                     <a:s r="73">
                        <a:s r="72">
                           <a:s r="72">
                              <a:s>[Encounter: </a:s>
                              <a:s>
                                 <a:s>&quot;Encounter Inpatient&quot;</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> EncounterInpatient</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
      		</a:s>
                  <a:s r="96">
                     <a:s>where </a:s>
                     <a:s r="96">
                        <a:s r="91">
                           <a:s r="77">
                              <a:s r="75">
                                 <a:s r="74">
                                    <a:s>EncounterInpatient</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="75">
                                    <a:s>status</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> = </a:s>
                              <a:s r="76">
                                 <a:s>'finished'</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      		    and </a:s>
                           <a:s r="90">
                              <a:s r="88">
                                 <a:s>&quot;LengthInDays&quot;(</a:s>
                                 <a:s r="79">
                                    <a:s r="78">
                                       <a:s>EncounterInpatient</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="79">
                                       <a:s>period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s r="89"> &lt;= 120</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      			and </a:s>
                        <a:s r="95">
                           <a:s r="93">
                              <a:s r="92">
                                 <a:s>EncounterInpatient</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="93">
                                 <a:s>period</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="95"> ends during </a:s>
                           <a:s r="94">
                              <a:s>&quot;Measurement Period&quot;</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="97" locator="72:3-75:71" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="73" locator="72:3-72:55" alias="EncounterInpatient">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="72" locator="72:3-72:36" dataType="fhir:Encounter" templateId="http://hl7.org/fhir/StructureDefinition/Encounter" codeProperty="type" codeComparator="in" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <codes locator="72:15-72:35" resultTypeName="t:ValueSet" name="Encounter Inpatient" preserve="true" xsi:type="ValueSetRef"/>
               </expression>
            </source>
            <where localId="96" locator="73:9-75:71" resultTypeName="t:Boolean" xsi:type="And">
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <operand localId="91" locator="73:15-74:64" resultTypeName="t:Boolean" xsi:type="And">
                  <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="77" locator="73:15-73:52" resultTypeName="t:Boolean" xsi:type="Equal">
                     <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:EncounterStatus" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="75" locator="73:15-73:39" resultTypeName="fhir:EncounterStatus" path="status" scope="EncounterInpatient" xsi:type="Property"/>
                     </operand>
                     <operand localId="76" locator="73:43-73:52" resultTypeName="t:String" valueType="t:String" value="finished" xsi:type="Literal"/>
                  </operand>
                  <operand localId="90" locator="74:17-74:64" resultTypeName="t:Boolean" xsi:type="LessOrEqual">
                     <signature name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="88" locator="74:17-74:57" resultTypeName="t:Integer" name="LengthInDays" xsi:type="FunctionRef">
                        <signature xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </signature>
                        <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="79" locator="74:32-74:56" resultTypeName="fhir:Period" path="period" scope="EncounterInpatient" xsi:type="Property"/>
                        </operand>
                     </operand>
                     <operand localId="89" locator="74:62-74:64" resultTypeName="t:Integer" valueType="t:Integer" value="120" xsi:type="Literal"/>
                  </operand>
               </operand>
               <operand localId="95" locator="75:14-75:71" resultTypeName="t:Boolean" xsi:type="In">
                  <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <signature xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand locator="75:40-75:43" xsi:type="End">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="93" locator="75:14-75:38" resultTypeName="fhir:Period" path="period" scope="EncounterInpatient" xsi:type="Property"/>
                     </operand>
                  </operand>
                  <operand localId="94" locator="75:52-75:71" name="Measurement Period" xsi:type="ParameterRef">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="125" locator="82:1-88:5" resultTypeName="fhir:Encounter" name="ED Visit" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="125">
               <a:s>/*Returns the most recent emergency department visit, if any, that occurs 1 hour or less prior to the given encounter.*/
define function &quot;ED Visit&quot;(TheEncounter </a:s>
               <a:s r="102">
                  <a:s>FHIR.Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="124">
                  <a:s r="124">
                     <a:s>Last(
    </a:s>
                     <a:s r="123">
                        <a:s>
                           <a:s r="104">
                              <a:s r="103">
                                 <a:s r="103">
                                    <a:s>[Encounter: </a:s>
                                    <a:s>
                                       <a:s>&quot;Emergency Department Visit&quot;</a:s>
                                    </a:s>
                                    <a:s>]</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> EDVisit</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      </a:s>
                        <a:s r="118">
                           <a:s>where </a:s>
                           <a:s r="118">
                              <a:s r="108">
                                 <a:s r="106">
                                    <a:s r="105">
                                       <a:s>EDVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="106">
                                       <a:s>status</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="107">
                                    <a:s>'finished'</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
        and </a:s>
                              <a:s r="117">
                                 <a:s r="110">
                                    <a:s r="109">
                                       <a:s>EDVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="110">
                                       <a:s>period</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="117">
                                    <a:s>ends </a:s>
                                    <a:s r="116">
                                       <a:s>1 hour</a:s>
                                    </a:s>
                                    <a:s> or less on or before</a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="115">
                                    <a:s>start of </a:s>
                                    <a:s r="114">
                                       <a:s r="111">
                                          <a:s>FHIRHelpers</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="114">
                                          <a:s>ToInterval(</a:s>
                                          <a:s r="113">
                                             <a:s r="112">
                                                <a:s>TheEncounter</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="113">
                                                <a:s>period</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      </a:s>
                        <a:s r="122">
                           <a:s>sort by </a:s>
                           <a:s r="121">
                              <a:s r="120">
                                 <a:s>end of </a:s>
                                 <a:s r="119">
                                    <a:s>period</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="124" locator="83:3-88:5" resultTypeName="fhir:Encounter" xsi:type="Last">
            <signature xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <source localId="123" locator="84:5-87:27" xsi:type="Query">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <source localId="104" locator="84:5-84:53" alias="EDVisit">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <expression localId="103" locator="84:5-84:45" dataType="fhir:Encounter" templateId="http://hl7.org/fhir/StructureDefinition/Encounter" codeProperty="type" codeComparator="in" xsi:type="Retrieve">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <codes locator="84:17-84:44" resultTypeName="t:ValueSet" name="Emergency Department Visit" preserve="true" xsi:type="ValueSetRef"/>
                  </expression>
               </source>
               <where localId="118" locator="85:7-86:112" resultTypeName="t:Boolean" xsi:type="And">
                  <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="108" locator="85:13-85:39" resultTypeName="t:Boolean" xsi:type="Equal">
                     <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:EncounterStatus" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="106" locator="85:13-85:26" resultTypeName="fhir:EncounterStatus" path="status" scope="EDVisit" xsi:type="Property"/>
                     </operand>
                     <operand localId="107" locator="85:30-85:39" resultTypeName="t:String" valueType="t:String" value="finished" xsi:type="Literal"/>
                  </operand>
                  <operand localId="117" locator="86:13-86:112" resultTypeName="t:Boolean" xsi:type="And">
                     <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <operand locator="86:33-86:46" xsi:type="In">
                        <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        <signature xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </signature>
                        <operand locator="86:28-86:31" xsi:type="End">
                           <signature xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </signature>
                           <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="110" locator="86:13-86:26" resultTypeName="fhir:Period" path="period" scope="EDVisit" xsi:type="Property"/>
                           </operand>
                        </operand>
                        <operand locator="86:33-86:46" lowClosed="true" highClosed="true" xsi:type="Interval">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <low locator="86:61-86:112" xsi:type="Subtract">
                              <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="115" locator="86:61-86:112" resultTypeName="t:DateTime" xsi:type="Start">
                                 <signature xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </signature>
                                 <operand localId="114" locator="86:70-86:112" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="113" locator="86:93-86:111" resultTypeName="fhir:Period" path="period" xsi:type="Property">
                                       <source localId="112" locator="86:93-86:104" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="116" locator="86:33-86:38" resultTypeName="t:Quantity" value="1" unit="hour" xsi:type="Quantity"/>
                           </low>
                           <high localId="115" locator="86:61-86:112" resultTypeName="t:DateTime" xsi:type="Start">
                              <signature xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <operand localId="114" locator="86:70-86:112" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="113" locator="86:93-86:111" resultTypeName="fhir:Period" path="period" xsi:type="Property">
                                    <source localId="112" locator="86:93-86:104" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                 </operand>
                              </operand>
                           </high>
                        </operand>
                     </operand>
                     <operand locator="86:33-86:46" xsi:type="Not">
                        <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                        <operand locator="86:33-86:46" xsi:type="IsNull">
                           <signature name="t:Any" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="115" locator="86:61-86:112" resultTypeName="t:DateTime" xsi:type="Start">
                              <signature xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <operand localId="114" locator="86:70-86:112" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="113" locator="86:93-86:111" resultTypeName="fhir:Period" path="period" xsi:type="Property">
                                    <source localId="112" locator="86:93-86:104" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                     </operand>
                  </operand>
               </where>
               <sort localId="122" locator="87:7-87:27">
                  <by localId="121" locator="87:15-87:27" resultTypeName="t:DateTime" direction="asc" xsi:type="ByExpression">
                     <expression localId="120" locator="87:15-87:27" resultTypeName="t:DateTime" xsi:type="End">
                        <signature xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </signature>
                        <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="119" locator="87:22-87:27" resultTypeName="fhir:Period" name="period" xsi:type="IdentifierRef"/>
                        </operand>
                     </expression>
                  </by>
               </sort>
            </source>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="102" locator="82:41-82:54" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="148" locator="91:1-95:116" name="Hospitalization" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="148">
               <a:s>/*Hospitalization returns the total interval for admission to discharge for the given encounter, or for the admission of any immediately prior emergency department visit to the discharge of the given encounter.*/
define function &quot;Hospitalization&quot;(TheEncounter </a:s>
               <a:s r="126">
                  <a:s>FHIR.Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="147">
                  <a:s r="147">
                     <a:s>
                        <a:s r="129">
                           <a:s r="128">
                              <a:s>( </a:s>
                              <a:s r="128">
                                 <a:s>&quot;ED Visit&quot;(</a:s>
                                 <a:s r="127">
                                    <a:s>TheEncounter</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> )</a:s>
                           </a:s>
                           <a:s> X</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="146">
                        <a:s>return
        </a:s>
                        <a:s r="145">
                           <a:s>if </a:s>
                           <a:s r="131">
                              <a:s r="130">
                                 <a:s>X</a:s>
                              </a:s>
                              <a:s> is null</a:s>
                           </a:s>
                           <a:s> then </a:s>
                           <a:s r="133">
                              <a:s r="132">
                                 <a:s>TheEncounter</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="133">
                                 <a:s>period</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
        else </a:s>
                           <a:s r="144">
                              <a:s>Interval[</a:s>
                              <a:s r="138">
                                 <a:s>start of </a:s>
                                 <a:s r="137">
                                    <a:s r="134">
                                       <a:s>FHIRHelpers</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="137">
                                       <a:s>ToInterval(</a:s>
                                       <a:s r="136">
                                          <a:s r="135">
                                             <a:s>X</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="136">
                                             <a:s>period</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="143">
                                 <a:s>end of </a:s>
                                 <a:s r="142">
                                    <a:s r="139">
                                       <a:s>FHIRHelpers</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="142">
                                       <a:s>ToInterval(</a:s>
                                       <a:s r="141">
                                          <a:s r="140">
                                             <a:s>TheEncounter</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="141">
                                             <a:s>period</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
            <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="147" locator="92:3-95:116" xsi:type="Query">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="129" locator="92:3-92:32" resultTypeName="fhir:Encounter" alias="X">
               <expression localId="128" locator="92:3-92:30" resultTypeName="fhir:Encounter" name="ED Visit" xsi:type="FunctionRef">
                  <signature name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="127" locator="92:16-92:27" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
               </expression>
            </source>
            <return localId="146" locator="93:5-95:116">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="145" locator="94:9-95:116" xsi:type="If">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <condition localId="131" locator="94:12-94:20" resultTypeName="t:Boolean" xsi:type="IsNull">
                     <signature name="t:Any" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="130" locator="94:12" resultTypeName="fhir:Encounter" name="X" xsi:type="AliasRef"/>
                  </condition>
                  <then name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="133" locator="94:27-94:45" resultTypeName="fhir:Period" path="period" xsi:type="Property">
                        <source localId="132" locator="94:27-94:38" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                     </operand>
                  </then>
                  <else localId="144" locator="95:14-95:116" lowClosed="true" highClosed="true" xsi:type="Interval">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <low localId="138" locator="95:23-95:63" resultTypeName="t:DateTime" xsi:type="Start">
                        <signature xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </signature>
                        <operand localId="137" locator="95:32-95:63" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="136" locator="95:55-95:62" resultTypeName="fhir:Period" path="period" scope="X" xsi:type="Property"/>
                        </operand>
                     </low>
                     <high localId="143" locator="95:66-95:115" resultTypeName="t:DateTime" xsi:type="End">
                        <signature xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </signature>
                        <operand localId="142" locator="95:73-95:115" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="141" locator="95:96-95:114" resultTypeName="fhir:Period" path="period" xsi:type="Property">
                              <source localId="140" locator="95:96-95:107" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                           </operand>
                        </operand>
                     </high>
                  </else>
               </expression>
            </return>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="126" locator="91:48-91:61" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="166" locator="98:1-102:68" name="Hospitalization Locations" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="166">
               <a:s>/*Returns list of all locations within an encounter, including locations for immediately prior ED visit.*/
define function &quot;Hospitalization Locations&quot;(TheEncounter </a:s>
               <a:s r="149">
                  <a:s>FHIR.Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="165">
                  <a:s r="165">
                     <a:s>
                        <a:s r="152">
                           <a:s r="151">
                              <a:s>( </a:s>
                              <a:s r="151">
                                 <a:s>&quot;ED Visit&quot;(</a:s>
                                 <a:s r="150">
                                    <a:s>TheEncounter</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s> )</a:s>
                           </a:s>
                           <a:s> EDEncounter</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="164">
                        <a:s>return
        </a:s>
                        <a:s r="163">
                           <a:s>if </a:s>
                           <a:s r="154">
                              <a:s r="153">
                                 <a:s>EDEncounter</a:s>
                              </a:s>
                              <a:s> is null</a:s>
                           </a:s>
                           <a:s> then </a:s>
                           <a:s r="156">
                              <a:s r="155">
                                 <a:s>TheEncounter</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="156">
                                 <a:s>location</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
        else </a:s>
                           <a:s r="162">
                              <a:s>flatten </a:s>
                              <a:s r="161">
                                 <a:s>{ </a:s>
                                 <a:s r="158">
                                    <a:s r="157">
                                       <a:s>EDEncounter</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="158">
                                       <a:s>location</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>, </a:s>
                                 <a:s r="160">
                                    <a:s r="159">
                                       <a:s>TheEncounter</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="160">
                                       <a:s>location</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> }</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="165" locator="99:3-102:68" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="152" locator="99:3-99:42" resultTypeName="fhir:Encounter" alias="EDEncounter">
               <expression localId="151" locator="99:3-99:30" resultTypeName="fhir:Encounter" name="ED Visit" xsi:type="FunctionRef">
                  <signature name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="150" locator="99:16-99:27" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
               </expression>
            </source>
            <return localId="164" locator="100:5-102:68">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="163" locator="101:9-102:68" xsi:type="If">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <condition localId="154" locator="101:12-101:30" resultTypeName="t:Boolean" xsi:type="IsNull">
                     <signature name="t:Any" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="153" locator="101:12-101:22" resultTypeName="fhir:Encounter" name="EDEncounter" xsi:type="AliasRef"/>
                  </condition>
                  <then localId="156" locator="101:37-101:57" path="location" xsi:type="Property">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="155" locator="101:37-101:48" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                  </then>
                  <else localId="162" locator="102:14-102:68" xsi:type="Flatten">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <signature xsi:type="ListTypeSpecifier">
                        <elementType xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                        </elementType>
                     </signature>
                     <operand localId="161" locator="102:22-102:68" xsi:type="List">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                           </elementType>
                        </resultTypeSpecifier>
                        <element localId="158" locator="102:24-102:43" path="location" scope="EDEncounter" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </element>
                        <element localId="160" locator="102:46-102:66" path="location" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <source localId="159" locator="102:46-102:57" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                        </element>
                     </operand>
                  </else>
               </expression>
            </return>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="149" locator="98:58-98:71" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="171" locator="105:1-106:47" resultTypeName="t:Integer" name="Hospitalization Length of Stay" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="171">
               <a:s>/*Returns the length of stay in days (i.e. the number of days between admission and discharge) for the given encounter, or from the admission of any immediately prior emergency department visit to the discharge of the encounter*/
define function &quot;Hospitalization Length of Stay&quot;(TheEncounter </a:s>
               <a:s r="167">
                  <a:s>FHIR.Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="170">
                  <a:s r="170">
                     <a:s>LengthInDays(</a:s>
                     <a:s r="169">
                        <a:s>&quot;Hospitalization&quot;(</a:s>
                        <a:s r="168">
                           <a:s>TheEncounter</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="170" locator="106:3-106:47" resultTypeName="t:Integer" name="LengthInDays" xsi:type="FunctionRef">
            <signature xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="169" locator="106:16-106:46" name="Hospitalization" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <signature name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
               <operand localId="168" locator="106:34-106:45" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="167" locator="105:63-105:76" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="176" locator="109:1-110:42" resultTypeName="t:DateTime" name="Hospital Admission Time" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="176">
               <a:s>/*Returns admission time for an encounter or for immediately prior emergency department visit.*/
define function &quot;Hospital Admission Time&quot;(TheEncounter </a:s>
               <a:s r="172">
                  <a:s>FHIR.Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="175">
                  <a:s r="175">
                     <a:s>start of </a:s>
                     <a:s r="174">
                        <a:s>&quot;Hospitalization&quot;(</a:s>
                        <a:s r="173">
                           <a:s>TheEncounter</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="175" locator="110:3-110:42" resultTypeName="t:DateTime" xsi:type="Start">
            <signature xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="174" locator="110:12-110:42" name="Hospitalization" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <signature name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
               <operand localId="173" locator="110:30-110:41" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="172" locator="109:56-109:69" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="183" locator="113:1-114:52" resultTypeName="t:DateTime" name="Hospital Discharge Time" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="183">
               <a:s>/*Hospital Discharge Time returns the discharge time for an encounter*/
define function &quot;Hospital Discharge Time&quot;(TheEncounter </a:s>
               <a:s r="177">
                  <a:s>FHIR.Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="182">
                  <a:s r="182">
                     <a:s>end of </a:s>
                     <a:s r="181">
                        <a:s r="178">
                           <a:s>FHIRHelpers</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="181">
                           <a:s>ToInterval(</a:s>
                           <a:s r="180">
                              <a:s r="179">
                                 <a:s>TheEncounter</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="180">
                                 <a:s>period</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="182" locator="114:3-114:52" resultTypeName="t:DateTime" xsi:type="End">
            <signature xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="181" locator="114:10-114:52" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
               <operand localId="180" locator="114:33-114:51" resultTypeName="fhir:Period" path="period" xsi:type="Property">
                  <source localId="179" locator="114:33-114:44" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
               </operand>
            </operand>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="177" locator="113:56-113:69" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="200" locator="117:1-121:12" resultTypeName="t:DateTime" name="Hospital Arrival Time" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="200">
               <a:s>/*Returns earliest arrival time for an encounter including any prior ED visit.*/
define function &quot;Hospital Arrival Time&quot;(TheEncounter </a:s>
               <a:s r="184">
                  <a:s>FHIR.Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="199">
                  <a:s r="199">
                     <a:s>start of </a:s>
                     <a:s r="198">
                        <a:s r="185">
                           <a:s>FHIRHelpers</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="198">
                           <a:s>ToInterval(</a:s>
                           <a:s r="197">
                              <a:s r="196">
                                 <a:s>First(
  	    </a:s>
                                 <a:s r="195">
                                    <a:s>
                                       <a:s r="188">
                                          <a:s r="187">
                                             <a:s>( </a:s>
                                             <a:s r="187">
                                                <a:s>&quot;Hospitalization Locations&quot;(</a:s>
                                                <a:s r="186">
                                                   <a:s>TheEncounter</a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                             <a:s> )</a:s>
                                          </a:s>
                                          <a:s> HospitalLocation</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
  			</a:s>
                                    <a:s r="194">
                                       <a:s>sort by </a:s>
                                       <a:s r="193">
                                          <a:s r="192">
                                             <a:s>start of </a:s>
                                             <a:s r="191">
                                                <a:s r="189">
                                                   <a:s>FHIRHelpers</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="191">
                                                   <a:s>ToInterval(</a:s>
                                                   <a:s r="190">
                                                      <a:s>period</a:s>
                                                   </a:s>
                                                   <a:s>)</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  	)</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="197">
                                 <a:s>period</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="199" locator="118:3-121:12" resultTypeName="t:DateTime" xsi:type="Start">
            <signature xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="198" locator="118:12-121:12" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
               <operand localId="197" locator="118:35-121:11" resultTypeName="fhir:Period" path="period" xsi:type="Property">
                  <source localId="196" locator="118:35-121:4" resultTypeName="fhir:Encounter.Location" xsi:type="First">
                     <signature xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <source localId="195" locator="119:8-120:52" xsi:type="Query">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="188" locator="119:8-119:69" alias="HospitalLocation">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <expression localId="187" locator="119:8-119:52" name="Hospitalization Locations" xsi:type="FunctionRef">
                              <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                                 <elementType name="fhir:Encounter.Location" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <signature name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="186" locator="119:38-119:49" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
                           </expression>
                        </source>
                        <sort localId="194" locator="120:6-120:52">
                           <by localId="193" locator="120:14-120:52" resultTypeName="t:DateTime" direction="asc" xsi:type="ByExpression">
                              <expression localId="192" locator="120:14-120:52" resultTypeName="t:DateTime" xsi:type="Start">
                                 <signature xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </signature>
                                 <operand localId="191" locator="120:23-120:52" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="190" locator="120:46-120:51" resultTypeName="fhir:Period" name="period" xsi:type="IdentifierRef"/>
                                 </operand>
                              </expression>
                           </by>
                        </sort>
                     </source>
                  </source>
               </operand>
            </operand>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="184" locator="117:54-117:67" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="253" locator="175:1-186:87" name="HospitalizationWithObservation" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="253">
               <a:s>// TODO - fix these (must fetch Location resources and compare id to reference)
  /*Returns the latest departure time for encounter including any prior ED visit. */
  /*
  define function &quot;Hospital Departure Time&quot;(TheEncounter FHIR.Encounter):
  	end of FHIRHelpers.ToInterval(Last(
  	    ( &quot;Hospitalization Locations&quot;(TheEncounter) ) HospitalLocation
  			sort by start of FHIRHelpers.ToInterval(period)
  	).period)

  define function &quot;Emergency Department Arrival Time&quot;(TheEncounter FHIR.Encounter):
  	start of FHIRHelpers.ToInterval((
  	    singleton from (
  	        ( &quot;Hospitalization Locations&quot;(TheEncounter) ) HospitalLocation
  				where HospitalLocation.type ~ &quot;ER&quot;
  		)
  	).period)

  define function &quot;First Inpatient Intensive Care Unit&quot;(TheEncounter FHIR.Encounter):
  	First(
  	    ( TheEncounter.location ) HospitalLocation
  			where HospitalLocation.type ~ &quot;ICU&quot;
  				and HospitalLocation.period during TheEncounter.period
  			sort by start of FHIRHelpers.ToInterval(period)
  	)
  */

  /*Hospitalization with Observation and Outpatient Surgery Service returns the total interval from the start of any immediately prior emergency department visit, outpatient surgery visit or observation visit to the discharge of the given encounter.*/
  /* TODO:
  define function &quot;HospitalizationWithObservationAndOutpatientSurgeryService&quot;(Encounter &quot;Encounter, Performed&quot; ):
  Encounter Visit
  	let ObsVisit: Last([&quot;Encounter, Performed&quot;: &quot;Observation Services&quot;] LastObs
  			where LastObs.relevantPeriod ends 1 hour or less on or before start of Visit.relevantPeriod
  			sort by
  			end of relevantPeriod
  	),
  	VisitStart: Coalesce(start of ObsVisit.relevantPeriod, start of Visit.relevantPeriod),
  	EDVisit: Last([&quot;Encounter, Performed&quot;: &quot;Emergency Department Visit&quot;] LastED
  			where LastED.relevantPeriod ends 1 hour or less on or before VisitStart
  			sort by
  			end of relevantPeriod
  	),
  	VisitStartWithED: Coalesce(start of EDVisit.relevantPeriod, VisitStart),
  	OutpatientSurgeryVisit: Last([&quot;Encounter, Performed&quot;: &quot;Outpatient Surgery Service&quot;] LastSurgeryOP
  			where LastSurgeryOP.relevantPeriod ends 1 hour or less on or before VisitStartWithED
  			sort by
  			end of relevantPeriod
  	)
  	return Interval[Coalesce(start of OutpatientSurgeryVisit.relevantPeriod, VisitStartWithED),
  	end of Visit.relevantPeriod]
  */

/*Hospitalization with Observation returns the total interval from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter*/
define function &quot;HospitalizationWithObservation&quot;(TheEncounter </a:s>
               <a:s r="201">
                  <a:s>FHIR.Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="252">
                  <a:s r="252">
                     <a:s>
                        <a:s r="203">
                           <a:s r="202">
                              <a:s>
                                 <a:s>TheEncounter</a:s>
                              </a:s>
                           </a:s>
                           <a:s> Visit</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s>
                        <a:s>let </a:s>
                        <a:s r="219">
                           <a:s>ObsVisit: </a:s>
                           <a:s r="218">
                              <a:s>Last(</a:s>
                              <a:s r="217">
                                 <a:s>
                                    <a:s r="205">
                                       <a:s r="204">
                                          <a:s r="204">
                                             <a:s>[Encounter: </a:s>
                                             <a:s>
                                                <a:s>&quot;Observation Services&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastObs</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  				</a:s>
                                 <a:s r="212">
                                    <a:s>where </a:s>
                                    <a:s r="212">
                                       <a:s r="207">
                                          <a:s r="206">
                                             <a:s>LastObs</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="207">
                                             <a:s>period</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="212">
                                          <a:s>ends </a:s>
                                          <a:s r="211">
                                             <a:s>1 hour</a:s>
                                          </a:s>
                                          <a:s> or less on or before</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="210">
                                          <a:s>start of </a:s>
                                          <a:s r="209">
                                             <a:s r="208">
                                                <a:s>Visit</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="209">
                                                <a:s>period</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  				</a:s>
                                 <a:s r="216">
                                    <a:s>sort by </a:s>
                                    <a:s r="215">
                                       <a:s r="214">
                                          <a:s>end of </a:s>
                                          <a:s r="213">
                                             <a:s>period</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  			)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
  			</a:s>
                        <a:s r="227">
                           <a:s>VisitStart: </a:s>
                           <a:s r="226">
                              <a:s>Coalesce(</a:s>
                              <a:s r="222">
                                 <a:s>start of </a:s>
                                 <a:s r="221">
                                    <a:s r="220">
                                       <a:s>ObsVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="221">
                                       <a:s>period</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="225">
                                 <a:s>start of </a:s>
                                 <a:s r="224">
                                    <a:s r="223">
                                       <a:s>Visit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="224">
                                       <a:s>period</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>,
  			</a:s>
                        <a:s r="241">
                           <a:s>EDVisit: </a:s>
                           <a:s r="240">
                              <a:s>Last(</a:s>
                              <a:s r="239">
                                 <a:s>
                                    <a:s r="229">
                                       <a:s r="228">
                                          <a:s r="228">
                                             <a:s>[Encounter: </a:s>
                                             <a:s>
                                                <a:s>&quot;Emergency Department Visit&quot;</a:s>
                                             </a:s>
                                             <a:s>]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> LastED</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  				</a:s>
                                 <a:s r="234">
                                    <a:s>where </a:s>
                                    <a:s r="234">
                                       <a:s r="231">
                                          <a:s r="230">
                                             <a:s>LastED</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="231">
                                             <a:s>period</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="234">
                                          <a:s>ends </a:s>
                                          <a:s r="233">
                                             <a:s>1 hour</a:s>
                                          </a:s>
                                          <a:s> or less on or before</a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="232">
                                          <a:s>VisitStart</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
  				</a:s>
                                 <a:s r="238">
                                    <a:s>sort by </a:s>
                                    <a:s r="237">
                                       <a:s r="236">
                                          <a:s>end of </a:s>
                                          <a:s r="235">
                                             <a:s>period</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
  			)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="251">
                        <a:s>return </a:s>
                        <a:s r="250">
                           <a:s>Interval[</a:s>
                           <a:s r="246">
                              <a:s>Coalesce(</a:s>
                              <a:s r="244">
                                 <a:s>start of </a:s>
                                 <a:s r="243">
                                    <a:s r="242">
                                       <a:s>EDVisit</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="243">
                                       <a:s>period</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="245">
                                 <a:s>VisitStart</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="249">
                              <a:s>end of </a:s>
                              <a:s r="248">
                                 <a:s r="247">
                                    <a:s>Visit</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="248">
                                    <a:s>period</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>]</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
            <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="252" locator="176:3-186:87" xsi:type="Query">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="203" locator="176:3-176:20" resultTypeName="fhir:Encounter" alias="Visit">
               <expression localId="202" locator="176:3-176:14" resultTypeName="fhir:Encounter" name="TheEncounter" xsi:type="OperandRef"/>
            </source>
            <let localId="219" locator="177:9-180:6" resultTypeName="fhir:Encounter" identifier="ObsVisit">
               <expression localId="218" locator="177:19-180:6" resultTypeName="fhir:Encounter" xsi:type="Last">
                  <signature xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <source localId="217" locator="177:24-179:27" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="205" locator="177:24-177:66" alias="LastObs">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="204" locator="177:24-177:58" dataType="fhir:Encounter" templateId="http://hl7.org/fhir/StructureDefinition/Encounter" codeProperty="type" codeComparator="in" xsi:type="Retrieve">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <codes locator="177:36-177:57" resultTypeName="t:ValueSet" name="Observation Services" preserve="true" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="212" locator="178:7-178:81" resultTypeName="t:Boolean" xsi:type="And">
                        <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                        <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                        <operand locator="178:33-178:46" xsi:type="In">
                           <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           <signature xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </signature>
                           <operand locator="178:28-178:31" xsi:type="End">
                              <signature xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="207" locator="178:13-178:26" resultTypeName="fhir:Period" path="period" scope="LastObs" xsi:type="Property"/>
                              </operand>
                           </operand>
                           <operand locator="178:33-178:46" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <low locator="178:61-178:81" xsi:type="Subtract">
                                 <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="210" locator="178:61-178:81" resultTypeName="t:DateTime" xsi:type="Start">
                                    <signature xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </signature>
                                    <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="209" locator="178:70-178:81" resultTypeName="fhir:Period" path="period" scope="Visit" xsi:type="Property"/>
                                    </operand>
                                 </operand>
                                 <operand localId="211" locator="178:33-178:38" resultTypeName="t:Quantity" value="1" unit="hour" xsi:type="Quantity"/>
                              </low>
                              <high localId="210" locator="178:61-178:81" resultTypeName="t:DateTime" xsi:type="Start">
                                 <signature xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </signature>
                                 <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="209" locator="178:70-178:81" resultTypeName="fhir:Period" path="period" scope="Visit" xsi:type="Property"/>
                                 </operand>
                              </high>
                           </operand>
                        </operand>
                        <operand locator="178:33-178:46" xsi:type="Not">
                           <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                           <operand locator="178:33-178:46" xsi:type="IsNull">
                              <signature name="t:Any" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="210" locator="178:61-178:81" resultTypeName="t:DateTime" xsi:type="Start">
                                 <signature xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </signature>
                                 <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="209" locator="178:70-178:81" resultTypeName="fhir:Period" path="period" scope="Visit" xsi:type="Property"/>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                     </where>
                     <sort localId="216" locator="179:7-179:27">
                        <by localId="215" locator="179:15-179:27" resultTypeName="t:DateTime" direction="asc" xsi:type="ByExpression">
                           <expression localId="214" locator="179:15-179:27" resultTypeName="t:DateTime" xsi:type="End">
                              <signature xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="213" locator="179:22-179:27" resultTypeName="fhir:Period" name="period" xsi:type="IdentifierRef"/>
                              </operand>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <let localId="227" locator="181:6-181:74" resultTypeName="t:DateTime" identifier="VisitStart">
               <expression localId="226" locator="181:18-181:74" resultTypeName="t:DateTime" xsi:type="Coalesce">
                  <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="222" locator="181:27-181:50" resultTypeName="t:DateTime" xsi:type="Start">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="221" locator="181:36-181:50" resultTypeName="fhir:Period" path="period" xsi:type="Property">
                           <source localId="220" locator="181:36-181:43" resultTypeName="fhir:Encounter" name="ObsVisit" xsi:type="QueryLetRef"/>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="225" locator="181:53-181:73" resultTypeName="t:DateTime" xsi:type="Start">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="224" locator="181:62-181:73" resultTypeName="fhir:Period" path="period" scope="Visit" xsi:type="Property"/>
                     </operand>
                  </operand>
               </expression>
            </let>
            <let localId="241" locator="182:6-185:6" resultTypeName="fhir:Encounter" identifier="EDVisit">
               <expression localId="240" locator="182:15-185:6" resultTypeName="fhir:Encounter" xsi:type="Last">
                  <signature xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <source localId="239" locator="182:20-184:27" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="229" locator="182:20-182:67" alias="LastED">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="228" locator="182:20-182:60" dataType="fhir:Encounter" templateId="http://hl7.org/fhir/StructureDefinition/Encounter" codeProperty="type" codeComparator="in" xsi:type="Retrieve">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <codes locator="182:32-182:59" resultTypeName="t:ValueSet" name="Emergency Department Visit" preserve="true" xsi:type="ValueSetRef"/>
                        </expression>
                     </source>
                     <where localId="234" locator="183:7-183:69" resultTypeName="t:Boolean" xsi:type="And">
                        <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                        <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                        <operand locator="183:32-183:45" xsi:type="In">
                           <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           <signature xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </signature>
                           <operand locator="183:27-183:30" xsi:type="End">
                              <signature xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="231" locator="183:13-183:25" resultTypeName="fhir:Period" path="period" scope="LastED" xsi:type="Property"/>
                              </operand>
                           </operand>
                           <operand locator="183:32-183:45" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <low locator="183:60-183:69" xsi:type="Subtract">
                                 <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="232" locator="183:60-183:69" resultTypeName="t:DateTime" name="VisitStart" xsi:type="QueryLetRef"/>
                                 <operand localId="233" locator="183:32-183:37" resultTypeName="t:Quantity" value="1" unit="hour" xsi:type="Quantity"/>
                              </low>
                              <high localId="232" locator="183:60-183:69" resultTypeName="t:DateTime" name="VisitStart" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                        <operand locator="183:32-183:45" xsi:type="Not">
                           <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                           <operand locator="183:32-183:45" xsi:type="IsNull">
                              <signature name="t:Any" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="232" locator="183:60-183:69" resultTypeName="t:DateTime" name="VisitStart" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                     </where>
                     <sort localId="238" locator="184:7-184:27">
                        <by localId="237" locator="184:15-184:27" resultTypeName="t:DateTime" direction="asc" xsi:type="ByExpression">
                           <expression localId="236" locator="184:15-184:27" resultTypeName="t:DateTime" xsi:type="End">
                              <signature xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </signature>
                              <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="235" locator="184:22-184:27" resultTypeName="fhir:Period" name="period" xsi:type="IdentifierRef"/>
                              </operand>
                           </expression>
                        </by>
                     </sort>
                  </source>
               </expression>
            </let>
            <return localId="251" locator="186:5-186:87">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="250" locator="186:12-186:87" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <low localId="246" locator="186:21-186:65" resultTypeName="t:DateTime" xsi:type="Coalesce">
                     <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="244" locator="186:30-186:52" resultTypeName="t:DateTime" xsi:type="Start">
                        <signature xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </signature>
                        <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="243" locator="186:39-186:52" resultTypeName="fhir:Period" path="period" xsi:type="Property">
                              <source localId="242" locator="186:39-186:45" resultTypeName="fhir:Encounter" name="EDVisit" xsi:type="QueryLetRef"/>
                           </operand>
                        </operand>
                     </operand>
                     <operand localId="245" locator="186:55-186:64" resultTypeName="t:DateTime" name="VisitStart" xsi:type="QueryLetRef"/>
                  </low>
                  <high localId="249" locator="186:68-186:86" resultTypeName="t:DateTime" xsi:type="End">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="248" locator="186:75-186:86" resultTypeName="fhir:Period" path="period" scope="Visit" xsi:type="Property"/>
                     </operand>
                  </high>
               </expression>
            </return>
         </expression>
         <operand name="TheEncounter">
            <operandTypeSpecifier localId="201" locator="175:63-175:76" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="388" locator="206:1-226:6" name="Normalize Interval" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="388">
               <a:s>/**
* Normalizes the input argument to an interval representation.
* The input can be provided as a dateTime, Period, Timing, instant, string, Age, or Range.
* The intent of this function is to provide a clear and concise mechanism to treat single
* elements that have multiple possible representations as intervals so that logic doesn't have to account
* for the variability. More complex calculations (such as medication request period or dispense period
* calculation) need specific guidance and consideration. That guidance may make use of this function, but
* the focus of this function is on single element calculations where the semantics are unambiguous.
* If the input is a dateTime, the result a DateTime Interval beginning and ending on that dateTime.
* If the input is a Period, the result is a DateTime Interval.
* If the input is a Timing, an error is raised indicating a single interval cannot be computed from a Timing.
* If the input is an instant, the result is a DateTime Interval beginning and ending on that instant.
* If the input is a string, an error is raised indicating a single interval cannot be computed from a string.
* If the input is an Age, the result is a DateTime Interval beginning when the patient was the given Age,
and ending immediately prior to when the patient was the given Age plus one year.
* If the input is a Range, the result is a DateTime Interval beginning when the patient was the Age given
by the low end of the Range, and ending immediately prior to when the patient was the Age given by the
high end of the Range plus one year.*/
define function &quot;Normalize Interval&quot;(choice </a:s>
               <a:s r="261">
                  <a:s>Choice&lt;</a:s>
                  <a:s r="254">
                     <a:s>FHIR.dateTime</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="255">
                     <a:s>FHIR.Period</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="256">
                     <a:s>FHIR.Timing</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="257">
                     <a:s>FHIR.instant</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="258">
                     <a:s>FHIR.string</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="259">
                     <a:s>FHIR.Age</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="260">
                     <a:s>FHIR.Range</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="387">
                  <a:s r="387">
                     <a:s>case
  	  </a:s>
                     <a:s r="276">
                        <a:s>when </a:s>
                        <a:s r="264">
                           <a:s r="262">
                              <a:s>choice</a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="263">
                              <a:s>FHIR.dateTime</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then
  	</a:s>
                        <a:s r="275">
                           <a:s>Interval[</a:s>
                           <a:s r="269">
                              <a:s r="265">
                                 <a:s>FHIRHelpers</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="269">
                                 <a:s>ToDateTime(</a:s>
                                 <a:s r="268">
                                    <a:s r="266">
                                       <a:s>choice</a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="267">
                                       <a:s>FHIR.dateTime</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="274">
                              <a:s r="270">
                                 <a:s>FHIRHelpers</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="274">
                                 <a:s>ToDateTime(</a:s>
                                 <a:s r="273">
                                    <a:s r="271">
                                       <a:s>choice</a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="272">
                                       <a:s>FHIR.dateTime</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                           <a:s>]</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="285">
                        <a:s>when </a:s>
                        <a:s r="279">
                           <a:s r="277">
                              <a:s>choice</a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="278">
                              <a:s>FHIR.Period</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then
  		</a:s>
                        <a:s r="284">
                           <a:s r="280">
                              <a:s>FHIRHelpers</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="284">
                              <a:s>ToInterval(</a:s>
                              <a:s r="283">
                                 <a:s r="281">
                                    <a:s>choice</a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="282">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="300">
                        <a:s>when </a:s>
                        <a:s r="288">
                           <a:s r="286">
                              <a:s>choice</a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="287">
                              <a:s>FHIR.instant</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then
  			</a:s>
                        <a:s r="299">
                           <a:s>Interval[</a:s>
                           <a:s r="293">
                              <a:s r="289">
                                 <a:s>FHIRHelpers</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="293">
                                 <a:s>ToDateTime(</a:s>
                                 <a:s r="292">
                                    <a:s r="290">
                                       <a:s>choice</a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="291">
                                       <a:s>FHIR.instant</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="298">
                              <a:s r="294">
                                 <a:s>FHIRHelpers</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="298">
                                 <a:s>ToDateTime(</a:s>
                                 <a:s r="297">
                                    <a:s r="295">
                                       <a:s>choice</a:s>
                                    </a:s>
                                    <a:s> as </a:s>
                                    <a:s r="296">
                                       <a:s>FHIR.instant</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                           <a:s>]</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="327">
                        <a:s>when </a:s>
                        <a:s r="303">
                           <a:s r="301">
                              <a:s>choice</a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="302">
                              <a:s>FHIR.Age</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then
  		  </a:s>
                        <a:s r="326">
                           <a:s>Interval[</a:s>
                           <a:s r="313">
                              <a:s r="307">
                                 <a:s r="304">
                                    <a:s>FHIRHelpers</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="307">
                                    <a:s>ToDate(</a:s>
                                    <a:s r="306">
                                       <a:s r="305">
                                          <a:s>Patient</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="306">
                                          <a:s>birthDate</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> + </a:s>
                              <a:s r="312">
                                 <a:s r="308">
                                    <a:s>FHIRHelpers</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="312">
                                    <a:s>ToQuantity(</a:s>
                                    <a:s r="311">
                                       <a:s r="309">
                                          <a:s>choice</a:s>
                                       </a:s>
                                       <a:s> as </a:s>
                                       <a:s r="310">
                                          <a:s>FHIR.Age</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
  			  </a:s>
                           <a:s r="325">
                              <a:s r="323">
                                 <a:s r="317">
                                    <a:s r="314">
                                       <a:s>FHIRHelpers</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="317">
                                       <a:s>ToDate(</a:s>
                                       <a:s r="316">
                                          <a:s r="315">
                                             <a:s>Patient</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="316">
                                             <a:s>birthDate</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="322">
                                    <a:s r="318">
                                       <a:s>FHIRHelpers</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="322">
                                       <a:s>ToQuantity(</a:s>
                                       <a:s r="321">
                                          <a:s r="319">
                                             <a:s>choice</a:s>
                                          </a:s>
                                          <a:s> as </a:s>
                                          <a:s r="320">
                                             <a:s>FHIR.Age</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s> + </a:s>
                              <a:s r="324">
                                 <a:s>1 year</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="356">
                        <a:s>when </a:s>
                        <a:s r="330">
                           <a:s r="328">
                              <a:s>choice</a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="329">
                              <a:s>FHIR.Range</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then
  		  </a:s>
                        <a:s r="355">
                           <a:s>Interval[</a:s>
                           <a:s r="341">
                              <a:s r="334">
                                 <a:s r="331">
                                    <a:s>FHIRHelpers</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="334">
                                    <a:s>ToDate(</a:s>
                                    <a:s r="333">
                                       <a:s r="332">
                                          <a:s>Patient</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="333">
                                          <a:s>birthDate</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> + </a:s>
                              <a:s r="340">
                                 <a:s r="335">
                                    <a:s>FHIRHelpers</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="340">
                                    <a:s>ToQuantity(</a:s>
                                    <a:s r="339">
                                       <a:s r="338">
                                          <a:s>(</a:s>
                                          <a:s r="338">
                                             <a:s r="336">
                                                <a:s>choice</a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="337">
                                                <a:s>FHIR.Range</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="339">
                                          <a:s>low</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>,
  			  </a:s>
                           <a:s r="354">
                              <a:s r="352">
                                 <a:s r="345">
                                    <a:s r="342">
                                       <a:s>FHIRHelpers</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="345">
                                       <a:s>ToDate(</a:s>
                                       <a:s r="344">
                                          <a:s r="343">
                                             <a:s>Patient</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="344">
                                             <a:s>birthDate</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="351">
                                    <a:s r="346">
                                       <a:s>FHIRHelpers</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="351">
                                       <a:s>ToQuantity(</a:s>
                                       <a:s r="350">
                                          <a:s r="349">
                                             <a:s>(</a:s>
                                             <a:s r="349">
                                                <a:s r="347">
                                                   <a:s>choice</a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="348">
                                                   <a:s>FHIR.Range</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="350">
                                             <a:s>high</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s> + </a:s>
                              <a:s r="353">
                                 <a:s>1 year</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="369">
                        <a:s>when </a:s>
                        <a:s r="359">
                           <a:s r="357">
                              <a:s>choice</a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="358">
                              <a:s>FHIR.Timing</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then
  		  </a:s>
                        <a:s r="368">
                           <a:s>Message(</a:s>
                           <a:s r="363">
                              <a:s r="360">null as </a:s>
                              <a:s r="362">
                                 <a:s>Interval&lt;</a:s>
                                 <a:s r="361">
                                    <a:s>DateTime</a:s>
                                 </a:s>
                                 <a:s>></a:s>
                              </a:s>
                           </a:s>
                           <a:s r="364">, true, </a:s>
                           <a:s r="365">
                              <a:s>'1'</a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="366">
                              <a:s>'Error'</a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="367">
                              <a:s>'Cannot compute a single interval from a Timing type'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="382">
                        <a:s>when </a:s>
                        <a:s r="372">
                           <a:s r="370">
                              <a:s>choice</a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="371">
                              <a:s>FHIR.string</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then
      </a:s>
                        <a:s r="381">
                           <a:s>Message(</a:s>
                           <a:s r="376">
                              <a:s r="373">null as </a:s>
                              <a:s r="375">
                                 <a:s>Interval&lt;</a:s>
                                 <a:s r="374">
                                    <a:s>DateTime</a:s>
                                 </a:s>
                                 <a:s>></a:s>
                              </a:s>
                           </a:s>
                           <a:s r="377">, true, </a:s>
                           <a:s r="378">
                              <a:s>'1'</a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="379">
                              <a:s>'Error'</a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="380">
                              <a:s>'Cannot compute an interval from a String value'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		else
  			</a:s>
                     <a:s r="386">
                        <a:s r="383">null as </a:s>
                        <a:s r="385">
                           <a:s>Interval&lt;</a:s>
                           <a:s r="384">
                              <a:s>DateTime</a:s>
                           </a:s>
                           <a:s>></a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	end</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
            <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="387" locator="207:3-226:6" xsi:type="Case">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <caseItem localId="276" locator="208:6-209:109">
               <when localId="264" locator="208:11-208:33" resultTypeName="t:Boolean" xsi:type="Is">
                  <operand localId="262" locator="208:11-208:16" name="choice" xsi:type="OperandRef">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
                  <isTypeSpecifier localId="263" locator="208:21-208:33" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </when>
               <then localId="275" locator="209:4-209:109" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <low localId="269" locator="209:13-209:59" resultTypeName="t:DateTime" name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="268" locator="209:36-209:58" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                        <operand localId="266" locator="209:36-209:41" name="choice" xsi:type="OperandRef">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </operand>
                        <asTypeSpecifier localId="267" locator="209:46-209:58" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </low>
                  <high localId="274" locator="209:62-209:108" resultTypeName="t:DateTime" name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="273" locator="209:85-209:107" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                        <operand localId="271" locator="209:85-209:90" name="choice" xsi:type="OperandRef">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </operand>
                        <asTypeSpecifier localId="272" locator="209:95-209:107" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </high>
               </then>
            </caseItem>
            <caseItem localId="285" locator="210:5-211:49">
               <when localId="279" locator="210:10-210:30" resultTypeName="t:Boolean" xsi:type="Is">
                  <operand localId="277" locator="210:10-210:15" name="choice" xsi:type="OperandRef">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
                  <isTypeSpecifier localId="278" locator="210:20-210:30" resultTypeName="fhir:Period" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
               </when>
               <then localId="284" locator="211:5-211:49" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="283" locator="211:28-211:48" resultTypeName="fhir:Period" strict="false" xsi:type="As">
                     <operand localId="281" locator="211:28-211:33" name="choice" xsi:type="OperandRef">
                        <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                           <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                     <asTypeSpecifier localId="282" locator="211:38-211:48" resultTypeName="fhir:Period" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </then>
            </caseItem>
            <caseItem localId="300" locator="212:5-213:109">
               <when localId="288" locator="212:10-212:31" resultTypeName="t:Boolean" xsi:type="Is">
                  <operand localId="286" locator="212:10-212:15" name="choice" xsi:type="OperandRef">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
                  <isTypeSpecifier localId="287" locator="212:20-212:31" resultTypeName="fhir:instant" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               </when>
               <then localId="299" locator="213:6-213:109" lowClosed="true" highClosed="true" xsi:type="Interval">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <low localId="293" locator="213:15-213:60" resultTypeName="t:DateTime" name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="292" locator="213:38-213:59" resultTypeName="fhir:instant" strict="false" xsi:type="As">
                        <operand localId="290" locator="213:38-213:43" name="choice" xsi:type="OperandRef">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </operand>
                        <asTypeSpecifier localId="291" locator="213:48-213:59" resultTypeName="fhir:instant" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </low>
                  <high localId="298" locator="213:63-213:108" resultTypeName="t:DateTime" name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="297" locator="213:86-213:107" resultTypeName="fhir:instant" strict="false" xsi:type="As">
                        <operand localId="295" locator="213:86-213:91" name="choice" xsi:type="OperandRef">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </operand>
                        <asTypeSpecifier localId="296" locator="213:96-213:107" resultTypeName="fhir:instant" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                  </high>
               </then>
            </caseItem>
            <caseItem localId="327" locator="214:5-216:99">
               <when localId="303" locator="214:10-214:27" resultTypeName="t:Boolean" xsi:type="Is">
                  <operand localId="301" locator="214:10-214:15" name="choice" xsi:type="OperandRef">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
                  <isTypeSpecifier localId="302" locator="214:20-214:27" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
               </when>
               <then xsi:type="Interval">
                  <low xsi:type="ToDateTime">
                     <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                     <operand path="low" xsi:type="Property">
                        <source localId="326" locator="215:7-216:99" lowClosed="true" highClosed="false" xsi:type="Interval">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <low localId="313" locator="215:16-215:97" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="307" locator="215:16-215:52" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="306" locator="215:35-215:51" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                    <source localId="305" locator="215:35-215:41" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                 </operand>
                              </operand>
                              <operand localId="312" locator="215:56-215:97" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="311" locator="215:79-215:96" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                    <operand localId="309" locator="215:79-215:84" name="choice" xsi:type="OperandRef">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                    </operand>
                                    <asTypeSpecifier localId="310" locator="215:89-215:96" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                 </operand>
                              </operand>
                           </low>
                           <high localId="325" locator="216:8-216:98" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="323" locator="216:8-216:89" resultTypeName="t:Date" xsi:type="Add">
                                 <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="317" locator="216:8-216:44" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="316" locator="216:27-216:43" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                       <source localId="315" locator="216:27-216:33" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                    </operand>
                                 </operand>
                                 <operand localId="322" locator="216:48-216:89" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="321" locator="216:71-216:88" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                       <operand localId="319" locator="216:71-216:76" name="choice" xsi:type="OperandRef">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          </resultTypeSpecifier>
                                       </operand>
                                       <asTypeSpecifier localId="320" locator="216:81-216:88" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="324" locator="216:93-216:98" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                           </high>
                        </source>
                     </operand>
                  </low>
                  <lowClosedExpression path="lowClosed" xsi:type="Property">
                     <source localId="326" locator="215:7-216:99" lowClosed="true" highClosed="false" xsi:type="Interval">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <low localId="313" locator="215:16-215:97" resultTypeName="t:Date" xsi:type="Add">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="307" locator="215:16-215:52" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="306" locator="215:35-215:51" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                 <source localId="305" locator="215:35-215:41" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                              </operand>
                           </operand>
                           <operand localId="312" locator="215:56-215:97" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="311" locator="215:79-215:96" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                 <operand localId="309" locator="215:79-215:84" name="choice" xsi:type="OperandRef">
                                    <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                       <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                 </operand>
                                 <asTypeSpecifier localId="310" locator="215:89-215:96" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                              </operand>
                           </operand>
                        </low>
                        <high localId="325" locator="216:8-216:98" resultTypeName="t:Date" xsi:type="Add">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="323" locator="216:8-216:89" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="317" locator="216:8-216:44" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="316" locator="216:27-216:43" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                    <source localId="315" locator="216:27-216:33" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                 </operand>
                              </operand>
                              <operand localId="322" locator="216:48-216:89" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="321" locator="216:71-216:88" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                    <operand localId="319" locator="216:71-216:76" name="choice" xsi:type="OperandRef">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                    </operand>
                                    <asTypeSpecifier localId="320" locator="216:81-216:88" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                 </operand>
                              </operand>
                           </operand>
                           <operand localId="324" locator="216:93-216:98" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                        </high>
                     </source>
                  </lowClosedExpression>
                  <high xsi:type="ToDateTime">
                     <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                     <operand path="high" xsi:type="Property">
                        <source localId="326" locator="215:7-216:99" lowClosed="true" highClosed="false" xsi:type="Interval">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <low localId="313" locator="215:16-215:97" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="307" locator="215:16-215:52" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="306" locator="215:35-215:51" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                    <source localId="305" locator="215:35-215:41" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                 </operand>
                              </operand>
                              <operand localId="312" locator="215:56-215:97" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="311" locator="215:79-215:96" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                    <operand localId="309" locator="215:79-215:84" name="choice" xsi:type="OperandRef">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                    </operand>
                                    <asTypeSpecifier localId="310" locator="215:89-215:96" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                 </operand>
                              </operand>
                           </low>
                           <high localId="325" locator="216:8-216:98" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="323" locator="216:8-216:89" resultTypeName="t:Date" xsi:type="Add">
                                 <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="317" locator="216:8-216:44" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="316" locator="216:27-216:43" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                       <source localId="315" locator="216:27-216:33" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                    </operand>
                                 </operand>
                                 <operand localId="322" locator="216:48-216:89" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="321" locator="216:71-216:88" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                       <operand localId="319" locator="216:71-216:76" name="choice" xsi:type="OperandRef">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          </resultTypeSpecifier>
                                       </operand>
                                       <asTypeSpecifier localId="320" locator="216:81-216:88" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="324" locator="216:93-216:98" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                           </high>
                        </source>
                     </operand>
                  </high>
                  <highClosedExpression path="highClosed" xsi:type="Property">
                     <source localId="326" locator="215:7-216:99" lowClosed="true" highClosed="false" xsi:type="Interval">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <low localId="313" locator="215:16-215:97" resultTypeName="t:Date" xsi:type="Add">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="307" locator="215:16-215:52" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="306" locator="215:35-215:51" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                 <source localId="305" locator="215:35-215:41" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                              </operand>
                           </operand>
                           <operand localId="312" locator="215:56-215:97" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="311" locator="215:79-215:96" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                 <operand localId="309" locator="215:79-215:84" name="choice" xsi:type="OperandRef">
                                    <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                       <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                 </operand>
                                 <asTypeSpecifier localId="310" locator="215:89-215:96" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                              </operand>
                           </operand>
                        </low>
                        <high localId="325" locator="216:8-216:98" resultTypeName="t:Date" xsi:type="Add">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="323" locator="216:8-216:89" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="317" locator="216:8-216:44" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="316" locator="216:27-216:43" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                    <source localId="315" locator="216:27-216:33" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                 </operand>
                              </operand>
                              <operand localId="322" locator="216:48-216:89" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="321" locator="216:71-216:88" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                    <operand localId="319" locator="216:71-216:76" name="choice" xsi:type="OperandRef">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                    </operand>
                                    <asTypeSpecifier localId="320" locator="216:81-216:88" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                 </operand>
                              </operand>
                           </operand>
                           <operand localId="324" locator="216:93-216:98" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                        </high>
                     </source>
                  </highClosedExpression>
               </then>
            </caseItem>
            <caseItem localId="356" locator="217:5-219:108">
               <when localId="330" locator="217:10-217:29" resultTypeName="t:Boolean" xsi:type="Is">
                  <operand localId="328" locator="217:10-217:15" name="choice" xsi:type="OperandRef">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
                  <isTypeSpecifier localId="329" locator="217:20-217:29" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
               </when>
               <then xsi:type="Interval">
                  <low xsi:type="ToDateTime">
                     <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                     <operand path="low" xsi:type="Property">
                        <source localId="355" locator="218:7-219:108" lowClosed="true" highClosed="false" xsi:type="Interval">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <low localId="341" locator="218:16-218:105" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="334" locator="218:16-218:52" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="333" locator="218:35-218:51" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                    <source localId="332" locator="218:35-218:41" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                 </operand>
                              </operand>
                              <operand localId="340" locator="218:56-218:105" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="339" locator="218:79-218:104" resultTypeName="fhir:SimpleQuantity" path="low" xsi:type="Property">
                                    <source localId="338" locator="218:79-218:100" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                       <operand localId="336" locator="218:80-218:85" name="choice" xsi:type="OperandRef">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          </resultTypeSpecifier>
                                       </operand>
                                       <asTypeSpecifier localId="337" locator="218:90-218:99" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </operand>
                              </operand>
                           </low>
                           <high localId="354" locator="219:8-219:107" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="352" locator="219:8-219:98" resultTypeName="t:Date" xsi:type="Add">
                                 <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="345" locator="219:8-219:44" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="344" locator="219:27-219:43" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                       <source localId="343" locator="219:27-219:33" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                    </operand>
                                 </operand>
                                 <operand localId="351" locator="219:48-219:98" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="350" locator="219:71-219:97" resultTypeName="fhir:SimpleQuantity" path="high" xsi:type="Property">
                                       <source localId="349" locator="219:71-219:92" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                          <operand localId="347" locator="219:72-219:77" name="choice" xsi:type="OperandRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                          </operand>
                                          <asTypeSpecifier localId="348" locator="219:82-219:91" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="353" locator="219:102-219:107" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                           </high>
                        </source>
                     </operand>
                  </low>
                  <lowClosedExpression path="lowClosed" xsi:type="Property">
                     <source localId="355" locator="218:7-219:108" lowClosed="true" highClosed="false" xsi:type="Interval">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <low localId="341" locator="218:16-218:105" resultTypeName="t:Date" xsi:type="Add">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="334" locator="218:16-218:52" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="333" locator="218:35-218:51" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                 <source localId="332" locator="218:35-218:41" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                              </operand>
                           </operand>
                           <operand localId="340" locator="218:56-218:105" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="339" locator="218:79-218:104" resultTypeName="fhir:SimpleQuantity" path="low" xsi:type="Property">
                                 <source localId="338" locator="218:79-218:100" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                    <operand localId="336" locator="218:80-218:85" name="choice" xsi:type="OperandRef">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                    </operand>
                                    <asTypeSpecifier localId="337" locator="218:90-218:99" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                 </source>
                              </operand>
                           </operand>
                        </low>
                        <high localId="354" locator="219:8-219:107" resultTypeName="t:Date" xsi:type="Add">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="352" locator="219:8-219:98" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="345" locator="219:8-219:44" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="344" locator="219:27-219:43" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                    <source localId="343" locator="219:27-219:33" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                 </operand>
                              </operand>
                              <operand localId="351" locator="219:48-219:98" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="350" locator="219:71-219:97" resultTypeName="fhir:SimpleQuantity" path="high" xsi:type="Property">
                                    <source localId="349" locator="219:71-219:92" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                       <operand localId="347" locator="219:72-219:77" name="choice" xsi:type="OperandRef">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          </resultTypeSpecifier>
                                       </operand>
                                       <asTypeSpecifier localId="348" locator="219:82-219:91" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </operand>
                              </operand>
                           </operand>
                           <operand localId="353" locator="219:102-219:107" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                        </high>
                     </source>
                  </lowClosedExpression>
                  <high xsi:type="ToDateTime">
                     <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                     <operand path="high" xsi:type="Property">
                        <source localId="355" locator="218:7-219:108" lowClosed="true" highClosed="false" xsi:type="Interval">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <low localId="341" locator="218:16-218:105" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="334" locator="218:16-218:52" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="333" locator="218:35-218:51" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                    <source localId="332" locator="218:35-218:41" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                 </operand>
                              </operand>
                              <operand localId="340" locator="218:56-218:105" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="339" locator="218:79-218:104" resultTypeName="fhir:SimpleQuantity" path="low" xsi:type="Property">
                                    <source localId="338" locator="218:79-218:100" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                       <operand localId="336" locator="218:80-218:85" name="choice" xsi:type="OperandRef">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          </resultTypeSpecifier>
                                       </operand>
                                       <asTypeSpecifier localId="337" locator="218:90-218:99" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </operand>
                              </operand>
                           </low>
                           <high localId="354" locator="219:8-219:107" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="352" locator="219:8-219:98" resultTypeName="t:Date" xsi:type="Add">
                                 <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="345" locator="219:8-219:44" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="344" locator="219:27-219:43" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                       <source localId="343" locator="219:27-219:33" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                    </operand>
                                 </operand>
                                 <operand localId="351" locator="219:48-219:98" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="350" locator="219:71-219:97" resultTypeName="fhir:SimpleQuantity" path="high" xsi:type="Property">
                                       <source localId="349" locator="219:71-219:92" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                          <operand localId="347" locator="219:72-219:77" name="choice" xsi:type="OperandRef">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                          </operand>
                                          <asTypeSpecifier localId="348" locator="219:82-219:91" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                       </source>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="353" locator="219:102-219:107" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                           </high>
                        </source>
                     </operand>
                  </high>
                  <highClosedExpression path="highClosed" xsi:type="Property">
                     <source localId="355" locator="218:7-219:108" lowClosed="true" highClosed="false" xsi:type="Interval">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <low localId="341" locator="218:16-218:105" resultTypeName="t:Date" xsi:type="Add">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="334" locator="218:16-218:52" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="333" locator="218:35-218:51" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                 <source localId="332" locator="218:35-218:41" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                              </operand>
                           </operand>
                           <operand localId="340" locator="218:56-218:105" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="339" locator="218:79-218:104" resultTypeName="fhir:SimpleQuantity" path="low" xsi:type="Property">
                                 <source localId="338" locator="218:79-218:100" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                    <operand localId="336" locator="218:80-218:85" name="choice" xsi:type="OperandRef">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                    </operand>
                                    <asTypeSpecifier localId="337" locator="218:90-218:99" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                 </source>
                              </operand>
                           </operand>
                        </low>
                        <high localId="354" locator="219:8-219:107" resultTypeName="t:Date" xsi:type="Add">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="352" locator="219:8-219:98" resultTypeName="t:Date" xsi:type="Add">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="345" locator="219:8-219:44" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="344" locator="219:27-219:43" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                    <source localId="343" locator="219:27-219:33" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                 </operand>
                              </operand>
                              <operand localId="351" locator="219:48-219:98" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="350" locator="219:71-219:97" resultTypeName="fhir:SimpleQuantity" path="high" xsi:type="Property">
                                    <source localId="349" locator="219:71-219:92" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                       <operand localId="347" locator="219:72-219:77" name="choice" xsi:type="OperandRef">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          </resultTypeSpecifier>
                                       </operand>
                                       <asTypeSpecifier localId="348" locator="219:82-219:91" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                    </source>
                                 </operand>
                              </operand>
                           </operand>
                           <operand localId="353" locator="219:102-219:107" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                        </high>
                     </source>
                  </highClosedExpression>
               </then>
            </caseItem>
            <caseItem localId="369" locator="220:5-221:116">
               <when localId="359" locator="220:10-220:30" resultTypeName="t:Boolean" xsi:type="Is">
                  <operand localId="357" locator="220:10-220:15" name="choice" xsi:type="OperandRef">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
                  <isTypeSpecifier localId="358" locator="220:20-220:30" resultTypeName="fhir:Timing" name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
               </when>
               <then localId="368" locator="221:7-221:116" xsi:type="Message">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <signature xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <source localId="363" locator="221:15-221:40" strict="false" xsi:type="As">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <operand localId="360" locator="221:15-221:18" resultTypeName="t:Any" xsi:type="Null"/>
                     <asTypeSpecifier localId="362" locator="221:23-221:40" xsi:type="IntervalTypeSpecifier">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <pointType localId="361" locator="221:32-221:39" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </asTypeSpecifier>
                  </source>
                  <condition localId="364" locator="221:43-221:46" resultTypeName="t:Boolean" valueType="t:Boolean" value="true" xsi:type="Literal"/>
                  <code localId="365" locator="221:49-221:51" resultTypeName="t:String" valueType="t:String" value="1" xsi:type="Literal"/>
                  <severity localId="366" locator="221:54-221:60" resultTypeName="t:String" valueType="t:String" value="Error" xsi:type="Literal"/>
                  <message localId="367" locator="221:63-221:115" resultTypeName="t:String" valueType="t:String" value="Cannot compute a single interval from a Timing type" xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="382" locator="222:5-223:111">
               <when localId="372" locator="222:10-222:30" resultTypeName="t:Boolean" xsi:type="Is">
                  <operand localId="370" locator="222:10-222:15" name="choice" xsi:type="OperandRef">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
                  <isTypeSpecifier localId="371" locator="222:20-222:30" resultTypeName="fhir:string" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
               </when>
               <then localId="381" locator="223:7-223:111" xsi:type="Message">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <signature xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <source localId="376" locator="223:15-223:40" strict="false" xsi:type="As">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <operand localId="373" locator="223:15-223:18" resultTypeName="t:Any" xsi:type="Null"/>
                     <asTypeSpecifier localId="375" locator="223:23-223:40" xsi:type="IntervalTypeSpecifier">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <pointType localId="374" locator="223:32-223:39" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </asTypeSpecifier>
                  </source>
                  <condition localId="377" locator="223:43-223:46" resultTypeName="t:Boolean" valueType="t:Boolean" value="true" xsi:type="Literal"/>
                  <code localId="378" locator="223:49-223:51" resultTypeName="t:String" valueType="t:String" value="1" xsi:type="Literal"/>
                  <severity localId="379" locator="223:54-223:60" resultTypeName="t:String" valueType="t:String" value="Error" xsi:type="Literal"/>
                  <message localId="380" locator="223:63-223:110" resultTypeName="t:String" valueType="t:String" value="Cannot compute an interval from a String value" xsi:type="Literal"/>
               </then>
            </caseItem>
            <else localId="386" locator="225:6-225:31" strict="false" xsi:type="As">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <operand localId="383" locator="225:6-225:9" resultTypeName="t:Any" xsi:type="Null"/>
               <asTypeSpecifier localId="385" locator="225:14-225:31" xsi:type="IntervalTypeSpecifier">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <pointType localId="384" locator="225:23-225:30" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </asTypeSpecifier>
            </else>
         </expression>
         <operand name="choice">
            <operandTypeSpecifier localId="261" locator="206:45-206:140" xsi:type="ChoiceTypeSpecifier">
               <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <choice localId="254" locator="206:52-206:64" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               <choice localId="255" locator="206:67-206:77" resultTypeName="fhir:Period" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
               <choice localId="256" locator="206:80-206:90" resultTypeName="fhir:Timing" name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
               <choice localId="257" locator="206:93-206:104" resultTypeName="fhir:instant" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               <choice localId="258" locator="206:107-206:117" resultTypeName="fhir:string" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
               <choice localId="259" locator="206:120-206:127" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
               <choice localId="260" locator="206:130-206:139" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="508" locator="233:1-248:12" name="Normalize Abatement" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="508">
               <a:s>/**
* Returns an interval representing the abatement of the given condition, if an
abatement element is present, null otherwise.
This function uses the semantics of Normalize Interval to interpret the abatement
element.*/
define function &quot;Normalize Abatement&quot;(condition </a:s>
               <a:s r="389">
                  <a:s>Condition</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="507">
                  <a:s r="507">
                     <a:s>if </a:s>
                     <a:s r="393">
                        <a:s r="391">
                           <a:s r="390">
                              <a:s>condition</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="391">
                              <a:s>abatement</a:s>
                           </a:s>
                        </a:s>
                        <a:s> is </a:s>
                        <a:s r="392">
                           <a:s>FHIR.dateTime</a:s>
                        </a:s>
                     </a:s>
                     <a:s> then
  	  </a:s>
                     <a:s r="406">
                        <a:s>Interval[</a:s>
                        <a:s r="399">
                           <a:s r="394">
                              <a:s>FHIRHelpers</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="399">
                              <a:s>ToDateTime(</a:s>
                              <a:s r="398">
                                 <a:s r="396">
                                    <a:s r="395">
                                       <a:s>condition</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="396">
                                       <a:s>abatement</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="397">
                                    <a:s>FHIR.dateTime</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="405">
                           <a:s r="400">
                              <a:s>FHIRHelpers</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="405">
                              <a:s>ToDateTime(</a:s>
                              <a:s r="404">
                                 <a:s r="402">
                                    <a:s r="401">
                                       <a:s>condition</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="402">
                                       <a:s>abatement</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="403">
                                    <a:s>FHIR.dateTime</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>]</a:s>
                     </a:s>
                     <a:s>
  	else </a:s>
                     <a:s r="506">
                        <a:s>if </a:s>
                        <a:s r="410">
                           <a:s r="408">
                              <a:s r="407">
                                 <a:s>condition</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="408">
                                 <a:s>abatement</a:s>
                              </a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="409">
                              <a:s>FHIR.Period</a:s>
                           </a:s>
                        </a:s>
                        <a:s> then
  	  </a:s>
                        <a:s r="416">
                           <a:s r="411">
                              <a:s>FHIRHelpers</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="416">
                              <a:s>ToInterval(</a:s>
                              <a:s r="415">
                                 <a:s r="413">
                                    <a:s r="412">
                                       <a:s>condition</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="413">
                                       <a:s>abatement</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="414">
                                    <a:s>FHIR.Period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  	else </a:s>
                        <a:s r="505">
                           <a:s>if </a:s>
                           <a:s r="420">
                              <a:s r="418">
                                 <a:s r="417">
                                    <a:s>condition</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="418">
                                    <a:s>abatement</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> is </a:s>
                              <a:s r="419">
                                 <a:s>FHIR.string</a:s>
                              </a:s>
                           </a:s>
                           <a:s> then
  </a:s>
                           <a:s r="429">
                              <a:s>Message(</a:s>
                              <a:s r="424">
                                 <a:s r="421">null as </a:s>
                                 <a:s r="423">
                                    <a:s>Interval&lt;</a:s>
                                    <a:s r="422">
                                       <a:s>DateTime</a:s>
                                    </a:s>
                                    <a:s>></a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="425">, true, </a:s>
                              <a:s r="426">
                                 <a:s>'1'</a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="427">
                                 <a:s>'Error'</a:s>
                              </a:s>
                              <a:s>, </a:s>
                              <a:s r="428">
                                 <a:s>'Cannot compute an interval from a String value'</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s>
  	else </a:s>
                           <a:s r="504">
                              <a:s>if </a:s>
                              <a:s r="433">
                                 <a:s r="431">
                                    <a:s r="430">
                                       <a:s>condition</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="431">
                                       <a:s>abatement</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> is </a:s>
                                 <a:s r="432">
                                    <a:s>FHIR.Age</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> then
  		</a:s>
                              <a:s r="458">
                                 <a:s>Interval[</a:s>
                                 <a:s r="444">
                                    <a:s r="437">
                                       <a:s r="434">
                                          <a:s>FHIRHelpers</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="437">
                                          <a:s>ToDate(</a:s>
                                          <a:s r="436">
                                             <a:s r="435">
                                                <a:s>Patient</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="436">
                                                <a:s>birthDate</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> + </a:s>
                                    <a:s r="443">
                                       <a:s r="438">
                                          <a:s>FHIRHelpers</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="443">
                                          <a:s>ToQuantity(</a:s>
                                          <a:s r="442">
                                             <a:s r="440">
                                                <a:s r="439">
                                                   <a:s>condition</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="440">
                                                   <a:s>abatement</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> as </a:s>
                                             <a:s r="441">
                                                <a:s>FHIR.Age</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>,
  			</a:s>
                                 <a:s r="457">
                                    <a:s r="455">
                                       <a:s r="448">
                                          <a:s r="445">
                                             <a:s>FHIRHelpers</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="448">
                                             <a:s>ToDate(</a:s>
                                             <a:s r="447">
                                                <a:s r="446">
                                                   <a:s>Patient</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="447">
                                                   <a:s>birthDate</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> + </a:s>
                                       <a:s r="454">
                                          <a:s r="449">
                                             <a:s>FHIRHelpers</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="454">
                                             <a:s>ToQuantity(</a:s>
                                             <a:s r="453">
                                                <a:s r="451">
                                                   <a:s r="450">
                                                      <a:s>condition</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="451">
                                                      <a:s>abatement</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s> as </a:s>
                                                <a:s r="452">
                                                   <a:s>FHIR.Age</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> + </a:s>
                                    <a:s r="456">
                                       <a:s>1 year</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>
  	else </a:s>
                              <a:s r="503">
                                 <a:s>if </a:s>
                                 <a:s r="462">
                                    <a:s r="460">
                                       <a:s r="459">
                                          <a:s>condition</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="460">
                                          <a:s>abatement</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> is </a:s>
                                    <a:s r="461">
                                       <a:s>FHIR.Range</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> then
  	  </a:s>
                                 <a:s r="489">
                                    <a:s>Interval[</a:s>
                                    <a:s r="474">
                                       <a:s r="466">
                                          <a:s r="463">
                                             <a:s>FHIRHelpers</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="466">
                                             <a:s>ToDate(</a:s>
                                             <a:s r="465">
                                                <a:s r="464">
                                                   <a:s>Patient</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="465">
                                                   <a:s>birthDate</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> + </a:s>
                                       <a:s r="473">
                                          <a:s r="467">
                                             <a:s>FHIRHelpers</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="473">
                                             <a:s>ToQuantity(</a:s>
                                             <a:s r="472">
                                                <a:s r="471">
                                                   <a:s>(</a:s>
                                                   <a:s r="471">
                                                      <a:s r="469">
                                                         <a:s r="468">
                                                            <a:s>condition</a:s>
                                                         </a:s>
                                                         <a:s>.</a:s>
                                                         <a:s r="469">
                                                            <a:s>abatement</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s> as </a:s>
                                                      <a:s r="470">
                                                         <a:s>FHIR.Range</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s>)</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="472">
                                                   <a:s>low</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>,
  		  </a:s>
                                    <a:s r="488">
                                       <a:s r="486">
                                          <a:s r="478">
                                             <a:s r="475">
                                                <a:s>FHIRHelpers</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="478">
                                                <a:s>ToDate(</a:s>
                                                <a:s r="477">
                                                   <a:s r="476">
                                                      <a:s>Patient</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="477">
                                                      <a:s>birthDate</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> + </a:s>
                                          <a:s r="485">
                                             <a:s r="479">
                                                <a:s>FHIRHelpers</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="485">
                                                <a:s>ToQuantity(</a:s>
                                                <a:s r="484">
                                                   <a:s r="483">
                                                      <a:s>(</a:s>
                                                      <a:s r="483">
                                                         <a:s r="481">
                                                            <a:s r="480">
                                                               <a:s>condition</a:s>
                                                            </a:s>
                                                            <a:s>.</a:s>
                                                            <a:s r="481">
                                                               <a:s>abatement</a:s>
                                                            </a:s>
                                                         </a:s>
                                                         <a:s> as </a:s>
                                                         <a:s r="482">
                                                            <a:s>FHIR.Range</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s>)</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="484">
                                                      <a:s>high</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>)</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> + </a:s>
                                       <a:s r="487">
                                          <a:s>1 year</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                                 <a:s>
  	else </a:s>
                                 <a:s r="502">
                                    <a:s>if </a:s>
                                    <a:s r="493">
                                       <a:s r="491">
                                          <a:s r="490">
                                             <a:s>condition</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="491">
                                             <a:s>abatement</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> is </a:s>
                                       <a:s r="492">
                                          <a:s>FHIR.boolean</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> then
  	  </a:s>
                                    <a:s r="500">
                                       <a:s>Interval[</a:s>
                                       <a:s r="497">
                                          <a:s>end of </a:s>
                                          <a:s r="496">
                                             <a:s>&quot;Normalize Interval&quot;(</a:s>
                                             <a:s r="495">
                                                <a:s r="494">
                                                   <a:s>condition</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="495">
                                                   <a:s>onset</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>, </a:s>
                                       <a:s r="499">
                                          <a:s r="498">
                                             <a:s>condition</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="499">
                                             <a:s>recordedDate</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s r="501">
  	else null</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
            <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="507" locator="234:3-248:12" xsi:type="If">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <condition localId="393" locator="234:6-234:41" resultTypeName="t:Boolean" xsi:type="Is">
               <operand localId="391" locator="234:6-234:24" path="abatement" xsi:type="Property">
                  <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                     <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source localId="390" locator="234:6-234:14" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
               </operand>
               <isTypeSpecifier localId="392" locator="234:29-234:41" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
            </condition>
            <then localId="406" locator="235:6-235:137" lowClosed="true" highClosed="true" xsi:type="Interval">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <low localId="399" locator="235:15-235:74" resultTypeName="t:DateTime" name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                  <signature name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="398" locator="235:38-235:73" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                     <operand localId="396" locator="235:38-235:56" path="abatement" xsi:type="Property">
                        <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                           <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="395" locator="235:38-235:46" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="397" locator="235:61-235:73" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </low>
               <high localId="405" locator="235:77-235:136" resultTypeName="t:DateTime" name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                  <signature name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="404" locator="235:100-235:135" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                     <operand localId="402" locator="235:100-235:118" path="abatement" xsi:type="Property">
                        <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                           <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="401" locator="235:100-235:108" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="403" locator="235:123-235:135" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </high>
            </then>
            <else localId="506" locator="236:9-248:12" xsi:type="If">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <condition localId="410" locator="236:12-236:45" resultTypeName="t:Boolean" xsi:type="Is">
                  <operand localId="408" locator="236:12-236:30" path="abatement" xsi:type="Property">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="407" locator="236:12-236:20" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                  </operand>
                  <isTypeSpecifier localId="409" locator="236:35-236:45" resultTypeName="fhir:Period" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
               </condition>
               <then localId="416" locator="237:6-237:63" name="ToInterval" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <signature name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="415" locator="237:29-237:62" resultTypeName="fhir:Period" strict="false" xsi:type="As">
                     <operand localId="413" locator="237:29-237:47" path="abatement" xsi:type="Property">
                        <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                           <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="412" locator="237:29-237:37" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                     </operand>
                     <asTypeSpecifier localId="414" locator="237:52-237:62" resultTypeName="fhir:Period" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  </operand>
               </then>
               <else localId="505" locator="238:9-248:12" xsi:type="If">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <condition localId="420" locator="238:12-238:45" resultTypeName="t:Boolean" xsi:type="Is">
                     <operand localId="418" locator="238:12-238:30" path="abatement" xsi:type="Property">
                        <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                           <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="417" locator="238:12-238:20" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                     </operand>
                     <isTypeSpecifier localId="419" locator="238:35-238:45" resultTypeName="fhir:string" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  </condition>
                  <then localId="429" locator="239:3-239:107" xsi:type="Message">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <source localId="424" locator="239:11-239:36" strict="false" xsi:type="As">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <operand localId="421" locator="239:11-239:14" resultTypeName="t:Any" xsi:type="Null"/>
                        <asTypeSpecifier localId="423" locator="239:19-239:36" xsi:type="IntervalTypeSpecifier">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <pointType localId="422" locator="239:28-239:35" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </asTypeSpecifier>
                     </source>
                     <condition localId="425" locator="239:39-239:42" resultTypeName="t:Boolean" valueType="t:Boolean" value="true" xsi:type="Literal"/>
                     <code localId="426" locator="239:45-239:47" resultTypeName="t:String" valueType="t:String" value="1" xsi:type="Literal"/>
                     <severity localId="427" locator="239:50-239:56" resultTypeName="t:String" valueType="t:String" value="Error" xsi:type="Literal"/>
                     <message localId="428" locator="239:59-239:106" resultTypeName="t:String" valueType="t:String" value="Cannot compute an interval from a String value" xsi:type="Literal"/>
                  </then>
                  <else localId="504" locator="240:9-248:12" xsi:type="If">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <condition localId="433" locator="240:12-240:42" resultTypeName="t:Boolean" xsi:type="Is">
                        <operand localId="431" locator="240:12-240:30" path="abatement" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <source localId="430" locator="240:12-240:20" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                        </operand>
                        <isTypeSpecifier localId="432" locator="240:35-240:42" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                     </condition>
                     <then xsi:type="Interval">
                        <low xsi:type="ToDateTime">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <operand path="low" xsi:type="Property">
                              <source localId="458" locator="241:5-242:110" lowClosed="true" highClosed="false" xsi:type="Interval">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <low localId="444" locator="241:14-241:108" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="437" locator="241:14-241:50" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="436" locator="241:33-241:49" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                          <source localId="435" locator="241:33-241:39" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                       </operand>
                                    </operand>
                                    <operand localId="443" locator="241:54-241:108" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="442" locator="241:77-241:107" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                          <operand localId="440" locator="241:77-241:95" path="abatement" xsi:type="Property">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <source localId="439" locator="241:77-241:85" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="441" locator="241:100-241:107" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                       </operand>
                                    </operand>
                                 </low>
                                 <high localId="457" locator="242:6-242:109" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="455" locator="242:6-242:100" resultTypeName="t:Date" xsi:type="Add">
                                       <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                       <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="448" locator="242:6-242:42" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="447" locator="242:25-242:41" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                             <source localId="446" locator="242:25-242:31" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                          </operand>
                                       </operand>
                                       <operand localId="454" locator="242:46-242:100" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="453" locator="242:69-242:99" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                             <operand localId="451" locator="242:69-242:87" path="abatement" xsi:type="Property">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <source localId="450" locator="242:69-242:77" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="452" locator="242:92-242:99" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          </operand>
                                       </operand>
                                    </operand>
                                    <operand localId="456" locator="242:104-242:109" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                                 </high>
                              </source>
                           </operand>
                        </low>
                        <lowClosedExpression path="lowClosed" xsi:type="Property">
                           <source localId="458" locator="241:5-242:110" lowClosed="true" highClosed="false" xsi:type="Interval">
                              <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <low localId="444" locator="241:14-241:108" resultTypeName="t:Date" xsi:type="Add">
                                 <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="437" locator="241:14-241:50" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="436" locator="241:33-241:49" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                       <source localId="435" locator="241:33-241:39" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                    </operand>
                                 </operand>
                                 <operand localId="443" locator="241:54-241:108" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="442" locator="241:77-241:107" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                       <operand localId="440" locator="241:77-241:95" path="abatement" xsi:type="Property">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                          </resultTypeSpecifier>
                                          <source localId="439" locator="241:77-241:85" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="441" locator="241:100-241:107" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                    </operand>
                                 </operand>
                              </low>
                              <high localId="457" locator="242:6-242:109" resultTypeName="t:Date" xsi:type="Add">
                                 <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="455" locator="242:6-242:100" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="448" locator="242:6-242:42" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="447" locator="242:25-242:41" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                          <source localId="446" locator="242:25-242:31" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                       </operand>
                                    </operand>
                                    <operand localId="454" locator="242:46-242:100" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="453" locator="242:69-242:99" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                          <operand localId="451" locator="242:69-242:87" path="abatement" xsi:type="Property">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <source localId="450" locator="242:69-242:77" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="452" locator="242:92-242:99" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                       </operand>
                                    </operand>
                                 </operand>
                                 <operand localId="456" locator="242:104-242:109" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                              </high>
                           </source>
                        </lowClosedExpression>
                        <high xsi:type="ToDateTime">
                           <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                           <operand path="high" xsi:type="Property">
                              <source localId="458" locator="241:5-242:110" lowClosed="true" highClosed="false" xsi:type="Interval">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <low localId="444" locator="241:14-241:108" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="437" locator="241:14-241:50" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="436" locator="241:33-241:49" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                          <source localId="435" locator="241:33-241:39" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                       </operand>
                                    </operand>
                                    <operand localId="443" locator="241:54-241:108" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="442" locator="241:77-241:107" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                          <operand localId="440" locator="241:77-241:95" path="abatement" xsi:type="Property">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <source localId="439" locator="241:77-241:85" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="441" locator="241:100-241:107" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                       </operand>
                                    </operand>
                                 </low>
                                 <high localId="457" locator="242:6-242:109" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="455" locator="242:6-242:100" resultTypeName="t:Date" xsi:type="Add">
                                       <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                       <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="448" locator="242:6-242:42" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="447" locator="242:25-242:41" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                             <source localId="446" locator="242:25-242:31" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                          </operand>
                                       </operand>
                                       <operand localId="454" locator="242:46-242:100" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="453" locator="242:69-242:99" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                             <operand localId="451" locator="242:69-242:87" path="abatement" xsi:type="Property">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <source localId="450" locator="242:69-242:77" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="452" locator="242:92-242:99" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          </operand>
                                       </operand>
                                    </operand>
                                    <operand localId="456" locator="242:104-242:109" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                                 </high>
                              </source>
                           </operand>
                        </high>
                        <highClosedExpression path="highClosed" xsi:type="Property">
                           <source localId="458" locator="241:5-242:110" lowClosed="true" highClosed="false" xsi:type="Interval">
                              <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <low localId="444" locator="241:14-241:108" resultTypeName="t:Date" xsi:type="Add">
                                 <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="437" locator="241:14-241:50" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="436" locator="241:33-241:49" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                       <source localId="435" locator="241:33-241:39" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                    </operand>
                                 </operand>
                                 <operand localId="443" locator="241:54-241:108" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                    <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="442" locator="241:77-241:107" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                       <operand localId="440" locator="241:77-241:95" path="abatement" xsi:type="Property">
                                          <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                             <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                             <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                          </resultTypeSpecifier>
                                          <source localId="439" locator="241:77-241:85" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                       </operand>
                                       <asTypeSpecifier localId="441" locator="241:100-241:107" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                    </operand>
                                 </operand>
                              </low>
                              <high localId="457" locator="242:6-242:109" resultTypeName="t:Date" xsi:type="Add">
                                 <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="455" locator="242:6-242:100" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="448" locator="242:6-242:42" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="447" locator="242:25-242:41" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                          <source localId="446" locator="242:25-242:31" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                       </operand>
                                    </operand>
                                    <operand localId="454" locator="242:46-242:100" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="453" locator="242:69-242:99" resultTypeName="fhir:Age" strict="false" xsi:type="As">
                                          <operand localId="451" locator="242:69-242:87" path="abatement" xsi:type="Property">
                                             <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                             </resultTypeSpecifier>
                                             <source localId="450" locator="242:69-242:77" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                          </operand>
                                          <asTypeSpecifier localId="452" locator="242:92-242:99" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                       </operand>
                                    </operand>
                                 </operand>
                                 <operand localId="456" locator="242:104-242:109" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                              </high>
                           </source>
                        </highClosedExpression>
                     </then>
                     <else localId="503" locator="243:9-248:12" xsi:type="If">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <condition localId="462" locator="243:12-243:44" resultTypeName="t:Boolean" xsi:type="Is">
                           <operand localId="460" locator="243:12-243:30" path="abatement" xsi:type="Property">
                              <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                 <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <source localId="459" locator="243:12-243:20" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                           </operand>
                           <isTypeSpecifier localId="461" locator="243:35-243:44" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                        </condition>
                        <then xsi:type="Interval">
                           <low xsi:type="ToDateTime">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <operand path="low" xsi:type="Property">
                                 <source localId="489" locator="244:6-245:120" lowClosed="true" highClosed="false" xsi:type="Interval">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <low localId="474" locator="244:15-244:117" resultTypeName="t:Date" xsi:type="Add">
                                       <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                       <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="466" locator="244:15-244:51" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="465" locator="244:34-244:50" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                             <source localId="464" locator="244:34-244:40" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                          </operand>
                                       </operand>
                                       <operand localId="473" locator="244:55-244:117" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="472" locator="244:78-244:116" resultTypeName="fhir:SimpleQuantity" path="low" xsi:type="Property">
                                             <source localId="471" locator="244:78-244:112" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                                <operand localId="469" locator="244:79-244:97" path="abatement" xsi:type="Property">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <source localId="468" locator="244:79-244:87" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                                </operand>
                                                <asTypeSpecifier localId="470" locator="244:102-244:111" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                             </source>
                                          </operand>
                                       </operand>
                                    </low>
                                    <high localId="488" locator="245:7-245:119" resultTypeName="t:Date" xsi:type="Add">
                                       <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                       <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="486" locator="245:7-245:110" resultTypeName="t:Date" xsi:type="Add">
                                          <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                          <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="478" locator="245:7-245:43" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                             <operand localId="477" locator="245:26-245:42" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                                <source localId="476" locator="245:26-245:32" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                             </operand>
                                          </operand>
                                          <operand localId="485" locator="245:47-245:110" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <operand localId="484" locator="245:70-245:109" resultTypeName="fhir:SimpleQuantity" path="high" xsi:type="Property">
                                                <source localId="483" locator="245:70-245:104" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                                   <operand localId="481" locator="245:71-245:89" path="abatement" xsi:type="Property">
                                                      <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                         <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                         <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                         <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                         <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                         <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                      </resultTypeSpecifier>
                                                      <source localId="480" locator="245:71-245:79" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                                   </operand>
                                                   <asTypeSpecifier localId="482" locator="245:94-245:103" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                </source>
                                             </operand>
                                          </operand>
                                       </operand>
                                       <operand localId="487" locator="245:114-245:119" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                                    </high>
                                 </source>
                              </operand>
                           </low>
                           <lowClosedExpression path="lowClosed" xsi:type="Property">
                              <source localId="489" locator="244:6-245:120" lowClosed="true" highClosed="false" xsi:type="Interval">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <low localId="474" locator="244:15-244:117" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="466" locator="244:15-244:51" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="465" locator="244:34-244:50" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                          <source localId="464" locator="244:34-244:40" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                       </operand>
                                    </operand>
                                    <operand localId="473" locator="244:55-244:117" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="472" locator="244:78-244:116" resultTypeName="fhir:SimpleQuantity" path="low" xsi:type="Property">
                                          <source localId="471" locator="244:78-244:112" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                             <operand localId="469" locator="244:79-244:97" path="abatement" xsi:type="Property">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <source localId="468" locator="244:79-244:87" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="470" locator="244:102-244:111" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </operand>
                                    </operand>
                                 </low>
                                 <high localId="488" locator="245:7-245:119" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="486" locator="245:7-245:110" resultTypeName="t:Date" xsi:type="Add">
                                       <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                       <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="478" locator="245:7-245:43" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="477" locator="245:26-245:42" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                             <source localId="476" locator="245:26-245:32" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                          </operand>
                                       </operand>
                                       <operand localId="485" locator="245:47-245:110" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="484" locator="245:70-245:109" resultTypeName="fhir:SimpleQuantity" path="high" xsi:type="Property">
                                             <source localId="483" locator="245:70-245:104" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                                <operand localId="481" locator="245:71-245:89" path="abatement" xsi:type="Property">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <source localId="480" locator="245:71-245:79" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                                </operand>
                                                <asTypeSpecifier localId="482" locator="245:94-245:103" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                             </source>
                                          </operand>
                                       </operand>
                                    </operand>
                                    <operand localId="487" locator="245:114-245:119" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                                 </high>
                              </source>
                           </lowClosedExpression>
                           <high xsi:type="ToDateTime">
                              <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                              <operand path="high" xsi:type="Property">
                                 <source localId="489" locator="244:6-245:120" lowClosed="true" highClosed="false" xsi:type="Interval">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <low localId="474" locator="244:15-244:117" resultTypeName="t:Date" xsi:type="Add">
                                       <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                       <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="466" locator="244:15-244:51" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="465" locator="244:34-244:50" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                             <source localId="464" locator="244:34-244:40" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                          </operand>
                                       </operand>
                                       <operand localId="473" locator="244:55-244:117" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="472" locator="244:78-244:116" resultTypeName="fhir:SimpleQuantity" path="low" xsi:type="Property">
                                             <source localId="471" locator="244:78-244:112" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                                <operand localId="469" locator="244:79-244:97" path="abatement" xsi:type="Property">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <source localId="468" locator="244:79-244:87" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                                </operand>
                                                <asTypeSpecifier localId="470" locator="244:102-244:111" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                             </source>
                                          </operand>
                                       </operand>
                                    </low>
                                    <high localId="488" locator="245:7-245:119" resultTypeName="t:Date" xsi:type="Add">
                                       <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                       <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="486" locator="245:7-245:110" resultTypeName="t:Date" xsi:type="Add">
                                          <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                          <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="478" locator="245:7-245:43" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                             <operand localId="477" locator="245:26-245:42" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                                <source localId="476" locator="245:26-245:32" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                             </operand>
                                          </operand>
                                          <operand localId="485" locator="245:47-245:110" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                             <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                             <operand localId="484" locator="245:70-245:109" resultTypeName="fhir:SimpleQuantity" path="high" xsi:type="Property">
                                                <source localId="483" locator="245:70-245:104" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                                   <operand localId="481" locator="245:71-245:89" path="abatement" xsi:type="Property">
                                                      <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                         <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                         <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                         <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                         <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                         <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                      </resultTypeSpecifier>
                                                      <source localId="480" locator="245:71-245:79" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                                   </operand>
                                                   <asTypeSpecifier localId="482" locator="245:94-245:103" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                </source>
                                             </operand>
                                          </operand>
                                       </operand>
                                       <operand localId="487" locator="245:114-245:119" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                                    </high>
                                 </source>
                              </operand>
                           </high>
                           <highClosedExpression path="highClosed" xsi:type="Property">
                              <source localId="489" locator="244:6-245:120" lowClosed="true" highClosed="false" xsi:type="Interval">
                                 <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <low localId="474" locator="244:15-244:117" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="466" locator="244:15-244:51" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="465" locator="244:34-244:50" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                          <source localId="464" locator="244:34-244:40" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                       </operand>
                                    </operand>
                                    <operand localId="473" locator="244:55-244:117" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                       <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="472" locator="244:78-244:116" resultTypeName="fhir:SimpleQuantity" path="low" xsi:type="Property">
                                          <source localId="471" locator="244:78-244:112" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                             <operand localId="469" locator="244:79-244:97" path="abatement" xsi:type="Property">
                                                <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                   <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                   <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                </resultTypeSpecifier>
                                                <source localId="468" locator="244:79-244:87" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                             </operand>
                                             <asTypeSpecifier localId="470" locator="244:102-244:111" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          </source>
                                       </operand>
                                    </operand>
                                 </low>
                                 <high localId="488" locator="245:7-245:119" resultTypeName="t:Date" xsi:type="Add">
                                    <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                    <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                    <operand localId="486" locator="245:7-245:110" resultTypeName="t:Date" xsi:type="Add">
                                       <signature name="t:Date" xsi:type="NamedTypeSpecifier"/>
                                       <signature name="t:Quantity" xsi:type="NamedTypeSpecifier"/>
                                       <operand localId="478" locator="245:7-245:43" resultTypeName="t:Date" name="ToDate" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="477" locator="245:26-245:42" resultTypeName="fhir:date" path="birthDate" xsi:type="Property">
                                             <source localId="476" locator="245:26-245:32" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                                          </operand>
                                       </operand>
                                       <operand localId="485" locator="245:47-245:110" resultTypeName="t:Quantity" name="ToQuantity" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                          <signature name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                                          <operand localId="484" locator="245:70-245:109" resultTypeName="fhir:SimpleQuantity" path="high" xsi:type="Property">
                                             <source localId="483" locator="245:70-245:104" resultTypeName="fhir:Range" strict="false" xsi:type="As">
                                                <operand localId="481" locator="245:71-245:89" path="abatement" xsi:type="Property">
                                                   <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                                      <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                                      <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                                   </resultTypeSpecifier>
                                                   <source localId="480" locator="245:71-245:79" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                                </operand>
                                                <asTypeSpecifier localId="482" locator="245:94-245:103" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                             </source>
                                          </operand>
                                       </operand>
                                    </operand>
                                    <operand localId="487" locator="245:114-245:119" resultTypeName="t:Quantity" value="1" unit="year" xsi:type="Quantity"/>
                                 </high>
                              </source>
                           </highClosedExpression>
                        </then>
                        <else localId="502" locator="246:9-248:12" xsi:type="If">
                           <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                              <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <condition localId="493" locator="246:12-246:46" resultTypeName="t:Boolean" xsi:type="Is">
                              <operand localId="491" locator="246:12-246:30" path="abatement" xsi:type="Property">
                                 <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                    <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                    <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                    <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                    <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                    <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                 </resultTypeSpecifier>
                                 <source localId="490" locator="246:12-246:20" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                              </operand>
                              <isTypeSpecifier localId="492" locator="246:35-246:46" resultTypeName="fhir:boolean" name="fhir:boolean" xsi:type="NamedTypeSpecifier"/>
                           </condition>
                           <then localId="500" locator="247:6-247:83" lowClosed="true" highClosed="false" xsi:type="Interval">
                              <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <low localId="497" locator="247:15-247:58" resultTypeName="t:DateTime" xsi:type="End">
                                 <signature xsi:type="IntervalTypeSpecifier">
                                    <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                 </signature>
                                 <operand localId="496" locator="247:22-247:58" name="Normalize Interval" xsi:type="FunctionRef">
                                    <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                       <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                                    </resultTypeSpecifier>
                                    <signature xsi:type="ChoiceTypeSpecifier">
                                       <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                       <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                    </signature>
                                    <operand localId="495" locator="247:43-247:57" path="onset" xsi:type="Property">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                       <source localId="494" locator="247:43-247:51" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                    </operand>
                                 </operand>
                              </low>
                              <high name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <signature name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                 <operand localId="499" locator="247:61-247:82" resultTypeName="fhir:dateTime" path="recordedDate" xsi:type="Property">
                                    <source localId="498" locator="247:61-247:69" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                                 </operand>
                              </high>
                           </then>
                           <else xsi:type="As">
                              <operand localId="501" locator="248:9-248:12" resultTypeName="t:Any" xsi:type="Null"/>
                              <asTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </asTypeSpecifier>
                           </else>
                        </else>
                     </else>
                  </else>
               </else>
            </else>
         </expression>
         <operand name="condition">
            <operandTypeSpecifier localId="389" locator="233:49-233:57" resultTypeName="fhir:Condition" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="541" locator="258:1-264:101" name="Prevalence Period" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="541">
               <a:s>/*Returns an interval representing the period during which the condition was prevalent (i.e. onset to abatement)
If the condition is &quot;active&quot;, then abatement being unknown
would indicate the condition is ongoing, and the ending boundary of the prevalence
period is inclusive, otherwise, the abatement is considered unknown and the ending boundary
of the prevalence period is exclusive.
Note that when using this function it should be noted that many clinical systems
do not actually capture abatement, so care should be taken when using this function
to meet clinical intent.*/
define function &quot;Prevalence Period&quot;(condition </a:s>
               <a:s r="509">
                  <a:s>Condition</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="540">
                  <a:s r="540">
                     <a:s>if </a:s>
                     <a:s r="523">
                        <a:s r="518">
                           <a:s r="513">
                              <a:s r="511">
                                 <a:s r="510">
                                    <a:s>condition</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="511">
                                    <a:s>clinicalStatus</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> ~ </a:s>
                              <a:s r="512">
                                 <a:s>&quot;active&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    or </a:s>
                           <a:s r="517">
                              <a:s r="515">
                                 <a:s r="514">
                                    <a:s>condition</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="515">
                                    <a:s>clinicalStatus</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> ~ </a:s>
                              <a:s r="516">
                                 <a:s>&quot;recurrence&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
    or </a:s>
                        <a:s r="522">
                           <a:s r="520">
                              <a:s r="519">
                                 <a:s>condition</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="520">
                                 <a:s>clinicalStatus</a:s>
                              </a:s>
                           </a:s>
                           <a:s> ~ </a:s>
                           <a:s r="521">
                              <a:s>&quot;relapse&quot;</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s> then
    </a:s>
                     <a:s r="531">
                        <a:s>Interval[</a:s>
                        <a:s r="527">
                           <a:s>start of </a:s>
                           <a:s r="526">
                              <a:s>&quot;Normalize Interval&quot;(</a:s>
                              <a:s r="525">
                                 <a:s r="524">
                                    <a:s>condition</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="525">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="530">
                           <a:s>end of </a:s>
                           <a:s r="529">
                              <a:s>&quot;Normalize Abatement&quot;(</a:s>
                              <a:s r="528">
                                 <a:s>condition</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>]</a:s>
                     </a:s>
                     <a:s>
  else
    </a:s>
                     <a:s r="539">
                        <a:s>Interval[</a:s>
                        <a:s r="535">
                           <a:s>start of </a:s>
                           <a:s r="534">
                              <a:s>&quot;Normalize Interval&quot;(</a:s>
                              <a:s r="533">
                                 <a:s r="532">
                                    <a:s>condition</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="533">
                                    <a:s>onset</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="538">
                           <a:s>end of </a:s>
                           <a:s r="537">
                              <a:s>&quot;Normalize Abatement&quot;(</a:s>
                              <a:s r="536">
                                 <a:s>condition</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
            <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="540" locator="259:3-264:101" xsi:type="If">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <condition localId="523" locator="259:6-261:43" resultTypeName="t:Boolean" xsi:type="Or">
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <operand localId="518" locator="259:6-260:46" resultTypeName="t:Boolean" xsi:type="Or">
                  <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="513" locator="259:6-259:40" resultTypeName="t:Boolean" xsi:type="Equivalent">
                     <signature name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <operand name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="511" locator="259:6-259:29" resultTypeName="fhir:CodeableConcept" path="clinicalStatus" xsi:type="Property">
                           <source localId="510" locator="259:6-259:14" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                        </operand>
                     </operand>
                     <operand xsi:type="ToConcept">
                        <signature name="t:Code" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="512" locator="259:33-259:40" resultTypeName="t:Code" name="active" xsi:type="CodeRef"/>
                     </operand>
                  </operand>
                  <operand localId="517" locator="260:8-260:46" resultTypeName="t:Boolean" xsi:type="Equivalent">
                     <signature name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                     <operand name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="515" locator="260:8-260:31" resultTypeName="fhir:CodeableConcept" path="clinicalStatus" xsi:type="Property">
                           <source localId="514" locator="260:8-260:16" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                        </operand>
                     </operand>
                     <operand xsi:type="ToConcept">
                        <signature name="t:Code" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="516" locator="260:35-260:46" resultTypeName="t:Code" name="recurrence" xsi:type="CodeRef"/>
                     </operand>
                  </operand>
               </operand>
               <operand localId="522" locator="261:8-261:43" resultTypeName="t:Boolean" xsi:type="Equivalent">
                  <signature name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:Concept" xsi:type="NamedTypeSpecifier"/>
                  <operand name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="520" locator="261:8-261:31" resultTypeName="fhir:CodeableConcept" path="clinicalStatus" xsi:type="Property">
                        <source localId="519" locator="261:8-261:16" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                     </operand>
                  </operand>
                  <operand xsi:type="ToConcept">
                     <signature name="t:Code" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="521" locator="261:35-261:43" resultTypeName="t:Code" name="relapse" xsi:type="CodeRef"/>
                  </operand>
               </operand>
            </condition>
            <then localId="531" locator="262:5-262:101" lowClosed="true" highClosed="true" xsi:type="Interval">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <low localId="527" locator="262:14-262:59" resultTypeName="t:DateTime" xsi:type="Start">
                  <signature xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="526" locator="262:23-262:59" name="Normalize Interval" xsi:type="FunctionRef">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <signature xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="525" locator="262:44-262:58" path="onset" xsi:type="Property">
                        <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                           <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="524" locator="262:44-262:52" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                     </operand>
                  </operand>
               </low>
               <high localId="530" locator="262:62-262:100" resultTypeName="t:DateTime" xsi:type="End">
                  <signature xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="529" locator="262:69-262:100" name="Normalize Abatement" xsi:type="FunctionRef">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <signature name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="528" locator="262:91-262:99" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                  </operand>
               </high>
            </then>
            <else localId="539" locator="264:5-264:101" lowClosed="true" highClosed="false" xsi:type="Interval">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <low localId="535" locator="264:14-264:59" resultTypeName="t:DateTime" xsi:type="Start">
                  <signature xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="534" locator="264:23-264:59" name="Normalize Interval" xsi:type="FunctionRef">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <signature xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="533" locator="264:44-264:58" path="onset" xsi:type="Property">
                        <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                           <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                           <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="532" locator="264:44-264:52" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                     </operand>
                  </operand>
               </low>
               <high localId="538" locator="264:62-264:100" resultTypeName="t:DateTime" xsi:type="End">
                  <signature xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="537" locator="264:69-264:100" name="Normalize Abatement" xsi:type="FunctionRef">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <signature name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="536" locator="264:91-264:99" resultTypeName="fhir:Condition" name="condition" xsi:type="OperandRef"/>
                  </operand>
               </high>
            </else>
         </expression>
         <operand name="condition">
            <operandTypeSpecifier localId="509" locator="258:47-258:55" resultTypeName="fhir:Condition" name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="547" locator="267:1-268:23" resultTypeName="t:String" name="GetId" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="547">
               <a:s>/*Returns the tail of the given uri (i.e. everything after the last slash in the URI).*/
define function &quot;GetId&quot;(uri </a:s>
               <a:s r="542">
                  <a:s>String</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="546">
                  <a:s r="546">
                     <a:s>Last(</a:s>
                     <a:s r="545">
                        <a:s>Split(</a:s>
                        <a:s r="543">
                           <a:s>uri</a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="544">
                           <a:s>'/'</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="546" locator="268:3-268:23" resultTypeName="t:String" xsi:type="Last">
            <signature xsi:type="ListTypeSpecifier">
               <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <source localId="545" locator="268:8-268:22" xsi:type="Split">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <stringToSplit localId="543" locator="268:14-268:16" resultTypeName="t:String" name="uri" xsi:type="OperandRef"/>
               <separator localId="544" locator="268:19-268:21" resultTypeName="t:String" valueType="t:String" value="/" xsi:type="Literal"/>
            </source>
         </expression>
         <operand name="uri">
            <operandTypeSpecifier localId="542" locator="267:29-267:34" resultTypeName="t:String" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="564" locator="271:1-273:85" name="EncounterDiagnosis" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="564">
               <a:s>/*Returns the Condition resources referenced by the diagnosis element of the Encounter*/
define function &quot;EncounterDiagnosis&quot;(Encounter </a:s>
               <a:s r="548">
                  <a:s>Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="563">
                  <a:s r="563">
                     <a:s>
                        <a:s r="550">
                           <a:s r="549">
                              <a:s>
                                 <a:s>Encounter.diagnosis</a:s>
                              </a:s>
                           </a:s>
                           <a:s> D</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="562">
                        <a:s>return </a:s>
                        <a:s r="561">
                           <a:s>singleton from </a:s>
                           <a:s r="560">
                              <a:s>(</a:s>
                              <a:s r="560">
                                 <a:s>
                                    <a:s r="552">
                                       <a:s r="551">
                                          <a:s r="551">
                                             <a:s>[Condition]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> C</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="559">
                                    <a:s>where </a:s>
                                    <a:s r="559">
                                       <a:s r="554">
                                          <a:s r="553">
                                             <a:s>C</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="554">
                                             <a:s>id</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> = </a:s>
                                       <a:s r="558">
                                          <a:s>&quot;GetId&quot;(</a:s>
                                          <a:s r="557">
                                             <a:s r="556">
                                                <a:s r="555">
                                                   <a:s>D</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="556">
                                                   <a:s>condition</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="557">
                                                <a:s>reference</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="563" locator="272:3-273:85" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="550" locator="272:3-272:23" alias="D">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Encounter.Diagnosis" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="549" locator="272:3-272:21" path="diagnosis" xsi:type="Property">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter.Diagnosis" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source name="Encounter" xsi:type="OperandRef"/>
               </expression>
            </source>
            <return localId="562" locator="273:5-273:85">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="561" locator="273:12-273:85" resultTypeName="fhir:Condition" xsi:type="SingletonFrom">
                  <signature xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="560" locator="273:27-273:85" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="552" locator="273:28-273:40" alias="C">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="551" locator="273:28-273:38" dataType="fhir:Condition" templateId="http://hl7.org/fhir/StructureDefinition/Condition" xsi:type="Retrieve">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </expression>
                     </source>
                     <where localId="559" locator="273:42-273:84" resultTypeName="t:Boolean" xsi:type="Equal">
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <signature name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="554" locator="273:48-273:51" resultTypeName="fhir:id" path="id" scope="C" xsi:type="Property"/>
                        </operand>
                        <operand localId="558" locator="273:55-273:84" resultTypeName="t:String" name="GetId" xsi:type="FunctionRef">
                           <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="557" locator="273:63-273:83" resultTypeName="fhir:string" path="reference" xsi:type="Property">
                                 <source localId="556" locator="273:63-273:73" resultTypeName="fhir:Reference" path="condition" scope="D" xsi:type="Property"/>
                              </operand>
                           </operand>
                        </operand>
                     </where>
                  </operand>
               </expression>
            </return>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="548" locator="271:48-271:56" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="576" locator="275:1-276:74" resultTypeName="fhir:Condition" name="GetCondition" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="576">
               <a:s>define function &quot;GetCondition&quot;(reference </a:s>
               <a:s r="565">
                  <a:s>Reference</a:s>
               </a:s>
               <a:s>):
  </a:s>
               <a:s r="575">
                  <a:s r="575">
                     <a:s>singleton from </a:s>
                     <a:s r="574">
                        <a:s>(</a:s>
                        <a:s r="574">
                           <a:s>
                              <a:s r="567">
                                 <a:s r="566">
                                    <a:s r="566">
                                       <a:s>[Condition]</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> C</a:s>
                              </a:s>
                           </a:s>
                           <a:s> </a:s>
                           <a:s r="573">
                              <a:s>where </a:s>
                              <a:s r="573">
                                 <a:s r="569">
                                    <a:s r="568">
                                       <a:s>C</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="569">
                                       <a:s>id</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="572">
                                    <a:s>&quot;GetId&quot;(</a:s>
                                    <a:s r="571">
                                       <a:s r="570">
                                          <a:s>reference</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="571">
                                          <a:s>reference</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="575" locator="276:3-276:74" resultTypeName="fhir:Condition" xsi:type="SingletonFrom">
            <signature xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="574" locator="276:18-276:74" xsi:type="Query">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <source localId="567" locator="276:19-276:31" alias="C">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <expression localId="566" locator="276:19-276:29" dataType="fhir:Condition" templateId="http://hl7.org/fhir/StructureDefinition/Condition" xsi:type="Retrieve">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </expression>
               </source>
               <where localId="573" locator="276:33-276:73" resultTypeName="t:Boolean" xsi:type="Equal">
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="569" locator="276:39-276:42" resultTypeName="fhir:id" path="id" scope="C" xsi:type="Property"/>
                  </operand>
                  <operand localId="572" locator="276:46-276:73" resultTypeName="t:String" name="GetId" xsi:type="FunctionRef">
                     <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="571" locator="276:54-276:72" resultTypeName="fhir:string" path="reference" xsi:type="Property">
                           <source localId="570" locator="276:54-276:62" resultTypeName="fhir:Reference" name="reference" xsi:type="OperandRef"/>
                        </operand>
                     </operand>
                  </operand>
               </where>
            </operand>
         </expression>
         <operand name="reference">
            <operandTypeSpecifier localId="565" locator="275:42-275:50" resultTypeName="fhir:Reference" name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="597" locator="297:1-300:12" name="GetExtensions" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="597">
               <a:s>/*NOTE: Extensions are not the preferred approach, but are used as a way to access
content that is defined by extensions but not yet surfaced in the
CQL model info.*/
define function &quot;GetExtensions&quot;(domainResource </a:s>
               <a:s r="584">
                  <a:s>DomainResource</a:s>
               </a:s>
               <a:s>, url </a:s>
               <a:s r="585">
                  <a:s>String</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="596">
                  <a:s r="596">
                     <a:s>
                        <a:s r="587">
                           <a:s r="586">
                              <a:s>
                                 <a:s>domainResource.extension</a:s>
                              </a:s>
                           </a:s>
                           <a:s> E</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	  </a:s>
                     <a:s r="593">
                        <a:s>where </a:s>
                        <a:s r="593">
                           <a:s r="589">
                              <a:s r="588">
                                 <a:s>E</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="589">
                                 <a:s>url</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="592">
                              <a:s>(</a:s>
                              <a:s r="592">
                                 <a:s r="590">
                                    <a:s>'http://hl7.org/fhir/us/qicore/StructureDefinition/'</a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="591">
                                    <a:s>url</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="595">
                        <a:s>return </a:s>
                        <a:s r="594">
                           <a:s>E</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="596" locator="298:3-300:12" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="587" locator="298:3-298:28" alias="E">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="586" locator="298:3-298:26" path="extension" xsi:type="Property">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source name="domainResource" xsi:type="OperandRef"/>
               </expression>
            </source>
            <where localId="593" locator="299:6-299:79" resultTypeName="t:Boolean" xsi:type="Equal">
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                  <signature name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="589" locator="299:12-299:16" resultTypeName="fhir:uri" path="url" scope="E" xsi:type="Property"/>
               </operand>
               <operand localId="592" locator="299:20-299:79" resultTypeName="t:String" xsi:type="Concatenate">
                  <operand localId="590" locator="299:21-299:72" resultTypeName="t:String" valueType="t:String" value="http://hl7.org/fhir/us/qicore/StructureDefinition/" xsi:type="Literal"/>
                  <operand localId="591" locator="299:76-299:78" resultTypeName="t:String" name="url" xsi:type="OperandRef"/>
               </operand>
            </where>
            <return localId="595" locator="300:5-300:12">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="594" locator="300:12" resultTypeName="fhir:Extension" name="E" xsi:type="AliasRef"/>
            </return>
         </expression>
         <operand name="domainResource">
            <operandTypeSpecifier localId="584" locator="297:48-297:61" resultTypeName="fhir:DomainResource" name="fhir:DomainResource" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="url">
            <operandTypeSpecifier localId="585" locator="297:68-297:73" resultTypeName="t:String" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="609" locator="308:1-311:12" name="GetExtensions" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="609">
               <a:s>/*NOTE: Extensions are not the preferred approach, but are used as a way to access
content that is defined by extensions but not yet surfaced in the
CQL model info.*/
define function &quot;GetExtensions&quot;(element </a:s>
               <a:s r="598">
                  <a:s>Element</a:s>
               </a:s>
               <a:s>, url </a:s>
               <a:s r="599">
                  <a:s>String</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="608">
                  <a:s r="608">
                     <a:s>
                        <a:s r="601">
                           <a:s r="600">
                              <a:s>
                                 <a:s>element.extension</a:s>
                              </a:s>
                           </a:s>
                           <a:s> E</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	  </a:s>
                     <a:s r="605">
                        <a:s>where </a:s>
                        <a:s r="605">
                           <a:s r="603">
                              <a:s r="602">
                                 <a:s>E</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="603">
                                 <a:s>url</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="604">
                              <a:s>(</a:s>
                              <a:s r="604">
                                 <a:s>url</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="607">
                        <a:s>return </a:s>
                        <a:s r="606">
                           <a:s>E</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="608" locator="309:3-311:12" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="601" locator="309:3-309:21" alias="E">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="600" locator="309:3-309:19" path="extension" xsi:type="Property">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source name="element" xsi:type="OperandRef"/>
               </expression>
            </source>
            <where localId="605" locator="310:6-310:24" resultTypeName="t:Boolean" xsi:type="Equal">
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                  <signature name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="603" locator="310:12-310:16" resultTypeName="fhir:uri" path="url" scope="E" xsi:type="Property"/>
               </operand>
               <operand localId="604" locator="310:20-310:24" resultTypeName="t:String" name="url" xsi:type="OperandRef"/>
            </where>
            <return localId="607" locator="311:5-311:12">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="606" locator="311:12" resultTypeName="fhir:Extension" name="E" xsi:type="AliasRef"/>
            </return>
         </expression>
         <operand name="element">
            <operandTypeSpecifier localId="598" locator="308:41-308:47" resultTypeName="fhir:Element" name="fhir:Element" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="url">
            <operandTypeSpecifier localId="599" locator="308:54-308:59" resultTypeName="t:String" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="612" locator="302:1-303:53" resultTypeName="fhir:Extension" name="GetExtension" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="612">
               <a:s>define function &quot;GetExtension&quot;(domainResource </a:s>
               <a:s r="580">
                  <a:s>DomainResource</a:s>
               </a:s>
               <a:s>, url </a:s>
               <a:s r="581">
                  <a:s>String</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="611">
                  <a:s r="611">
                     <a:s>singleton from </a:s>
                     <a:s r="610">
                        <a:s>&quot;GetExtensions&quot;(</a:s>
                        <a:s r="582">
                           <a:s>domainResource</a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="583">
                           <a:s>url</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="611" locator="303:3-303:53" resultTypeName="fhir:Extension" xsi:type="SingletonFrom">
            <signature xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="610" locator="303:18-303:53" name="GetExtensions" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <signature name="fhir:DomainResource" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="582" locator="303:34-303:47" resultTypeName="fhir:DomainResource" name="domainResource" xsi:type="OperandRef"/>
               <operand localId="583" locator="303:50-303:52" resultTypeName="t:String" name="url" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="domainResource">
            <operandTypeSpecifier localId="580" locator="302:47-302:60" resultTypeName="fhir:DomainResource" name="fhir:DomainResource" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="url">
            <operandTypeSpecifier localId="581" locator="302:67-302:72" resultTypeName="t:String" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="619" locator="313:1-314:46" resultTypeName="fhir:Extension" name="GetExtension" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="619">
               <a:s>define function &quot;GetExtension&quot;(element </a:s>
               <a:s r="613">
                  <a:s>Element</a:s>
               </a:s>
               <a:s>, url </a:s>
               <a:s r="614">
                  <a:s>String</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="618">
                  <a:s r="618">
                     <a:s>singleton from </a:s>
                     <a:s r="617">
                        <a:s>&quot;GetExtensions&quot;(</a:s>
                        <a:s r="615">
                           <a:s>element</a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="616">
                           <a:s>url</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="618" locator="314:3-314:46" resultTypeName="fhir:Extension" xsi:type="SingletonFrom">
            <signature xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="617" locator="314:18-314:46" name="GetExtensions" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <signature name="fhir:Element" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="615" locator="314:34-314:40" resultTypeName="fhir:Element" name="element" xsi:type="OperandRef"/>
               <operand localId="616" locator="314:43-314:45" resultTypeName="t:String" name="url" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="element">
            <operandTypeSpecifier localId="613" locator="313:40-313:46" resultTypeName="fhir:Element" name="fhir:Element" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="url">
            <operandTypeSpecifier localId="614" locator="313:53-313:58" resultTypeName="t:String" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="624" locator="278:1-279:151" resultTypeName="fhir:CodeableConcept" name="PresentOnAdmissionIndicator" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="624">
               <a:s>define function &quot;PresentOnAdmissionIndicator&quot;(element </a:s>
               <a:s r="577">
                  <a:s>Element</a:s>
               </a:s>
               <a:s>):
  </a:s>
               <a:s r="623">
                  <a:s r="623">
                     <a:s r="621">
                        <a:s r="620">
                           <a:s>GetExtension(</a:s>
                           <a:s r="578">
                              <a:s>element</a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="579">
                              <a:s>'http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter-diagnosisPresentOnAdmission'</a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="621">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s> as </a:s>
                     <a:s r="622">
                        <a:s>FHIR.CodeableConcept</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="623" locator="279:3-279:151" resultTypeName="fhir:CodeableConcept" strict="false" xsi:type="As">
            <operand localId="621" locator="279:3-279:127" path="value" xsi:type="Property">
               <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="fhir:base64Binary" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:boolean" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:canonical" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:code" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:decimal" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:integer" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:markdown" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:oid" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:positiveInt" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:time" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:unsignedInt" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:url" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:uuid" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Address" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Annotation" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Attachment" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Coding" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:ContactPoint" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Count" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Distance" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Duration" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:HumanName" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Identifier" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Money" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Ratio" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:SampledData" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Signature" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:ContactDetail" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Contributor" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:DataRequirement" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Expression" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:ParameterDefinition" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:RelatedArtifact" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:TriggerDefinition" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:UsageContext" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Dosage" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Meta" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <source localId="620" locator="279:3-279:121" resultTypeName="fhir:Extension" name="GetExtension" xsi:type="FunctionRef">
                  <signature name="fhir:Element" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="578" locator="279:16-279:22" resultTypeName="fhir:Element" name="element" xsi:type="OperandRef"/>
                  <operand localId="579" locator="279:25-279:120" resultTypeName="t:String" valueType="t:String" value="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter-diagnosisPresentOnAdmission" xsi:type="Literal"/>
               </source>
            </operand>
            <asTypeSpecifier localId="622" locator="279:132-279:151" resultTypeName="fhir:CodeableConcept" name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
         </expression>
         <operand name="element">
            <operandTypeSpecifier localId="577" locator="278:55-278:61" resultTypeName="fhir:Element" name="fhir:Element" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="650" locator="283:1-285:86" resultTypeName="fhir:Condition" name="PrincipalDiagnosis" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="650">
               <a:s>// Returns the condition that is specified as the principal diagnosis for the encounter
// TODO: BTR 2019-07-30: Shouldn't need the FHIRHelpers reference here, investigate
define function &quot;PrincipalDiagnosis&quot;(Encounter </a:s>
               <a:s r="625">
                  <a:s>Encounter</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="649">
                  <a:s r="649">
                     <a:s>
                        <a:s r="636">
                           <a:s r="635">
                              <a:s>(</a:s>
                              <a:s r="635">
                                 <a:s>singleton from </a:s>
                                 <a:s r="634">
                                    <a:s>(</a:s>
                                    <a:s r="634">
                                       <a:s>
                                          <a:s r="627">
                                             <a:s r="626">
                                                <a:s>
                                                   <a:s>Encounter.diagnosis</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> D</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="633">
                                          <a:s>where </a:s>
                                          <a:s r="633">
                                             <a:s r="631">
                                                <a:s r="628">
                                                   <a:s>FHIRHelpers</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="631">
                                                   <a:s>ToInteger(</a:s>
                                                   <a:s r="630">
                                                      <a:s r="629">
                                                         <a:s>D</a:s>
                                                      </a:s>
                                                      <a:s>.</a:s>
                                                      <a:s r="630">
                                                         <a:s>rank</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s>)</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s r="632"> = 1</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> PD</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="648">
                        <a:s>return </a:s>
                        <a:s r="647">
                           <a:s>singleton from </a:s>
                           <a:s r="646">
                              <a:s>(</a:s>
                              <a:s r="646">
                                 <a:s>
                                    <a:s r="638">
                                       <a:s r="637">
                                          <a:s r="637">
                                             <a:s>[Condition]</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> C</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="645">
                                    <a:s>where </a:s>
                                    <a:s r="645">
                                       <a:s r="640">
                                          <a:s r="639">
                                             <a:s>C</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="640">
                                             <a:s>id</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> = </a:s>
                                       <a:s r="644">
                                          <a:s>&quot;GetId&quot;(</a:s>
                                          <a:s r="643">
                                             <a:s r="642">
                                                <a:s r="641">
                                                   <a:s>PD</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="642">
                                                   <a:s>condition</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="643">
                                                <a:s>reference</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>)</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="649" locator="284:3-285:86" resultTypeName="fhir:Condition" xsi:type="Query">
            <source localId="636" locator="284:3-284:85" resultTypeName="fhir:Encounter.Diagnosis" alias="PD">
               <expression localId="635" locator="284:3-284:82" resultTypeName="fhir:Encounter.Diagnosis" xsi:type="SingletonFrom">
                  <signature xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Encounter.Diagnosis" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="634" locator="284:19-284:81" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Encounter.Diagnosis" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="627" locator="284:20-284:40" alias="D">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Encounter.Diagnosis" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="626" locator="284:20-284:38" path="diagnosis" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Encounter.Diagnosis" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <source name="Encounter" xsi:type="OperandRef"/>
                        </expression>
                     </source>
                     <where localId="633" locator="284:42-284:80" resultTypeName="t:Boolean" xsi:type="Equal">
                        <signature name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                        <signature name="t:Integer" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="631" locator="284:48-284:76" resultTypeName="t:Integer" name="ToInteger" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <signature name="fhir:integer" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="630" locator="284:70-284:75" resultTypeName="fhir:positiveInt" path="rank" scope="D" xsi:type="Property"/>
                        </operand>
                        <operand localId="632" locator="284:80" resultTypeName="t:Integer" valueType="t:Integer" value="1" xsi:type="Literal"/>
                     </where>
                  </operand>
               </expression>
            </source>
            <return localId="648" locator="285:5-285:86" resultTypeName="fhir:Condition">
               <expression localId="647" locator="285:12-285:86" resultTypeName="fhir:Condition" xsi:type="SingletonFrom">
                  <signature xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="646" locator="285:27-285:86" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="638" locator="285:28-285:40" alias="C">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="637" locator="285:28-285:38" dataType="fhir:Condition" templateId="http://hl7.org/fhir/StructureDefinition/Condition" xsi:type="Retrieve">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </expression>
                     </source>
                     <where localId="645" locator="285:42-285:85" resultTypeName="t:Boolean" xsi:type="Equal">
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <signature name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="640" locator="285:48-285:51" resultTypeName="fhir:id" path="id" scope="C" xsi:type="Property"/>
                        </operand>
                        <operand localId="644" locator="285:55-285:85" resultTypeName="t:String" name="GetId" xsi:type="FunctionRef">
                           <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="643" locator="285:63-285:84" resultTypeName="fhir:string" path="reference" xsi:type="Property">
                                 <source localId="642" locator="285:63-285:74" resultTypeName="fhir:Reference" path="condition" scope="PD" xsi:type="Property"/>
                              </operand>
                           </operand>
                        </operand>
                     </where>
                  </operand>
               </expression>
            </return>
         </expression>
         <operand name="Encounter">
            <operandTypeSpecifier localId="625" locator="283:48-283:56" resultTypeName="fhir:Encounter" name="fhir:Encounter" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="662" locator="289:1-292:3" resultTypeName="fhir:Location" name="GetLocation" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="662">
               <a:s>// Returns the location for the given location reference

/*Returns the Location resource specified by the given reference*/
define function &quot;GetLocation&quot;(reference </a:s>
               <a:s r="651">
                  <a:s>Reference</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="661">
                  <a:s r="661">
                     <a:s>singleton from </a:s>
                     <a:s r="660">
                        <a:s>(
    </a:s>
                        <a:s r="660">
                           <a:s>
                              <a:s r="653">
                                 <a:s r="652">
                                    <a:s r="652">
                                       <a:s>[Location]</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> L</a:s>
                              </a:s>
                           </a:s>
                           <a:s> </a:s>
                           <a:s r="659">
                              <a:s>where </a:s>
                              <a:s r="659">
                                 <a:s r="655">
                                    <a:s r="654">
                                       <a:s>L</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="655">
                                       <a:s>id</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> = </a:s>
                                 <a:s r="658">
                                    <a:s>GetId(</a:s>
                                    <a:s r="657">
                                       <a:s r="656">
                                          <a:s>reference</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="657">
                                          <a:s>reference</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="661" locator="290:3-292:3" resultTypeName="fhir:Location" xsi:type="SingletonFrom">
            <signature xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Location" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="660" locator="290:18-292:3" xsi:type="Query">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Location" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <source localId="653" locator="291:5-291:16" alias="L">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Location" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <expression localId="652" locator="291:5-291:14" dataType="fhir:Location" templateId="http://hl7.org/fhir/StructureDefinition/Location" xsi:type="Retrieve">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Location" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </expression>
               </source>
               <where localId="659" locator="291:18-291:56" resultTypeName="t:Boolean" xsi:type="Equal">
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="655" locator="291:24-291:27" resultTypeName="fhir:id" path="id" scope="L" xsi:type="Property"/>
                  </operand>
                  <operand localId="658" locator="291:31-291:56" resultTypeName="t:String" name="GetId" xsi:type="FunctionRef">
                     <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                     <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="657" locator="291:37-291:55" resultTypeName="fhir:string" path="reference" xsi:type="Property">
                           <source localId="656" locator="291:37-291:45" resultTypeName="fhir:Reference" name="reference" xsi:type="OperandRef"/>
                        </operand>
                     </operand>
                  </operand>
               </where>
            </operand>
         </expression>
         <operand name="reference">
            <operandTypeSpecifier localId="651" locator="289:41-289:49" resultTypeName="fhir:Reference" name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="688" locator="319:1-322:12" name="GetBaseExtensions" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="688">
               <a:s>/*NOTE: Extensions are not the preferred approach, but are used as a way to access
content that is defined by extensions but not yet surfaced in the
CQL model info.*/
define function &quot;GetBaseExtensions&quot;(domainResource </a:s>
               <a:s r="675">
                  <a:s>DomainResource</a:s>
               </a:s>
               <a:s>, url </a:s>
               <a:s r="676">
                  <a:s>String</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="687">
                  <a:s r="687">
                     <a:s>
                        <a:s r="678">
                           <a:s r="677">
                              <a:s>
                                 <a:s>domainResource.extension</a:s>
                              </a:s>
                           </a:s>
                           <a:s> E</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	  </a:s>
                     <a:s r="684">
                        <a:s>where </a:s>
                        <a:s r="684">
                           <a:s r="680">
                              <a:s r="679">
                                 <a:s>E</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="680">
                                 <a:s>url</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="683">
                              <a:s>(</a:s>
                              <a:s r="683">
                                 <a:s r="681">
                                    <a:s>'http://hl7.org/fhir/StructureDefinition/'</a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="682">
                                    <a:s>url</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="686">
                        <a:s>return </a:s>
                        <a:s r="685">
                           <a:s>E</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="687" locator="320:3-322:12" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="678" locator="320:3-320:28" alias="E">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="677" locator="320:3-320:26" path="extension" xsi:type="Property">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source name="domainResource" xsi:type="OperandRef"/>
               </expression>
            </source>
            <where localId="684" locator="321:6-321:69" resultTypeName="t:Boolean" xsi:type="Equal">
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                  <signature name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="680" locator="321:12-321:16" resultTypeName="fhir:uri" path="url" scope="E" xsi:type="Property"/>
               </operand>
               <operand localId="683" locator="321:20-321:69" resultTypeName="t:String" xsi:type="Concatenate">
                  <operand localId="681" locator="321:21-321:62" resultTypeName="t:String" valueType="t:String" value="http://hl7.org/fhir/StructureDefinition/" xsi:type="Literal"/>
                  <operand localId="682" locator="321:66-321:68" resultTypeName="t:String" name="url" xsi:type="OperandRef"/>
               </operand>
            </where>
            <return localId="686" locator="322:5-322:12">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="685" locator="322:12" resultTypeName="fhir:Extension" name="E" xsi:type="AliasRef"/>
            </return>
         </expression>
         <operand name="domainResource">
            <operandTypeSpecifier localId="675" locator="319:52-319:65" resultTypeName="fhir:DomainResource" name="fhir:DomainResource" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="url">
            <operandTypeSpecifier localId="676" locator="319:72-319:77" resultTypeName="t:String" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="695" locator="324:1-325:57" resultTypeName="fhir:Extension" name="GetBaseExtension" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="695">
               <a:s>define function &quot;GetBaseExtension&quot;(domainResource </a:s>
               <a:s r="689">
                  <a:s>DomainResource</a:s>
               </a:s>
               <a:s>, url </a:s>
               <a:s r="690">
                  <a:s>String</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="694">
                  <a:s r="694">
                     <a:s>singleton from </a:s>
                     <a:s r="693">
                        <a:s>&quot;GetBaseExtensions&quot;(</a:s>
                        <a:s r="691">
                           <a:s>domainResource</a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="692">
                           <a:s>url</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="694" locator="325:3-325:57" resultTypeName="fhir:Extension" xsi:type="SingletonFrom">
            <signature xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="693" locator="325:18-325:57" name="GetBaseExtensions" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <signature name="fhir:DomainResource" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="691" locator="325:38-325:51" resultTypeName="fhir:DomainResource" name="domainResource" xsi:type="OperandRef"/>
               <operand localId="692" locator="325:54-325:56" resultTypeName="t:String" name="url" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="domainResource">
            <operandTypeSpecifier localId="689" locator="324:51-324:64" resultTypeName="fhir:DomainResource" name="fhir:DomainResource" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="url">
            <operandTypeSpecifier localId="690" locator="324:71-324:76" resultTypeName="t:String" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="709" locator="330:1-333:12" name="BaseExtensions" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:t name="description" value="Returns any base-FHIR extensions defined on the given element with the specified id."/>
            <a:t name="description" value="Returns any base-FHIR extensions defined on the given element with the specified id."/>
            <a:t name="comment" value="NOTE: Extensions are not the preferred approach, but are used as a way to access&#xa;content that is defined by extensions but not yet surfaced in the CQL model info."/>
            <a:s r="709">
               <a:s>/*@description: Returns any base-FHIR extensions defined on the given element with the specified id.
@comment: NOTE: Extensions are not the preferred approach, but are used as a way to access
content that is defined by extensions but not yet surfaced in the CQL model info.*/
define function &quot;BaseExtensions&quot;(element </a:s>
               <a:s r="696">
                  <a:s>Element</a:s>
               </a:s>
               <a:s>, id </a:s>
               <a:s r="697">
                  <a:s>String</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="708">
                  <a:s r="708">
                     <a:s>
                        <a:s r="699">
                           <a:s r="698">
                              <a:s>
                                 <a:s>element.extension</a:s>
                              </a:s>
                           </a:s>
                           <a:s> E</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	  </a:s>
                     <a:s r="705">
                        <a:s>where </a:s>
                        <a:s r="705">
                           <a:s r="701">
                              <a:s r="700">
                                 <a:s>E</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="701">
                                 <a:s>url</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="704">
                              <a:s>(</a:s>
                              <a:s r="704">
                                 <a:s r="702">
                                    <a:s>'http://hl7.org/fhir/StructureDefinition/'</a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="703">
                                    <a:s>id</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  		</a:s>
                     <a:s r="707">
                        <a:s>return </a:s>
                        <a:s r="706">
                           <a:s>E</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="708" locator="331:3-333:12" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="699" locator="331:3-331:21" alias="E">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="698" locator="331:3-331:19" path="extension" xsi:type="Property">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source name="element" xsi:type="OperandRef"/>
               </expression>
            </source>
            <where localId="705" locator="332:6-332:68" resultTypeName="t:Boolean" xsi:type="Equal">
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                  <signature name="fhir:uri" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="701" locator="332:12-332:16" resultTypeName="fhir:uri" path="url" scope="E" xsi:type="Property"/>
               </operand>
               <operand localId="704" locator="332:20-332:68" resultTypeName="t:String" xsi:type="Concatenate">
                  <operand localId="702" locator="332:21-332:62" resultTypeName="t:String" valueType="t:String" value="http://hl7.org/fhir/StructureDefinition/" xsi:type="Literal"/>
                  <operand localId="703" locator="332:66-332:67" resultTypeName="t:String" name="id" xsi:type="OperandRef"/>
               </operand>
            </where>
            <return localId="707" locator="333:5-333:12">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="706" locator="333:12" resultTypeName="fhir:Extension" name="E" xsi:type="AliasRef"/>
            </return>
         </expression>
         <operand name="element">
            <operandTypeSpecifier localId="696" locator="330:42-330:48" resultTypeName="fhir:Element" name="fhir:Element" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="id">
            <operandTypeSpecifier localId="697" locator="330:54-330:59" resultTypeName="t:String" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="716" locator="338:1-339:44" resultTypeName="fhir:Extension" name="BaseExtension" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:t name="description" value="Returns the single base-FHIR extension (if present) on the given element with the specified id."/>
            <a:t name="description" value="Returns the single base-FHIR extension (if present) on the given element with the specified id."/>
            <a:t name="comment" value="This function uses singleton from to ensure that a run-time exception is thrown if there&#xa;is more than one extension on the given resource with the specified url."/>
            <a:s r="716">
               <a:s>/*@description: Returns the single base-FHIR extension (if present) on the given element with the specified id.
@comment: This function uses singleton from to ensure that a run-time exception is thrown if there
is more than one extension on the given resource with the specified url.*/
define function &quot;BaseExtension&quot;(element </a:s>
               <a:s r="710">
                  <a:s>Element</a:s>
               </a:s>
               <a:s>, id </a:s>
               <a:s r="711">
                  <a:s>String</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="715">
                  <a:s r="715">
                     <a:s>singleton from </a:s>
                     <a:s r="714">
                        <a:s>BaseExtensions(</a:s>
                        <a:s r="712">
                           <a:s>element</a:s>
                        </a:s>
                        <a:s>, </a:s>
                        <a:s r="713">
                           <a:s>id</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="715" locator="339:3-339:44" resultTypeName="fhir:Extension" xsi:type="SingletonFrom">
            <signature xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="714" locator="339:18-339:44" name="BaseExtensions" xsi:type="FunctionRef">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Extension" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <signature name="fhir:Element" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
               <operand localId="712" locator="339:33-339:39" resultTypeName="fhir:Element" name="element" xsi:type="OperandRef"/>
               <operand localId="713" locator="339:42-339:43" resultTypeName="t:String" name="id" xsi:type="OperandRef"/>
            </operand>
         </expression>
         <operand name="element">
            <operandTypeSpecifier localId="710" locator="338:41-338:47" resultTypeName="fhir:Element" name="fhir:Element" xsi:type="NamedTypeSpecifier"/>
         </operand>
         <operand name="id">
            <operandTypeSpecifier localId="711" locator="338:53-338:58" resultTypeName="t:String" name="t:String" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="720" locator="343:1-344:54" resultTypeName="fhir:Provenance" name="GetProvenance" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="720">
               <a:s>/*NOTE: Provenance is not the preferred approach, this is provided only as an illustration
for what using Provenance could look like, and is not a tested pattern*/
define function &quot;GetProvenance&quot;(resource </a:s>
               <a:s r="717">
                  <a:s>Resource</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="719">
                  <a:s r="719">
                     <a:s>singleton from </a:s>
                     <a:s r="718">
                        <a:s>(</a:s>
                        <a:s r="718">
                           <a:s>[Provenance: </a:s>
                           <a:s>
                              <a:s>target</a:s>
                           </a:s>
                           <a:s> in </a:s>
                           <a:s>
                              <a:s>resource.id</a:s>
                           </a:s>
                           <a:s>]</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="719" locator="344:3-344:54" resultTypeName="fhir:Provenance" xsi:type="SingletonFrom">
            <signature xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Provenance" xsi:type="NamedTypeSpecifier"/>
            </signature>
            <operand localId="718" locator="344:18-344:54" dataType="fhir:Provenance" templateId="http://hl7.org/fhir/StructureDefinition/Provenance" codeProperty="target" codeComparator="in" xsi:type="Retrieve">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Provenance" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <codes xsi:type="ToList">
                  <operand locator="344:42-344:52" resultTypeName="fhir:id" path="id" xsi:type="Property">
                     <source name="resource" xsi:type="OperandRef"/>
                  </operand>
               </codes>
            </operand>
         </expression>
         <operand name="resource">
            <operandTypeSpecifier localId="717" locator="343:42-343:49" resultTypeName="fhir:Resource" name="fhir:Resource" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="745" locator="346:1-350:107" resultTypeName="fhir:CodeableConcept" name="GetMedicationCode" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="745">
               <a:s>define function &quot;GetMedicationCode&quot;(request </a:s>
               <a:s r="721">
                  <a:s>MedicationRequest</a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="744">
                  <a:s r="744">
                     <a:s>if </a:s>
                     <a:s r="725">
                        <a:s r="723">
                           <a:s r="722">
                              <a:s>request</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="723">
                              <a:s>medication</a:s>
                           </a:s>
                        </a:s>
                        <a:s> is </a:s>
                        <a:s r="724">
                           <a:s>CodeableConcept</a:s>
                        </a:s>
                     </a:s>
                     <a:s> then
  	  </a:s>
                     <a:s r="729">
                        <a:s r="727">
                           <a:s r="726">
                              <a:s>request</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="727">
                              <a:s>medication</a:s>
                           </a:s>
                        </a:s>
                        <a:s> as </a:s>
                        <a:s r="728">
                           <a:s>CodeableConcept</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  	else
  	  </a:s>
                     <a:s r="743">
                        <a:s r="742">
                           <a:s>(</a:s>
                           <a:s r="742">
                              <a:s>singleton from </a:s>
                              <a:s r="741">
                                 <a:s>(</a:s>
                                 <a:s r="741">
                                    <a:s>
                                       <a:s r="731">
                                          <a:s r="730">
                                             <a:s r="730">
                                                <a:s>[Medication]</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> M</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> </a:s>
                                    <a:s r="740">
                                       <a:s>where </a:s>
                                       <a:s r="740">
                                          <a:s r="733">
                                             <a:s r="732">
                                                <a:s>M</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="733">
                                                <a:s>id</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> = </a:s>
                                          <a:s r="739">
                                             <a:s>GetId(</a:s>
                                             <a:s r="738">
                                                <a:s r="737">
                                                   <a:s>(</a:s>
                                                   <a:s r="737">
                                                      <a:s r="735">
                                                         <a:s r="734">
                                                            <a:s>request</a:s>
                                                         </a:s>
                                                         <a:s>.</a:s>
                                                         <a:s r="735">
                                                            <a:s>medication</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s> as </a:s>
                                                      <a:s r="736">
                                                         <a:s>Reference</a:s>
                                                      </a:s>
                                                   </a:s>
                                                   <a:s>)</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="738">
                                                   <a:s>reference</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="743">
                           <a:s>code</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="744" locator="347:3-350:107" resultTypeName="fhir:CodeableConcept" xsi:type="If">
            <condition localId="725" locator="347:6-347:42" resultTypeName="t:Boolean" xsi:type="Is">
               <operand localId="723" locator="347:6-347:23" path="medication" xsi:type="Property">
                  <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                     <choice name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source localId="722" locator="347:6-347:12" resultTypeName="fhir:MedicationRequest" name="request" xsi:type="OperandRef"/>
               </operand>
               <isTypeSpecifier localId="724" locator="347:28-347:42" resultTypeName="fhir:CodeableConcept" name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
            </condition>
            <then localId="729" locator="348:6-348:42" resultTypeName="fhir:CodeableConcept" strict="false" xsi:type="As">
               <operand localId="727" locator="348:6-348:23" path="medication" xsi:type="Property">
                  <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                     <choice name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source localId="726" locator="348:6-348:12" resultTypeName="fhir:MedicationRequest" name="request" xsi:type="OperandRef"/>
               </operand>
               <asTypeSpecifier localId="728" locator="348:28-348:42" resultTypeName="fhir:CodeableConcept" name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
            </then>
            <else localId="743" locator="350:6-350:107" resultTypeName="fhir:CodeableConcept" path="code" xsi:type="Property">
               <source localId="742" locator="350:6-350:102" resultTypeName="fhir:Medication" xsi:type="SingletonFrom">
                  <signature xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Medication" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="741" locator="350:22-350:101" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Medication" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="731" locator="350:23-350:36" alias="M">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Medication" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="730" locator="350:23-350:34" dataType="fhir:Medication" templateId="http://hl7.org/fhir/StructureDefinition/Medication" xsi:type="Retrieve">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Medication" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </expression>
                     </source>
                     <where localId="740" locator="350:38-350:100" resultTypeName="t:Boolean" xsi:type="Equal">
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                           <signature name="fhir:id" xsi:type="NamedTypeSpecifier"/>
                           <operand localId="733" locator="350:44-350:47" resultTypeName="fhir:id" path="id" scope="M" xsi:type="Property"/>
                        </operand>
                        <operand localId="739" locator="350:51-350:100" resultTypeName="t:String" name="GetId" xsi:type="FunctionRef">
                           <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                           <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <signature name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                              <operand localId="738" locator="350:57-350:99" resultTypeName="fhir:string" path="reference" xsi:type="Property">
                                 <source localId="737" locator="350:57-350:89" resultTypeName="fhir:Reference" strict="false" xsi:type="As">
                                    <operand localId="735" locator="350:58-350:75" path="medication" xsi:type="Property">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                       <source localId="734" locator="350:58-350:64" resultTypeName="fhir:MedicationRequest" name="request" xsi:type="OperandRef"/>
                                    </operand>
                                    <asTypeSpecifier localId="736" locator="350:80-350:88" resultTypeName="fhir:Reference" name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                                 </source>
                              </operand>
                           </operand>
                        </operand>
                     </where>
                  </operand>
               </source>
            </else>
         </expression>
         <operand name="request">
            <operandTypeSpecifier localId="721" locator="346:45-346:61" resultTypeName="fhir:MedicationRequest" name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
         </operand>
      </def>
      <def localId="758" locator="353:1-356:3" resultTypeName="t:Boolean" name="HasStart" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="758">
               <a:s>/*Given an interval, return true if the interval has a starting boundary specified (i.e. the start of the interval is not null and not the minimum DateTime value)*/
define function &quot;HasStart&quot;(period </a:s>
               <a:s r="747">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="746">
                     <a:s>DateTime</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="757">
                  <a:s r="757">
                     <a:s>not </a:s>
                     <a:s r="756">
                        <a:s>( </a:s>
                        <a:s r="756">
                           <a:s r="750">
                              <a:s r="749">
                                 <a:s>start of </a:s>
                                 <a:s r="748">
                                    <a:s>period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> is null</a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="755">
                              <a:s r="752">
                                 <a:s>start of </a:s>
                                 <a:s r="751">
                                    <a:s>period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> = </a:s>
                              <a:s r="754">
                                 <a:s>minimum </a:s>
                                 <a:s r="753">
                                    <a:s>DateTime</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="757" locator="354:3-356:3" resultTypeName="t:Boolean" xsi:type="Not">
            <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
            <operand localId="756" locator="354:7-356:3" resultTypeName="t:Boolean" xsi:type="Or">
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <operand localId="750" locator="354:9-354:31" resultTypeName="t:Boolean" xsi:type="IsNull">
                  <signature name="t:Any" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="749" locator="354:9-354:23" resultTypeName="t:DateTime" xsi:type="Start">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="748" locator="354:18-354:23" name="period" xsi:type="OperandRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </operand>
               </operand>
               <operand localId="755" locator="355:10-355:43" resultTypeName="t:Boolean" xsi:type="Equal">
                  <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="752" locator="355:10-355:24" resultTypeName="t:DateTime" xsi:type="Start">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="751" locator="355:19-355:24" name="period" xsi:type="OperandRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </operand>
                  <operand localId="754" locator="355:28-355:43" resultTypeName="t:DateTime" valueType="t:DateTime" xsi:type="MinValue"/>
               </operand>
            </operand>
         </expression>
         <operand name="period">
            <operandTypeSpecifier localId="747" locator="353:35-353:52" xsi:type="IntervalTypeSpecifier">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <pointType localId="746" locator="353:44-353:51" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="771" locator="359:1-364:3" resultTypeName="t:Boolean" name="HasEnd" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="771">
               <a:s>/*Given an interval, return true if the interval has an ending boundary specified (i.e. the end of the interval is not null and not the maximum DateTime value)*/
define function &quot;HasEnd&quot;(period </a:s>
               <a:s r="760">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="759">
                     <a:s>DateTime</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="770">
                  <a:s r="770">
                     <a:s>not </a:s>
                     <a:s r="769">
                        <a:s>(
    </a:s>
                        <a:s r="769">
                           <a:s r="763">
                              <a:s r="762">
                                 <a:s>end of </a:s>
                                 <a:s r="761">
                                    <a:s>period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> is null</a:s>
                           </a:s>
                           <a:s>
      or
      </a:s>
                           <a:s r="768">
                              <a:s r="765">
                                 <a:s>end of </a:s>
                                 <a:s r="764">
                                    <a:s>period</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> = </a:s>
                              <a:s r="767">
                                 <a:s>maximum </a:s>
                                 <a:s r="766">
                                    <a:s>DateTime</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="770" locator="360:3-364:3" resultTypeName="t:Boolean" xsi:type="Not">
            <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
            <operand localId="769" locator="360:7-364:3" resultTypeName="t:Boolean" xsi:type="Or">
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <operand localId="763" locator="361:5-361:25" resultTypeName="t:Boolean" xsi:type="IsNull">
                  <signature name="t:Any" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="762" locator="361:5-361:17" resultTypeName="t:DateTime" xsi:type="End">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="761" locator="361:12-361:17" name="period" xsi:type="OperandRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </operand>
               </operand>
               <operand localId="768" locator="363:7-363:38" resultTypeName="t:Boolean" xsi:type="Equal">
                  <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  <operand localId="765" locator="363:7-363:19" resultTypeName="t:DateTime" xsi:type="End">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="764" locator="363:14-363:19" name="period" xsi:type="OperandRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </operand>
                  <operand localId="767" locator="363:23-363:38" resultTypeName="t:DateTime" valueType="t:DateTime" xsi:type="MaxValue"/>
               </operand>
            </operand>
         </expression>
         <operand name="period">
            <operandTypeSpecifier localId="760" locator="359:33-359:50" xsi:type="IntervalTypeSpecifier">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <pointType localId="759" locator="359:42-359:49" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="792" locator="367:1-371:26" resultTypeName="t:DateTime" name="Latest" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="792">
               <a:s>/*Given an interval, return the ending point if the interval has an ending boundary specified, otherwise, return the starting point*/
define function &quot;Latest&quot;(choice </a:s>
               <a:s r="779">
                  <a:s>Choice&lt;</a:s>
                  <a:s r="772">
                     <a:s>FHIR.dateTime</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="773">
                     <a:s>FHIR.Period</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="774">
                     <a:s>FHIR.Timing</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="775">
                     <a:s>FHIR.instant</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="776">
                     <a:s>FHIR.string</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="777">
                     <a:s>FHIR.Age</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="778">
                     <a:s>FHIR.Range</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="791">
                  <a:s r="791">
                     <a:s>
                        <a:s r="782">
                           <a:s r="781">
                              <a:s>(</a:s>
                              <a:s r="781">
                                 <a:s>&quot;Normalize Interval&quot;(</a:s>
                                 <a:s r="780">
                                    <a:s>choice</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> period</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="790">
                        <a:s>return
      </a:s>
                        <a:s r="789">
                           <a:s>if </a:s>
                           <a:s r="784">
                              <a:s>( </a:s>
                              <a:s r="784">
                                 <a:s>HasEnd(</a:s>
                                 <a:s r="783">
                                    <a:s>period</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> then </a:s>
                           <a:s r="786">
                              <a:s>end of </a:s>
                              <a:s r="785">
                                 <a:s>period</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      else </a:s>
                           <a:s r="788">
                              <a:s>start of </a:s>
                              <a:s r="787">
                                 <a:s>period</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="791" locator="368:3-371:26" resultTypeName="t:DateTime" xsi:type="Query">
            <source localId="782" locator="368:3-368:39" alias="period">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="781" locator="368:3-368:32" name="Normalize Interval" xsi:type="FunctionRef">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <signature xsi:type="ChoiceTypeSpecifier">
                     <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="780" locator="368:25-368:30" name="choice" xsi:type="OperandRef">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
               </expression>
            </source>
            <return localId="790" locator="369:5-371:26" resultTypeName="t:DateTime">
               <expression localId="789" locator="370:7-371:26" resultTypeName="t:DateTime" xsi:type="If">
                  <condition localId="784" locator="370:10-370:26" resultTypeName="t:Boolean" name="HasEnd" xsi:type="FunctionRef">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="783" locator="370:19-370:24" name="period" xsi:type="AliasRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </condition>
                  <then localId="786" locator="370:33-370:45" resultTypeName="t:DateTime" xsi:type="End">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="785" locator="370:40-370:45" name="period" xsi:type="AliasRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </then>
                  <else localId="788" locator="371:12-371:26" resultTypeName="t:DateTime" xsi:type="Start">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="787" locator="371:21-371:26" name="period" xsi:type="AliasRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </else>
               </expression>
            </return>
         </expression>
         <operand name="choice">
            <operandTypeSpecifier localId="779" locator="367:33-367:128" xsi:type="ChoiceTypeSpecifier">
               <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <choice localId="772" locator="367:40-367:52" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               <choice localId="773" locator="367:55-367:65" resultTypeName="fhir:Period" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
               <choice localId="774" locator="367:68-367:78" resultTypeName="fhir:Timing" name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
               <choice localId="775" locator="367:81-367:92" resultTypeName="fhir:instant" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               <choice localId="776" locator="367:95-367:105" resultTypeName="fhir:string" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
               <choice localId="777" locator="367:108-367:115" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
               <choice localId="778" locator="367:118-367:127" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
      <def localId="813" locator="374:1-378:24" resultTypeName="t:DateTime" name="Earliest" context="Patient" accessLevel="Public" xsi:type="FunctionDef">
         <annotation xsi:type="a:Annotation">
            <a:s r="813">
               <a:s>/*Given an interval, return the starting point if the interval has a starting boundary specified, otherwise, return the ending point*/
define function &quot;Earliest&quot;(choice </a:s>
               <a:s r="800">
                  <a:s>Choice&lt;</a:s>
                  <a:s r="793">
                     <a:s>FHIR.dateTime</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="794">
                     <a:s>FHIR.Period</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="795">
                     <a:s>FHIR.Timing</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="796">
                     <a:s>FHIR.instant</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="797">
                     <a:s>FHIR.string</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="798">
                     <a:s>FHIR.Age</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="799">
                     <a:s>FHIR.Range</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> ):
  </a:s>
               <a:s r="812">
                  <a:s r="812">
                     <a:s>
                        <a:s r="803">
                           <a:s r="802">
                              <a:s>(</a:s>
                              <a:s r="802">
                                 <a:s>&quot;Normalize Interval&quot;(</a:s>
                                 <a:s r="801">
                                    <a:s>choice</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> period</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    </a:s>
                     <a:s r="811">
                        <a:s>return
      </a:s>
                        <a:s r="810">
                           <a:s>if </a:s>
                           <a:s r="805">
                              <a:s>(</a:s>
                              <a:s r="805">
                                 <a:s>HasStart(</a:s>
                                 <a:s r="804">
                                    <a:s>period</a:s>
                                 </a:s>
                                 <a:s>)</a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                           <a:s> then </a:s>
                           <a:s r="807">
                              <a:s>start of </a:s>
                              <a:s r="806">
                                 <a:s>period</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      else </a:s>
                           <a:s r="809">
                              <a:s>end of </a:s>
                              <a:s r="808">
                                 <a:s>period</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="812" locator="375:3-378:24" resultTypeName="t:DateTime" xsi:type="Query">
            <source localId="803" locator="375:3-375:39" alias="period">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="802" locator="375:3-375:32" name="Normalize Interval" xsi:type="FunctionRef">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <signature xsi:type="ChoiceTypeSpecifier">
                     <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                     <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand localId="801" locator="375:25-375:30" name="choice" xsi:type="OperandRef">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </operand>
               </expression>
            </source>
            <return localId="811" locator="376:5-378:24" resultTypeName="t:DateTime">
               <expression localId="810" locator="377:7-378:24" resultTypeName="t:DateTime" xsi:type="If">
                  <condition localId="805" locator="377:10-377:27" resultTypeName="t:Boolean" name="HasStart" xsi:type="FunctionRef">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="804" locator="377:20-377:25" name="period" xsi:type="AliasRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </condition>
                  <then localId="807" locator="377:34-377:48" resultTypeName="t:DateTime" xsi:type="Start">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="806" locator="377:43-377:48" name="period" xsi:type="AliasRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </then>
                  <else localId="809" locator="378:12-378:24" resultTypeName="t:DateTime" xsi:type="End">
                     <signature xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </signature>
                     <operand localId="808" locator="378:19-378:24" name="period" xsi:type="AliasRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </else>
               </expression>
            </return>
         </expression>
         <operand name="choice">
            <operandTypeSpecifier localId="800" locator="374:35-374:130" xsi:type="ChoiceTypeSpecifier">
               <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <choice localId="793" locator="374:42-374:54" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               <choice localId="794" locator="374:57-374:67" resultTypeName="fhir:Period" name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
               <choice localId="795" locator="374:70-374:80" resultTypeName="fhir:Timing" name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
               <choice localId="796" locator="374:83-374:94" resultTypeName="fhir:instant" name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               <choice localId="797" locator="374:97-374:107" resultTypeName="fhir:string" name="fhir:string" xsi:type="NamedTypeSpecifier"/>
               <choice localId="798" locator="374:110-374:117" resultTypeName="fhir:Age" name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
               <choice localId="799" locator="374:120-374:129" resultTypeName="fhir:Range" name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
            </operandTypeSpecifier>
         </operand>
      </def>
   </statements>
</library>
