<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion,DisableMethodInvocation" xsi:type="a:CqlToElmInfo"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="148">
         <a:s>library SafeUseofOpioidsConcurrentPrescribing version '6.1.000'</a:s>
      </a:s>
   </annotation>
   <identifier id="SafeUseofOpioidsConcurrentPrescribing" version="6.1.000"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="1" locator="3:1-3:23" localIdentifier="QDM" uri="urn:healthit-gov:qdm:v5_6" version="5.6">
         <annotation xsi:type="a:Annotation">
            <a:s r="1">
               <a:s>using </a:s>
               <a:s>
                  <a:s>QDM</a:s>
               </a:s>
               <a:s> version '5.6'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="2" locator="5:1-5:64" localIdentifier="Global" path="MATGlobalCommonFunctions" version="7.0.000">
         <annotation xsi:type="a:Annotation">
            <a:s r="2">
               <a:s>include </a:s>
               <a:s>
                  <a:s>MATGlobalCommonFunctions</a:s>
               </a:s>
               <a:s> version '7.0.000' called Global</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <valueSets>
      <def localId="3" locator="7:1-7:85" name="All Primary and Secondary Cancer" id="urn:oid:2.16.840.1.113762.1.4.1111.161" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="3">
               <a:s>valueset &quot;All Primary and Secondary Cancer&quot;: 'urn:oid:2.16.840.1.113762.1.4.1111.161'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="4" locator="8:1-8:87" name="Discharge To Acute Care Facility" id="urn:oid:2.16.840.1.113883.3.117.1.7.1.87" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="4">
               <a:s>valueset &quot;Discharge To Acute Care Facility&quot;: 'urn:oid:2.16.840.1.113883.3.117.1.7.1.87'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="5" locator="9:1-9:58" name="Ethnicity" id="urn:oid:2.16.840.1.114222.4.11.837" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="5">
               <a:s>valueset &quot;Ethnicity&quot;: 'urn:oid:2.16.840.1.114222.4.11.837'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="6" locator="10:1-10:87" name="Hospice Care Referral or Admission" id="urn:oid:2.16.840.1.113762.1.4.1116.365" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="6">
               <a:s>valueset &quot;Hospice Care Referral or Admission&quot;: 'urn:oid:2.16.840.1.113762.1.4.1116.365'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="7" locator="11:1-11:68" name="ONC Administrative Sex" id="urn:oid:2.16.840.1.113762.1.4.1" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="7">
               <a:s>valueset &quot;ONC Administrative Sex&quot;: 'urn:oid:2.16.840.1.113762.1.4.1'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="8" locator="12:1-12:79" name="Palliative or Hospice Care" id="urn:oid:2.16.840.1.113883.3.600.1.1579" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="8">
               <a:s>valueset &quot;Palliative or Hospice Care&quot;: 'urn:oid:2.16.840.1.113883.3.600.1.1579'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="9" locator="13:1-13:71" name="Patient Expired" id="urn:oid:2.16.840.1.113883.3.117.1.7.1.309" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="9">
               <a:s>valueset &quot;Patient Expired&quot;: 'urn:oid:2.16.840.1.113883.3.117.1.7.1.309'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="10" locator="14:1-14:55" name="Payer" id="urn:oid:2.16.840.1.114222.4.11.3591" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="10">
               <a:s>valueset &quot;Payer&quot;: 'urn:oid:2.16.840.1.114222.4.11.3591'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="11" locator="15:1-15:53" name="Race" id="urn:oid:2.16.840.1.114222.4.11.836" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="11">
               <a:s>valueset &quot;Race&quot;: 'urn:oid:2.16.840.1.114222.4.11.836'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="12" locator="16:1-16:89" name="Schedule II &amp; III Opioid Medications" id="urn:oid:2.16.840.1.113762.1.4.1111.165" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="12">
               <a:s>valueset &quot;Schedule II &amp; III Opioid Medications&quot;: 'urn:oid:2.16.840.1.113762.1.4.1111.165'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="13" locator="17:1-17:78" name="Schedule IV Benzodiazepines" id="urn:oid:2.16.840.1.113762.1.4.1125.1" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="13">
               <a:s>valueset &quot;Schedule IV Benzodiazepines&quot;: 'urn:oid:2.16.840.1.113762.1.4.1125.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </valueSets>
   <contexts>
      <def locator="19:1-19:15" name="Patient"/>
   </contexts>
   <statements>
      <def locator="19:1-19:15" name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand locator="19:1-19:15" xmlns:ns0="urn:healthit-gov:qdm:v5_6" dataType="ns0:Patient" templateId="Patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def localId="24" locator="24:1-26:89" name="Inpatient Encounter with Age Greater than or Equal to 18" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="24">
               <a:s>define &quot;Inpatient Encounter with Age Greater than or Equal to 18&quot;:
  </a:s>
               <a:s r="23">
                  <a:s>
                     <a:s r="15">
                        <a:s r="14">
                           <a:s>
                              <a:s>Global.&quot;Inpatient Encounter&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s> InpatientHospitalEncounter</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="22">
                     <a:s>where </a:s>
                     <a:s r="22">
                        <a:s r="20">
                           <a:s>AgeInYearsAt(</a:s>
                           <a:s r="19">
                              <a:s>date from </a:s>
                              <a:s r="18">
                                 <a:s>start of </a:s>
                                 <a:s r="17">
                                    <a:s r="16">
                                       <a:s>InpatientHospitalEncounter</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="17">
                                       <a:s>relevantPeriod</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>)</a:s>
                        </a:s>
                        <a:s r="21">>= 18</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="23" locator="25:3-26:89" xsi:type="Query">
            <source localId="15" locator="25:3-25:57" alias="InpatientHospitalEncounter">
               <expression localId="14" locator="25:3-25:30" name="Inpatient Encounter" libraryName="Global" xsi:type="ExpressionRef"/>
            </source>
            <where localId="22" locator="26:5-26:89" xsi:type="GreaterOrEqual">
               <operand localId="20" locator="26:11-26:84" precision="Year" xsi:type="CalculateAgeAt">
                  <operand xsi:type="ToDate">
                     <operand path="birthDatetime" xsi:type="Property">
                        <source name="Patient" xsi:type="ExpressionRef"/>
                     </operand>
                  </operand>
                  <operand localId="19" locator="26:24-26:83" xsi:type="DateFrom">
                     <operand localId="18" locator="26:34-26:83" xsi:type="Start">
                        <operand localId="17" locator="26:43-26:83" path="relevantPeriod" scope="InpatientHospitalEncounter" xsi:type="Property"/>
                     </operand>
                  </operand>
               </operand>
               <operand localId="21" locator="26:88-26:89" valueType="t:Integer" value="18" xsi:type="Literal"/>
            </where>
         </expression>
      </def>
      <def localId="38" locator="44:1-49:113" name="Inpatient Encounters with an Opioid or Benzodiazepine at Discharge" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="38">
               <a:s>define &quot;Inpatient Encounters with an Opioid or Benzodiazepine at Discharge&quot;:
  /*Captures encounters of patients with an opioid(s), benzodiazepine, or a combination of these medications at discharge*/
  </a:s>
               <a:s r="37">
                  <a:s>
                     <a:s r="26">
                        <a:s r="25">
                           <a:s>
                              <a:s>&quot;Inpatient Encounter with Age Greater than or Equal to 18&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s> InpatientEncounter</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="36">
                     <a:s>with </a:s>
                     <a:s r="30">
                        <a:s r="29">
                           <a:s>( </a:s>
                           <a:s r="29">
                              <a:s r="27">
                                 <a:s>[&quot;Medication, Discharge&quot;: </a:s>
                                 <a:s>
                                    <a:s>&quot;Schedule II &amp; III Opioid Medications&quot;</a:s>
                                 </a:s>
                                 <a:s>]</a:s>
                              </a:s>
                              <a:s>
      union </a:s>
                              <a:s r="28">
                                 <a:s>[&quot;Medication, Discharge&quot;: </a:s>
                                 <a:s>
                                    <a:s>&quot;Schedule IV Benzodiazepines&quot;</a:s>
                                 </a:s>
                                 <a:s>]</a:s>
                              </a:s>
                           </a:s>
                           <a:s> )</a:s>
                        </a:s>
                        <a:s> OpioidOrBenzodiazepineDischargeMedication</a:s>
                     </a:s>
                     <a:s>
      such that </a:s>
                     <a:s r="35">
                        <a:s r="32">
                           <a:s r="31">
                              <a:s>OpioidOrBenzodiazepineDischargeMedication</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="32">
                              <a:s>authorDatetime</a:s>
                           </a:s>
                        </a:s>
                        <a:s r="35"> during </a:s>
                        <a:s r="34">
                           <a:s r="33">
                              <a:s>InpatientEncounter</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="34">
                              <a:s>relevantPeriod</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="37" locator="46:3-49:113" xsi:type="Query">
            <source localId="26" locator="46:3-46:79" alias="InpatientEncounter">
               <expression localId="25" locator="46:3-46:60" name="Inpatient Encounter with Age Greater than or Equal to 18" xsi:type="ExpressionRef"/>
            </source>
            <relationship localId="36" locator="47:5-49:113" alias="OpioidOrBenzodiazepineDischargeMedication" xsi:type="With">
               <expression localId="29" locator="47:10-48:70" xsi:type="Union">
                  <operand localId="27" locator="47:12-47:76" xmlns:ns1="urn:healthit-gov:qdm:v5_6" dataType="ns1:PositiveMedicationDischarge" templateId="PositiveMedicationDischarge" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                     <codes locator="47:38-47:75" name="Schedule II &amp; III Opioid Medications" xsi:type="ValueSetRef"/>
                  </operand>
                  <operand localId="28" locator="48:13-48:68" xmlns:ns2="urn:healthit-gov:qdm:v5_6" dataType="ns2:PositiveMedicationDischarge" templateId="PositiveMedicationDischarge" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                     <codes locator="48:39-48:67" name="Schedule IV Benzodiazepines" xsi:type="ValueSetRef"/>
                  </operand>
               </expression>
               <suchThat localId="35" locator="49:17-49:113" xsi:type="In">
                  <operand localId="32" locator="49:17-49:72" path="authorDatetime" scope="OpioidOrBenzodiazepineDischargeMedication" xsi:type="Property"/>
                  <operand localId="34" locator="49:81-49:113" path="relevantPeriod" scope="InpatientEncounter" xsi:type="Property"/>
               </suchThat>
            </relationship>
         </expression>
      </def>
      <def localId="40" locator="51:1-52:70" name="Initial Population" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="40">
               <a:s>define &quot;Initial Population&quot;:
  </a:s>
               <a:s r="39">
                  <a:s>&quot;Inpatient Encounters with an Opioid or Benzodiazepine at Discharge&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="39" locator="52:3-52:70" name="Inpatient Encounters with an Opioid or Benzodiazepine at Discharge" xsi:type="ExpressionRef"/>
      </def>
      <def localId="42" locator="21:1-22:22" name="Denominator" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="42">
               <a:s>define &quot;Denominator&quot;:
  </a:s>
               <a:s r="41">
                  <a:s>&quot;Initial Population&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="41" locator="22:3-22:22" name="Initial Population" xsi:type="ExpressionRef"/>
      </def>
      <def localId="44" locator="28:1-29:51" name="SDE Ethnicity" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="44">
               <a:s>define &quot;SDE Ethnicity&quot;:
  </a:s>
               <a:s r="43">
                  <a:s>[&quot;Patient Characteristic Ethnicity&quot;: </a:s>
                  <a:s>
                     <a:s>&quot;Ethnicity&quot;</a:s>
                  </a:s>
                  <a:s>]</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="43" locator="29:3-29:51" xmlns:ns3="urn:healthit-gov:qdm:v5_6" dataType="ns3:PatientCharacteristicEthnicity" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
            <codes locator="29:40-29:50" name="Ethnicity" xsi:type="ValueSetRef"/>
         </expression>
      </def>
      <def localId="46" locator="31:1-32:43" name="SDE Payer" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="46">
               <a:s>define &quot;SDE Payer&quot;:
  </a:s>
               <a:s r="45">
                  <a:s>[&quot;Patient Characteristic Payer&quot;: </a:s>
                  <a:s>
                     <a:s>&quot;Payer&quot;</a:s>
                  </a:s>
                  <a:s>]</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="45" locator="32:3-32:43" xmlns:ns4="urn:healthit-gov:qdm:v5_6" dataType="ns4:PatientCharacteristicPayer" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
            <codes locator="32:36-32:42" name="Payer" xsi:type="ValueSetRef"/>
         </expression>
      </def>
      <def localId="48" locator="34:1-35:41" name="SDE Race" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="48">
               <a:s>define &quot;SDE Race&quot;:
  </a:s>
               <a:s r="47">
                  <a:s>[&quot;Patient Characteristic Race&quot;: </a:s>
                  <a:s>
                     <a:s>&quot;Race&quot;</a:s>
                  </a:s>
                  <a:s>]</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="47" locator="35:3-35:41" xmlns:ns5="urn:healthit-gov:qdm:v5_6" dataType="ns5:PatientCharacteristicRace" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
            <codes locator="35:35-35:40" name="Race" xsi:type="ValueSetRef"/>
         </expression>
      </def>
      <def localId="50" locator="37:1-38:58" name="SDE Sex" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="50">
               <a:s>define &quot;SDE Sex&quot;:
  </a:s>
               <a:s r="49">
                  <a:s>[&quot;Patient Characteristic Sex&quot;: </a:s>
                  <a:s>
                     <a:s>&quot;ONC Administrative Sex&quot;</a:s>
                  </a:s>
                  <a:s>]</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="49" locator="38:3-38:58" xmlns:ns6="urn:healthit-gov:qdm:v5_6" dataType="ns6:PatientCharacteristicSex" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
            <codes locator="38:34-38:57" name="ONC Administrative Sex" xsi:type="ValueSetRef"/>
         </expression>
      </def>
      <def localId="54" locator="40:1-42:67" name="Intervention Palliative or Hospice Care" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="54">
               <a:s>define &quot;Intervention Palliative or Hospice Care&quot;:
  </a:s>
               <a:s r="53">
                  <a:s r="51">
                     <a:s>[&quot;Intervention, Order&quot;: </a:s>
                     <a:s>
                        <a:s>&quot;Palliative or Hospice Care&quot;</a:s>
                     </a:s>
                     <a:s>]</a:s>
                  </a:s>
                  <a:s>
    union </a:s>
                  <a:s r="52">
                     <a:s>[&quot;Intervention, Performed&quot;: </a:s>
                     <a:s>
                        <a:s>&quot;Palliative or Hospice Care&quot;</a:s>
                     </a:s>
                     <a:s>]</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="53" locator="41:3-42:67" xsi:type="Union">
            <operand xsi:type="As">
               <operand localId="51" locator="41:3-41:55" xmlns:ns7="urn:healthit-gov:qdm:v5_6" dataType="ns7:PositiveInterventionOrder" templateId="PositiveInterventionOrder" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                  <codes locator="41:27-41:54" name="Palliative or Hospice Care" xsi:type="ValueSetRef"/>
               </operand>
               <asTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType xsi:type="ChoiceTypeSpecifier">
                     <choice xmlns:ns8="urn:healthit-gov:qdm:v5_6" name="ns8:PositiveInterventionPerformed" xsi:type="NamedTypeSpecifier"/>
                     <choice xmlns:ns9="urn:healthit-gov:qdm:v5_6" name="ns9:PositiveInterventionOrder" xsi:type="NamedTypeSpecifier"/>
                  </elementType>
               </asTypeSpecifier>
            </operand>
            <operand xsi:type="As">
               <operand localId="52" locator="42:11-42:67" xmlns:ns10="urn:healthit-gov:qdm:v5_6" dataType="ns10:PositiveInterventionPerformed" templateId="PositiveInterventionPerformed" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                  <codes locator="42:39-42:66" name="Palliative or Hospice Care" xsi:type="ValueSetRef"/>
               </operand>
               <asTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType xsi:type="ChoiceTypeSpecifier">
                     <choice xmlns:ns11="urn:healthit-gov:qdm:v5_6" name="ns11:PositiveInterventionPerformed" xsi:type="NamedTypeSpecifier"/>
                     <choice xmlns:ns12="urn:healthit-gov:qdm:v5_6" name="ns12:PositiveInterventionOrder" xsi:type="NamedTypeSpecifier"/>
                  </elementType>
               </asTypeSpecifier>
            </operand>
         </expression>
      </def>
      <def localId="92" locator="54:1-69:5" name="Numerator" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="92">
               <a:s>define &quot;Numerator&quot;:
  /*Encounters of patients prescribed two or more opioids or an opioid and benzodiazepine at discharge.
  */
  </a:s>
               <a:s r="91">
                  <a:s r="71">
                     <a:s>( </a:s>
                     <a:s r="71">
                        <a:s>
                           <a:s r="56">
                              <a:s r="55">
                                 <a:s>
                                    <a:s>&quot;Inpatient Encounters with an Opioid or Benzodiazepine at Discharge&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> InpatientEncounter</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      </a:s>
                        <a:s r="70">
                           <a:s>where </a:s>
                           <a:s r="70">
                              <a:s>( </a:s>
                              <a:s r="70">
                                 <a:s r="68">
                                    <a:s>Count(</a:s>
                                    <a:s r="67">
                                       <a:s>
                                          <a:s r="58">
                                             <a:s r="57">
                                                <a:s r="57">
                                                   <a:s>[&quot;Medication, Discharge&quot;: </a:s>
                                                   <a:s>
                                                      <a:s>&quot;Schedule II &amp; III Opioid Medications&quot;</a:s>
                                                   </a:s>
                                                   <a:s>]</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> Opioids</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
            </a:s>
                                       <a:s r="63">
                                          <a:s>where </a:s>
                                          <a:s r="63">
                                             <a:s r="60">
                                                <a:s r="59">
                                                   <a:s>Opioids</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="60">
                                                   <a:s>authorDatetime</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s r="63"> during </a:s>
                                             <a:s r="62">
                                                <a:s r="61">
                                                   <a:s>InpatientEncounter</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="62">
                                                   <a:s>relevantPeriod</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
            </a:s>
                                       <a:s r="66">
                                          <a:s>return distinct </a:s>
                                          <a:s r="65">
                                             <a:s r="64">
                                                <a:s>Opioids</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="65">
                                                <a:s>code</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
        )</a:s>
                                 </a:s>
                                 <a:s r="69">>= 2</a:s>
                              </a:s>
                              <a:s>
      )</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
                  <a:s>
    union </a:s>
                  <a:s r="90">
                     <a:s>( </a:s>
                     <a:s r="90">
                        <a:s>
                           <a:s r="73">
                              <a:s r="72">
                                 <a:s>
                                    <a:s>&quot;Inpatient Encounters with an Opioid or Benzodiazepine at Discharge&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> InpatientEncounter</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
        </a:s>
                        <a:s r="81">
                           <a:s>with </a:s>
                           <a:s r="75">
                              <a:s r="74">
                                 <a:s r="74">
                                    <a:s>[&quot;Medication, Discharge&quot;: </a:s>
                                    <a:s>
                                       <a:s>&quot;Schedule II &amp; III Opioid Medications&quot;</a:s>
                                    </a:s>
                                    <a:s>]</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> OpioidsDischarge</a:s>
                           </a:s>
                           <a:s>
          such that </a:s>
                           <a:s r="80">
                              <a:s r="77">
                                 <a:s r="76">
                                    <a:s>OpioidsDischarge</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="77">
                                    <a:s>authorDatetime</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="80"> during </a:s>
                              <a:s r="79">
                                 <a:s r="78">
                                    <a:s>InpatientEncounter</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="79">
                                    <a:s>relevantPeriod</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
        </a:s>
                        <a:s r="89">
                           <a:s>with </a:s>
                           <a:s r="83">
                              <a:s r="82">
                                 <a:s r="82">
                                    <a:s>[&quot;Medication, Discharge&quot;: </a:s>
                                    <a:s>
                                       <a:s>&quot;Schedule IV Benzodiazepines&quot;</a:s>
                                    </a:s>
                                    <a:s>]</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> BenzodiazepinesDischarge</a:s>
                           </a:s>
                           <a:s>
          such that </a:s>
                           <a:s r="88">
                              <a:s r="85">
                                 <a:s r="84">
                                    <a:s>BenzodiazepinesDischarge</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="85">
                                    <a:s>authorDatetime</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="88"> during </a:s>
                              <a:s r="87">
                                 <a:s r="86">
                                    <a:s>InpatientEncounter</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="87">
                                    <a:s>relevantPeriod</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
    )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="91" locator="57:3-69:5" xsi:type="Union">
            <operand localId="71" locator="57:3-63:3" xsi:type="Query">
               <source localId="56" locator="57:5-57:91" alias="InpatientEncounter">
                  <expression localId="55" locator="57:5-57:72" name="Inpatient Encounters with an Opioid or Benzodiazepine at Discharge" xsi:type="ExpressionRef"/>
               </source>
               <where localId="70" locator="58:7-62:7" xsi:type="GreaterOrEqual">
                  <operand localId="68" locator="58:15-61:9" xsi:type="Count">
                     <source localId="67" locator="58:21-60:40" xsi:type="Query">
                        <source localId="58" locator="58:21-58:93" alias="Opioids">
                           <expression localId="57" locator="58:21-58:85" xmlns:ns13="urn:healthit-gov:qdm:v5_6" dataType="ns13:PositiveMedicationDischarge" templateId="PositiveMedicationDischarge" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                              <codes locator="58:47-58:84" name="Schedule II &amp; III Opioid Medications" xsi:type="ValueSetRef"/>
                           </expression>
                        </source>
                        <where localId="63" locator="59:13-59:81" xsi:type="In">
                           <operand localId="60" locator="59:19-59:40" path="authorDatetime" scope="Opioids" xsi:type="Property"/>
                           <operand localId="62" locator="59:49-59:81" path="relevantPeriod" scope="InpatientEncounter" xsi:type="Property"/>
                        </where>
                        <return localId="66" locator="60:13-60:40" distinct="true">
                           <expression localId="65" locator="60:29-60:40" path="code" scope="Opioids" xsi:type="Property"/>
                        </return>
                     </source>
                  </operand>
                  <operand localId="69" locator="61:13" valueType="t:Integer" value="2" xsi:type="Literal"/>
               </where>
            </operand>
            <operand localId="90" locator="64:11-69:5" xsi:type="Query">
               <source localId="73" locator="64:13-64:99" alias="InpatientEncounter">
                  <expression localId="72" locator="64:13-64:80" name="Inpatient Encounters with an Opioid or Benzodiazepine at Discharge" xsi:type="ExpressionRef"/>
               </source>
               <relationship localId="81" locator="65:9-66:92" alias="OpioidsDischarge" xsi:type="With">
                  <expression localId="74" locator="65:14-65:78" xmlns:ns14="urn:healthit-gov:qdm:v5_6" dataType="ns14:PositiveMedicationDischarge" templateId="PositiveMedicationDischarge" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                     <codes locator="65:40-65:77" name="Schedule II &amp; III Opioid Medications" xsi:type="ValueSetRef"/>
                  </expression>
                  <suchThat localId="80" locator="66:21-66:92" xsi:type="In">
                     <operand localId="77" locator="66:21-66:51" path="authorDatetime" scope="OpioidsDischarge" xsi:type="Property"/>
                     <operand localId="79" locator="66:60-66:92" path="relevantPeriod" scope="InpatientEncounter" xsi:type="Property"/>
                  </suchThat>
               </relationship>
               <relationship localId="89" locator="67:9-68:100" alias="BenzodiazepinesDischarge" xsi:type="With">
                  <expression localId="82" locator="67:14-67:69" xmlns:ns15="urn:healthit-gov:qdm:v5_6" dataType="ns15:PositiveMedicationDischarge" templateId="PositiveMedicationDischarge" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                     <codes locator="67:40-67:68" name="Schedule IV Benzodiazepines" xsi:type="ValueSetRef"/>
                  </expression>
                  <suchThat localId="88" locator="68:21-68:100" xsi:type="In">
                     <operand localId="85" locator="68:21-68:59" path="authorDatetime" scope="BenzodiazepinesDischarge" xsi:type="Property"/>
                     <operand localId="87" locator="68:68-68:100" path="relevantPeriod" scope="InpatientEncounter" xsi:type="Property"/>
                  </suchThat>
               </relationship>
            </operand>
         </expression>
      </def>
      <def localId="148" locator="71:1-86:7" name="Denominator Exclusion" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="148">
               <a:s>define &quot;Denominator Exclusion&quot;:
  /*Excludes encounters of patients with cancer or who are receiving palliative or hospice care at the time of the encounter or who are discharged to another inpatient care facility or expire during the inpatient stay*/
  </a:s>
               <a:s r="147">
                  <a:s>
                     <a:s r="94">
                        <a:s r="93">
                           <a:s>
                              <a:s>&quot;Inpatient Encounters with an Opioid or Benzodiazepine at Discharge&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s> InpatientEncounter</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="146">
                     <a:s>where </a:s>
                     <a:s r="146">
                        <a:s r="131">
                           <a:s r="112">
                              <a:s r="103">
                                 <a:s>exists </a:s>
                                 <a:s r="102">
                                    <a:s>( </a:s>
                                    <a:s r="102">
                                       <a:s>
                                          <a:s r="96">
                                             <a:s r="95">
                                                <a:s r="95">
                                                   <a:s>[&quot;Diagnosis&quot;: </a:s>
                                                   <a:s>
                                                      <a:s>&quot;All Primary and Secondary Cancer&quot;</a:s>
                                                   </a:s>
                                                   <a:s>]</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> Cancer</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
        </a:s>
                                       <a:s r="101">
                                          <a:s>where </a:s>
                                          <a:s r="101">
                                             <a:s r="98">
                                                <a:s r="97">
                                                   <a:s>Cancer</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="98">
                                                   <a:s>prevalencePeriod</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s r="101"> overlaps </a:s>
                                             <a:s r="100">
                                                <a:s r="99">
                                                   <a:s>InpatientEncounter</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="100">
                                                   <a:s>relevantPeriod</a:s>
                                                </a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
    )</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      or </a:s>
                              <a:s r="111">
                                 <a:s>exists </a:s>
                                 <a:s r="110">
                                    <a:s>( </a:s>
                                    <a:s r="110">
                                       <a:s>
                                          <a:s r="105">
                                             <a:s r="104">
                                                <a:s>
                                                   <a:s>InpatientEncounter.diagnoses</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> Diagnosis</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
          </a:s>
                                       <a:s r="109">
                                          <a:s>where </a:s>
                                          <a:s r="109">
                                             <a:s r="107">
                                                <a:s r="106">
                                                   <a:s>Diagnosis</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="107">
                                                   <a:s>code</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> in </a:s>
                                             <a:s r="108">
                                                <a:s>&quot;All Primary and Secondary Cancer&quot;</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
      )</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      or </a:s>
                           <a:s r="130">
                              <a:s>exists </a:s>
                              <a:s r="129">
                                 <a:s>( </a:s>
                                 <a:s r="129">
                                    <a:s>
                                       <a:s r="114">
                                          <a:s r="113">
                                             <a:s>
                                                <a:s>&quot;Intervention Palliative or Hospice Care&quot;</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s> PalliativeOrHospiceCare</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
          </a:s>
                                    <a:s r="128">
                                       <a:s>where </a:s>
                                       <a:s r="128">
                                          <a:s r="124">
                                             <a:s>Coalesce(</a:s>
                                             <a:s r="121">
                                                <a:s>start of </a:s>
                                                <a:s r="120">
                                                   <a:s r="115">
                                                      <a:s>Global</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="120">
                                                      <a:s>&quot;NormalizeInterval&quot;(</a:s>
                                                      <a:s r="117">
                                                         <a:s r="116">
                                                            <a:s>PalliativeOrHospiceCare</a:s>
                                                         </a:s>
                                                         <a:s>.</a:s>
                                                         <a:s r="117">
                                                            <a:s>relevantDatetime</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s>, </a:s>
                                                      <a:s r="119">
                                                         <a:s r="118">
                                                            <a:s>PalliativeOrHospiceCare</a:s>
                                                         </a:s>
                                                         <a:s>.</a:s>
                                                         <a:s r="119">
                                                            <a:s>relevantPeriod</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s>)</a:s>
                                                   </a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>, </a:s>
                                             <a:s r="123">
                                                <a:s r="122">
                                                   <a:s>PalliativeOrHospiceCare</a:s>
                                                </a:s>
                                                <a:s>.</a:s>
                                                <a:s r="123">
                                                   <a:s>authorDatetime</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s>)</a:s>
                                          </a:s>
                                          <a:s r="128">during </a:s>
                                          <a:s r="127">
                                             <a:s r="125">
                                                <a:s>Global</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="127">
                                                <a:s>&quot;HospitalizationWithObservation&quot; ( </a:s>
                                                <a:s r="126">
                                                   <a:s>InpatientEncounter</a:s>
                                                </a:s>
                                                <a:s> )</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
      )</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      or </a:s>
                        <a:s r="145">
                           <a:s>( </a:s>
                           <a:s r="145">
                              <a:s r="140">
                                 <a:s r="135">
                                    <a:s r="133">
                                       <a:s r="132">
                                          <a:s>InpatientEncounter</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="133">
                                          <a:s>dischargeDisposition</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> in </a:s>
                                    <a:s r="134">
                                       <a:s>&quot;Discharge To Acute Care Facility&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>
          or </a:s>
                                 <a:s r="139">
                                    <a:s r="137">
                                       <a:s r="136">
                                          <a:s>InpatientEncounter</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="137">
                                          <a:s>dischargeDisposition</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> in </a:s>
                                    <a:s r="138">
                                       <a:s>&quot;Hospice Care Referral or Admission&quot;</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
          or </a:s>
                              <a:s r="144">
                                 <a:s r="142">
                                    <a:s r="141">
                                       <a:s>InpatientEncounter</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="142">
                                       <a:s>dischargeDisposition</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> in </a:s>
                                 <a:s r="143">
                                    <a:s>&quot;Patient Expired&quot;</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      )</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="147" locator="73:3-86:7" xsi:type="Query">
            <source localId="94" locator="73:3-73:89" alias="InpatientEncounter">
               <expression localId="93" locator="73:3-73:70" name="Inpatient Encounters with an Opioid or Benzodiazepine at Discharge" xsi:type="ExpressionRef"/>
            </source>
            <where localId="146" locator="74:5-86:7" xsi:type="Or">
               <operand localId="131" locator="74:11-82:7" xsi:type="Or">
                  <operand localId="112" locator="74:11-79:7" xsi:type="Or">
                     <operand localId="103" locator="74:11-76:5" xsi:type="Exists">
                        <operand localId="102" locator="74:18-76:5" xsi:type="Query">
                           <source localId="96" locator="74:20-74:75" alias="Cancer">
                              <expression localId="95" locator="74:20-74:68" xmlns:ns16="urn:healthit-gov:qdm:v5_6" dataType="ns16:Diagnosis" codeProperty="code" codeComparator="in" xsi:type="Retrieve">
                                 <codes locator="74:34-74:67" name="All Primary and Secondary Cancer" xsi:type="ValueSetRef"/>
                              </expression>
                           </source>
                           <where localId="101" locator="75:9-75:80" xsi:type="Overlaps">
                              <operand localId="98" locator="75:15-75:37" path="prevalencePeriod" scope="Cancer" xsi:type="Property"/>
                              <operand localId="100" locator="75:48-75:80" path="relevantPeriod" scope="InpatientEncounter" xsi:type="Property"/>
                           </where>
                        </operand>
                     </operand>
                     <operand localId="111" locator="77:10-79:7" xsi:type="Exists">
                        <operand localId="110" locator="77:17-79:7" xsi:type="Query">
                           <source localId="105" locator="77:19-77:56" alias="Diagnosis">
                              <expression localId="104" locator="77:19-77:46" path="diagnoses" scope="InpatientEncounter" xsi:type="Property"/>
                           </source>
                           <where localId="109" locator="78:11-78:68" xsi:type="InValueSet">
                              <code localId="107" locator="78:17-78:30" path="code" scope="Diagnosis" xsi:type="Property"/>
                              <valueset localId="108" locator="78:35-78:68" name="All Primary and Secondary Cancer" xsi:type="ValueSetRef"/>
                           </where>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="130" locator="80:10-82:7" xsi:type="Exists">
                     <operand localId="129" locator="80:17-82:7" xsi:type="Query">
                        <source localId="114" locator="80:19-80:83" alias="PalliativeOrHospiceCare">
                           <expression localId="113" locator="80:19-80:59" name="Intervention Palliative or Hospice Care" xsi:type="ExpressionRef"/>
                        </source>
                        <where localId="128" locator="81:11-81:252" xsi:type="In">
                           <operand localId="124" locator="81:17-81:183" xsi:type="Coalesce">
                              <operand localId="121" locator="81:26-81:142" xsi:type="Start">
                                 <operand localId="120" locator="81:35-81:142" name="NormalizeInterval" libraryName="Global" xsi:type="FunctionRef">
                                    <operand localId="117" locator="81:62-81:101" path="relevantDatetime" scope="PalliativeOrHospiceCare" xsi:type="Property"/>
                                    <operand localId="119" locator="81:104-81:141" path="relevantPeriod" scope="PalliativeOrHospiceCare" xsi:type="Property"/>
                                 </operand>
                              </operand>
                              <operand localId="123" locator="81:145-81:182" path="authorDatetime" scope="PalliativeOrHospiceCare" xsi:type="Property"/>
                           </operand>
                           <operand localId="127" locator="81:191-81:252" name="HospitalizationWithObservation" libraryName="Global" xsi:type="FunctionRef">
                              <operand localId="126" locator="81:233-81:250" name="InpatientEncounter" xsi:type="AliasRef"/>
                           </operand>
                        </where>
                     </operand>
                  </operand>
               </operand>
               <operand localId="145" locator="83:10-86:7" xsi:type="Or">
                  <operand localId="140" locator="83:12-84:92" xsi:type="Or">
                     <operand localId="135" locator="83:12-83:88" xsi:type="InValueSet">
                        <code localId="133" locator="83:12-83:50" path="dischargeDisposition" scope="InpatientEncounter" xsi:type="Property"/>
                        <valueset localId="134" locator="83:55-83:88" name="Discharge To Acute Care Facility" xsi:type="ValueSetRef"/>
                     </operand>
                     <operand localId="139" locator="84:14-84:92" xsi:type="InValueSet">
                        <code localId="137" locator="84:14-84:52" path="dischargeDisposition" scope="InpatientEncounter" xsi:type="Property"/>
                        <valueset localId="138" locator="84:57-84:92" name="Hospice Care Referral or Admission" xsi:type="ValueSetRef"/>
                     </operand>
                  </operand>
                  <operand localId="144" locator="85:14-85:73" xsi:type="InValueSet">
                     <code localId="142" locator="85:14-85:52" path="dischargeDisposition" scope="InpatientEncounter" xsi:type="Property"/>
                     <valueset localId="143" locator="85:57-85:73" name="Patient Expired" xsi:type="ValueSetRef"/>
                  </operand>
               </operand>
            </where>
         </expression>
      </def>
   </statements>
</library>
